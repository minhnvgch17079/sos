webpackJsonp([58],{"0efB":function(e,a){},HI3A:function(e,a,t){"use strict";Object.defineProperty(a,"__esModule",{value:!0});var s=t("RUzx"),l=t.n(s),n=t("QKlT"),o=t.n(n),i=t("vxzc"),r=t("Bo22"),c=t.n(r),u=t("PJh5"),h=t.n(u),g=t("hC/b"),p={name:"show-sale-salary",components:{Multiselect:l.a,flatPickr:o.a,VueMonthlyPicker:c.a,Moment:h.a,commonHelper:g.a},data:function(){return{sales:[],users:[],rangeTime:null,config:{mode:"range",altInput:!0,altFormat:"Y-m-d",dateFormat:"Y-m-d",theme:"light"},paginConfig:{per_page:10,current_page:1,total_row:0},filter:null,totalShop:0,totalPackages:0,totalRevenue:0,dataShopDetail:[],fields:[{key:"shop_code",label:"Mã shop",sortable:!0},{key:"shop_name",label:"Tên shop",sortable:!0},{key:"sale",label:"Sale",sortable:!0},{key:"shop_created",label:"Thời gian tạo",sortable:!0},{key:"first_time_success",label:"Thời gian lấy thành công",sortable:!0},{key:"pkgs_1",label:"Số đơn hàng thành T1",sortable:!0},{key:"revenue_1",label:"Doanh số tháng 1",sortable:!0},{key:"pkgs_2",label:"Số đơn hàng thành T2",sortable:!0},{key:"revenue_2",label:"Doanh số tháng 2",sortable:!0},{key:"revenue",label:"Tổng doanh số",sortable:!0}],region:{id:"all",name:"Cả nước"},regions:[{id:"all",name:"Cả nước"},{id:"HN",name:"TP Hà Nội"},{id:"MB",name:"Miền Bắc"},{id:"MT",name:"Miền Trung"},{id:"MN",name:"Miền Nam"},{id:"HCM",name:"TP HCM"}],isBusy:!1}},created:function(){this.getAllSales("")},mounted:function(){},watch:{region:function(e,a){"all"===e.id?this.getAllSales(""):this.getAllSales(e.id),this.sales=[],this.dataShopDetail=[]}},computed:{},methods:{getAllSales:function(e){var a=this;i.a.getAllSalesForExportDataShop(e).then(function(e){e.data.success?(a.users=e.data.data,g.a.showMessage(e.data.message,"success")):g.a.showMessage(e.data.message,"warning")}).catch(function(e){console.log(e)})},clear:function(){this.sales=[],this.totalShop=0,this.totalPackages=0,this.totalRevenue=0,this.dataShopDetail=[],this.paginConfig.total_row=0},customRecord:function(e){var a=e.ErpUser,t=e.ErpStation,s=e.ErpAddress;return a.fullname+" ("+a.username+" - "+t.name+" - "+s.name+")"},getDataShopDetail:function(){var e=this;if(null!==this.rangeTime){var a=this.rangeTime.split(" to "),t=null;t=a.length>1?{from:a[0],to:a[1]}:{from:a[0],to:a[0]},0===this.sales.length?t.user_id=this.users.map(function(e){return e.ErpUser.id}):t.user_id=this.sales.map(function(e){return e.ErpUser.id}),this.isBusy=!0,i.a.getShopDetailInRangeTime(t).then(function(a){a.data.success?(e.dataShopDetail=a.data.data,e.paginConfig.total_row=a.data.total_shops,e.totalShop=a.data.total_shops,e.totalPackages=a.data.total_packages,e.totalRevenue=a.data.total_revenue,g.a.showMessage(a.data.message,"success")):g.a.showMessage(a.data.message,"warning"),e.isBusy=!1}).catch(function(a){console.log(a),e.isBusy=!1})}else g.a.showMessage("Vui lòng chọn thời gian!","warning")},exportDataToExcel:function(){if(this.dataShopDetail.length<1)g.a.showMessage("Dữ liệu shop rỗng!","warning");else{var e={data_shop:this.dataShopDetail};i.a.exportDataShopToExcel(e).then(function(e){e.data.success?(g.a.showMessage(e.data.message,"success"),window.location.href=e.data.path):g.a.showMessage(e.data.message,"warning")}).catch(function(e){console.log(e)})}},onFiltered:function(e){this.paginConfig.total_row=e.length,this.paginConfig.current_page=1}}},d=t("XyMi");var m=function(e){t("OEkN"),t("0efB")},b=Object(d.a)(p,function(){var e=this,a=e.$createElement,t=e._self._c||a;return t("div",[t("b-card",{attrs:{"no-body":""}},[t("b-card-body",[t("b-row",[t("h4",{staticClass:"ml-2 mt-1"},[e._v("Xuất dữ liệu Shop:  ")]),e._v(" "),t("flat-pickr",{staticClass:"w-200px h-30px bg-white mr-2",attrs:{config:e.config,placeholder:"Chọn khoảng thời gian",name:"date",events:["onClose"]},model:{value:e.rangeTime,callback:function(a){e.rangeTime=a},expression:"rangeTime"}})],1),e._v(" "),t("hr"),e._v(" "),t("b-row",[t("b-col",{staticClass:"mt-1",attrs:{cols:"2"}},[t("multiselect",{staticClass:"multiselect-success",attrs:{options:e.regions,placeholder:" Chọn miền",selectedLabel:"Đã chọn",deselectLabel:"Bỏ chọn",selectLabel:"Chọn","track-by":"name",label:"name",searchable:!0,multiple:!1,"hide-selected":!0,"allow-empty":!1,clearOption:!0},model:{value:e.region,callback:function(a){e.region=a},expression:"region"}},[t("span",{attrs:{slot:"noResult"},slot:"noResult"},[e._v("Rất tiếc, không tìm thấy!")])])],1),e._v(" "),t("b-col",{staticClass:"mt-1"},[t("multiselect",{staticClass:"multiselect-success",attrs:{options:e.users,placeholder:" Chọn sale",selectedLabel:"Đã chọn",deselectLabel:"Bỏ chọn",selectLabel:"Chọn","track-by":"ErpUser",label:"ErpUser",searchable:!0,multiple:!0,"hide-selected":!0,"allow-empty":!0,clearOption:!0,"custom-label":e.customRecord},model:{value:e.sales,callback:function(a){e.sales=a},expression:"sales"}},[t("span",{attrs:{slot:"noResult"},slot:"noResult"},[e._v("Rất tiếc, không tìm thấy!")])])],1),e._v(" "),t("b-col",{attrs:{cols:"3",xl:"4",lg:"5"}},[t("b-button",{staticClass:"mt-1 w-123",attrs:{variant:"primary"},on:{click:function(a){return e.getDataShopDetail()}}},[t("i",{staticClass:"ion ion-ios-search"}),e._v(" Tìm kiếm")]),e._v(" "),t("b-button",{staticClass:"mt-1 w-123",attrs:{variant:"success"},on:{click:function(a){return e.exportDataToExcel()}}},[t("i",{staticClass:"ion ion-md-cloud-download"}),e._v(" Xuất Excel")]),e._v(" "),t("b-button",{staticClass:"mt-1 w-123",attrs:{variant:"danger"},on:{click:function(a){return e.clear()}}},[t("i",{staticClass:"ion ion-md-trash"}),e._v(" Xóa")])],1)],1),e._v(" "),t("hr"),e._v(" "),t("h5",{staticClass:"mt-2"},[e._v("Tổng quan shop:  ")]),e._v(" "),t("b-row",{staticClass:"mt-1"},[t("b-col",[t("ul",[t("li",[e._v("Tổng số shop:   "+e._s(e.totalShop))])])]),e._v(" "),t("b-col",[t("ul",[t("li",[e._v("Tổng số đơn:   "+e._s(e.totalPackages))])])]),e._v(" "),t("b-col",[t("ul",[t("li",[e._v("Tổng doanh số:   "),t("span",{directives:[{name:"numeral",rawName:"v-numeral"}],domProps:{textContent:e._s(Math.floor(e.totalRevenue))}})])])]),e._v(" "),t("b-col",[t("b-form-input",{attrs:{size:"sm",placeholder:"Tìm kiếm ..."},model:{value:e.filter,callback:function(a){e.filter=a},expression:"filter"}})],1)],1),e._v(" "),t("b-table",{ref:"dataTable",staticClass:"card-table",staticStyle:{"text-align":"center"},attrs:{id:"data-shop",items:e.dataShopDetail,fields:e.fields,striped:!1,bordered:!0,outlined:!0,hover:!0,"per-page":e.paginConfig.per_page,"current-page":e.paginConfig.current_page,responsive:"",filter:e.filter},on:{filtered:e.onFiltered}}),e._v(" "),e.isBusy?t("div",{staticClass:"sk-folding-cube sk-primary"},[t("div",{staticClass:"sk-cube1 sk-cube"}),e._v(" "),t("div",{staticClass:"sk-cube2 sk-cube"}),e._v(" "),t("div",{staticClass:"sk-cube4 sk-cube"}),e._v(" "),t("div",{staticClass:"sk-cube3 sk-cube"})]):e._e(),e._v(" "),e.paginConfig.total_row>0?t("b-pagination",{staticClass:"mt-2",attrs:{"total-rows":e.paginConfig.total_row,"per-page":e.paginConfig.per_page,align:"center",size:"sm"},model:{value:e.paginConfig.current_page,callback:function(a){e.$set(e.paginConfig,"current_page",a)},expression:"paginConfig.current_page"}}):e._e()],1)],1)],1)},[],!1,m,"data-v-99ffcd54",null);a.default=b.exports}});