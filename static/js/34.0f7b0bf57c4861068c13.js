webpackJsonp([34],{JifU:function(t,e){},Opd8:function(t,e){},YjaA:function(t,e){},pOsA:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var s=a("kNeQ"),n=a("RUzx"),i=a.n(n),l=a("28+M"),r=a.n(l),o=a("IENG"),c=a("YrBS"),d={name:"search-b2c-leader",components:{Multiselect:i.a},data:function(){return{selectedUsers:[],users:[],isLoading:!1}},methods:{clearAll:function(){},searchUsers:function(t){var e=this;this.isLoading=!0,s.a.searchB2CSaleLeader({search:t}).then(function(t){t.hasOwnProperty("data")&&t.data.hasOwnProperty("success")&&(t.data.success?t.data.data&&(e.users=t.data.data):e.$notify({group:"default",type:"text-white bg-danger",title:"Thông báo",text:t.data.message}))}).catch(function(t){console.log(t),e.$notify({group:"default",type:"text-white bg-danger",title:"Thông báo",text:"Đã có lỗi xảy ra, vui lòng liên hệ bộ phận kỹ thuật để được hỗ trợ"})}).then(function(){e.isLoading=!1})},selected:function(){this.$notify({group:"default",type:"text-white bg-success",title:"Thông báo",text:"Đã chọn leader sale B2C"}),this.selectedUsers&&this.selectedUsers.hasOwnProperty("code")?this.$emit("selected",this.selectedUsers.code):this.$emit("selected",null)}},created:function(){var t={name:"Tất cả",code:"all"};this.user?this.users.push(t):(this.users=[],this.users.push(t)),this.searchUsers()}},u=a("XyMi");var h=function(t){a("JifU")},f=Object(u.a)(d,function(){var t=this,e=t.$createElement;return(t._self._c||e)("multiselect",{attrs:{id:"ajax",label:"name","track-by":"code",placeholder:"Gõ để tìm quản lý B2C Sale","open-direction":"bottom",options:t.users,multiple:!1,searchable:!0,loading:t.isLoading,"internal-search":!1,"clear-on-select":!0,"close-on-select":!0,"options-limit":300,limit:3,"max-height":600,"show-no-results":!1,"hide-selected":!1,selectedLabel:"",tagPlaceholder:"",selectLabel:"",deselectLabel:"X"},on:{"search-change":t.searchUsers,input:t.selected},model:{value:t.selectedUsers,callback:function(e){t.selectedUsers=e},expression:"selectedUsers"}})},[],!1,h,"data-v-294d0fe2",null).exports,p=a("4s2B"),g={name:"SetStaffOfLeaderSaleB2C",props:{leader_id:null,staff_id:null,force_update:0},components:{LaddaBtn:a("qaB4").a},data:function(){return{is_staff:!1,loading:!1}},methods:{assignStaffForLeader:function(){var t=this;this.loading=!0,this.leader_id&&s.a.assignStaffForLeader(this.leader_id,this.staff_id).then(function(e){e.hasOwnProperty("data")&&e.data.hasOwnProperty("success")&&(e.data.success?(t.is_staff=e.data.data,t.loading=!1):t.$notify({group:"default",type:"text-white bg-danger",title:"Thông báo",text:e.data.message}))}).catch(function(e){console.log(e),t.$notify({group:"default",type:"text-white bg-danger",title:"Thông báo",text:"Đã có lỗi xảy ra, vui lòng liên hệ bộ phận kỹ thuật để được hỗ trợ"})}).then(function(){t.loading=!1})},removeStaffOfLeader:function(){var t=this;this.loading=!0,s.a.removeStaffOfLeader(this.leader_id,this.staff_id).then(function(e){e.hasOwnProperty("data")&&e.data.hasOwnProperty("success")&&(e.data.success?(t.is_staff=!e.data.data,t.loading=!1):t.$notify({group:"default",type:"text-white bg-danger",title:"Thông báo",text:e.data.message}))}).catch(function(e){console.log(e),t.$notify({group:"default",type:"text-white bg-danger",title:"Thông báo",text:"Đã có lỗi xảy ra, vui lòng liên hệ bộ phận kỹ thuật để được hỗ trợ"})}).then(function(){t.loading=!1})},checkStaffOfLeader:function(){var t=this;this.loading=!0,s.a.checkStaffOfLeader(this.leader_id,this.staff_id).then(function(e){e.hasOwnProperty("data")&&e.data.hasOwnProperty("success")&&(e.data.success?(t.is_staff=e.data.data,e.data.data):t.$notify({group:"default",type:"text-white bg-danger",title:"Thông báo",text:e.data.message}))}).catch(function(e){console.log(e),t.$notify({group:"default",type:"text-white bg-danger",title:"Thông báo",text:"Đã có lỗi xảy ra, vui lòng liên hệ bộ phận kỹ thuật để được hỗ trợ"})}).then(function(){t.$forceUpdate(),t.loading=!1})}},watch:{leader_id:function(t){return t&&this.checkStaffOfLeader(),null},staff_id:function(t){return t&&this.checkStaffOfLeader(),null},force_update:function(t){return t&&this.checkStaffOfLeader(),null}},created:function(){this.leader_id&&this.checkStaffOfLeader()}};var _=function(t){a("teh7"),a("YjaA")},v=Object(u.a)(g,function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[t.loading?a("div",{staticClass:"sk-wave sk-primary",staticStyle:{height:"40px",margin:"0 auto"}},[a("div",{staticClass:"sk-rect sk-rect1"}),t._v(" "),a("div",{staticClass:"sk-rect sk-rect2"}),t._v(" "),a("div",{staticClass:"sk-rect sk-rect3"}),t._v(" "),a("div",{staticClass:"sk-rect sk-rect4"}),t._v(" "),a("div",{staticClass:"sk-rect sk-rect5"})]):t._e(),t._v(" "),t.loading?t._e():a("div",[t.leader_id?a("div",[t.is_staff?t._e():a("button",{staticClass:"btn btn-success",staticStyle:{width:"100%"},attrs:{"data-style":"expand-left"},on:{click:t.assignStaffForLeader}},[a("span",{staticClass:"ladda-label"},[t._v("Thêm nhân viên")])]),t._v(" "),t.is_staff?a("button",{staticClass:"btn btn-danger",staticStyle:{width:"100%"},attrs:{"data-style":"expand-left"},on:{click:t.removeStaffOfLeader}},[a("span",{staticClass:"ladda-label"},[t._v("Bỏ chọn nhân viên")])]):t._e()]):t._e(),t._v(" "),t.leader_id?t._e():a("div",[a("button",{staticClass:"btn btn-outline-info",staticStyle:{width:"100%"},attrs:{loading:t.loading,"data-style":"expand-left"}},[a("span",{staticClass:"ladda-label"},[t._v("Chọn leader để thao tác tiếp")])])])])])},[],!1,_,"data-v-440bb3d2",null).exports,m=a("mCOD"),b=a("QKlT"),x=a.n(b),y=a("Bo22"),C=a.n(y),k=a("DAYN"),S=a.n(k),w={name:"AssignLeaderSaleB2C",components:{SelectStations:p.a,SelectDepartmentAndPositionJob:c.a,SelectUserGroup:o.a,LoadingMiniBottom:m.a,Multiselect:i.a,flatPickr:x.a,VueMonthlyPicker:C.a,InputTag:r.a,draggable:S.a,"select-b2c-sale-leader":f,"set-staff":v},data:function(){return{success:!0,appLoading:!1,leader:{id:""},countUpdate:0,disableSelectFilterType:!0,user:{fullname:"",username:"",email:"",staff_code:"",national_id:"",work_status:""},listUsers:[],selected:{null_default:null,stations:[],department:[],group:[],position_job:[],user_status:null,cod_status_id:null,province_group:null,range_time_fillter:null,range_time:null,staff_type:0,leader_id:""},filter_staff_options:[{value:"0",text:"Hiện tất cả"},{value:"1",text:"Chỉ hiện nhân viên"}],user_status_options:[{value:null,text:"Trạng thái user"},{value:"1",text:"Bị khóa"},{value:"2",text:"Chưa kích hoạt"},{value:"3",text:"Đã kích hoạt"}],cod_status_options:[{value:null,text:"Trạng thái cod"},{value:"1",text:"Đang thử việc"},{value:"2",text:"Đang làm việc"},{value:"3",text:"Đã nghỉ"},{value:"4",text:"Cộng tác viên"}],province_group_options:[{value:null,text:"Chọn khu vực"},{value:"hn_group",text:"Hà nội"},{value:"dn_group",text:"Đà nẵng"},{value:"hcm_group",text:"HCM"},{value:"mb_group",text:"Miền bắc"},{value:"mt_group",text:"Miền trung"},{value:"mn_group",text:"Miền nam"}],range_time_fillter_options:[{value:null,text:"Options áp dụng time"},{value:"join_date",text:"Ngày vào"},{value:"trial_date",text:"Ngày thử việc"},{value:"start_date_day",text:"Ngày chính thức"},{value:"resignation",text:"Ngày nghỉ việc"},{value:"ins_time",text:"Thời gian đóng bảo hiểm"}],rangeConfig:{mode:"range",altInput:!0,dateFormat:"Y-m-d",altFormat:"Y-m-d"},pageData:{currentPage:1,totalPages:0,totalItems:0,perPage:10,sortBy:"id",sortDesc:!1},export_file:!1,listColumnsExport:[]}},methods:{pageChanged:function(t){this.searchSaleStaffs(t),this.pageData.currentPage=t},searchSaleStaffs:function(t,e){var a=this,n={full_name:this.user.fullname,username:this.user.username,national_id:this.user.national_id,tel:this.user.tel,email:this.user.email,stations:this.selected.stations,page:t,staff_type:this.selected.staff_type};this.leader.id&&(n.leader_id=this.leader.id),e&&(this.pageData.currentPage=1,n.page=1),null!==this.selected.department&&(n.department=this.selected.department,null!==this.selected.position_job&&(n.position_job=this.selected.position_job)),this.$startLoading(),this.countUpdate+=1,s.a.searchSaleStaff(n).then(function(t){t.data.success?(a.pageData.totalItems=t.data.pagination.total,a.pageData.perPage=t.data.pagination.per_page,a.pageData.totalPages=t.data.pagination.total_page,a.listUsers=t.data.data):a.success=!1}).then(function(){a.$stopLoading(),a.countUpdate+=1})},selectedLeader:function(t){this.leader.id=parseInt(t),this.disableSelectFilterType=!t},resetForm:function(){this.user.fullname=null,this.user.username=null,this.user.email=null,this.selected.stations=[],this.$refs.select_stations.reset(),this.$refs.select_groups.reset()},showDate:function(t){this.selected.date=t}},created:function(){this.searchSaleStaffs(this.pageData.currentPage)},computed:{totalItems:function(){return this.listUsers.length},totalPages:function(){return Math.ceil(this.totalItems/this.perPage)}},metaInfo:{title:"Quản lý sale B2C"}};var P=function(t){a("OEkN"),a("Opd8")},L=Object(u.a)(w,function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("div",{staticClass:"ui-block"},[a("h4",{staticClass:"ui-block-heading"},[t._v("Quản lý sale B2C")]),t._v(" "),a("div",{staticClass:"search-form"},[a("form",[a("b-form-row",[a("b-form-group",{staticClass:"col-md-12",attrs:{label:"Chọn quản lý sale B2C"}},[a("select-b2c-sale-leader",{on:{selected:t.selectedLeader}})],1)],1),t._v(" "),a("b-form-row",[a("div",{staticClass:"col-md-3"},[a("b-form-group",{attrs:{label:"Chọn kho"}},[a("select-stations",{ref:"select_stations",attrs:{placehoder:"Nhập kho cần tìm kiếm"},on:{selected:function(e){t.selected.stations=e}}})],1)],1),t._v(" "),a("b-form-group",{staticClass:"col-md-3",attrs:{label:"Họ tên"}},[a("b-input",{attrs:{type:"text",placeholder:"Nhập họ tên"},model:{value:t.user.fullname,callback:function(e){t.$set(t.user,"fullname",e)},expression:"user.fullname"}})],1),t._v(" "),a("b-form-group",{staticClass:"col-md-3",attrs:{label:"Tên đăng nhập"}},[a("b-input",{attrs:{type:"text",placeholder:"Nhập tên đăng nhập"},model:{value:t.user.username,callback:function(e){t.$set(t.user,"username",e)},expression:"user.username"}})],1),t._v(" "),a("div",{staticClass:"col-md-3"},[a("b-form-group",{attrs:{label:"&nbsp"}},[a("b-form-select",{attrs:{options:t.filter_staff_options,disabled:t.disableSelectFilterType},model:{value:t.selected.staff_type,callback:function(e){t.$set(t.selected,"staff_type",e)},expression:"selected.staff_type"}})],1)],1)],1),t._v(" "),a("b-form-row",[a("div",{staticClass:"col-md-12"},[a("b-form-group",{attrs:{label:"&nbsp"}},[a("div",{staticClass:"align-content-center center"},[a("b-btn",{attrs:{type:"reset"},on:{click:t.resetForm}},[t._v("Nhập lại")]),t._v(" "),a("b-btn",{attrs:{type:"button",variant:"primary"},on:{click:function(e){return t.searchSaleStaffs(t.pageData.currentPage,!0,!1)}}},[a("i",{staticClass:"sidenav-icon ion ion-md-search"}),t._v(" Tìm kiếm\n                                ")])],1)])],1)])],1)]),t._v(" "),a("div",{staticClass:"result",attrs:{id:"results"}},[a("br"),t._v(" "),a("div",{staticClass:"col-sm text-sm-left text-center pt-3"},[t.pageData.totalItems?a("span",{staticClass:"text-muted"},[t._v("Tìm thấy "+t._s(t.pageData.totalItems)+" nhân viên")]):t._e()]),t._v(" "),a("br"),t._v(" "),t.listUsers?a("b-card",{attrs:{"no-body":""}},[a("div",{staticClass:"table-result"},[a("div",{staticClass:"table-responsive mb-4"},[a("table",{staticClass:"table mb-0 table-bordered"},[a("thead",{staticStyle:{width:"100%"}},[a("tr",[a("th",[t._v("Mã NV")]),t._v(" "),a("th",[t._v("Thông tin")]),t._v(" "),a("th",[t._v("Bộ phận")]),t._v(" "),a("th",[t._v("Vị trí")]),t._v(" "),a("th",[t._v("Kho")]),t._v(" "),a("th",{attrs:{width:"80px"}},[t._v("Hành động")])])]),t._v(" "),a("tbody",t._l(t.listUsers,function(e){return a("tr",[a("th",{attrs:{scope:"row","data-user-id":e.id}},[t._v(t._s(e.staff_code))]),t._v(" "),a("td",[a("div",[t._v(t._s(e.fullname))]),t._v(" "),a("b-badge",{attrs:{variant:"outline-info"}},[t._v(t._s(e.username)+" "),e.personal_email?a("span",[t._v("/")]):t._e(),t._v(" "+t._s(e.personal_email))])],1),t._v(" "),a("td",[t._v(t._s(e.group))]),t._v(" "),a("td",[t._v(t._s(e.position))]),t._v(" "),a("td",[t._v(t._s(e.station))]),t._v(" "),a("td",[a("set-staff",{attrs:{staff_id:e.id,leader_id:t.leader.id,force_update:t.countUpdate}})],1)])}),0)])]),t._v(" "),a("b-card-body",{staticClass:"pt-0 pb-3"},[a("div",{staticClass:"row"},[a("div",{staticClass:"col-sm pt-3"},[a("b-pagination",{attrs:{"total-rows":t.pageData.totalItems,"per-page":t.pageData.perPage},on:{change:t.pageChanged},model:{value:t.pageData.currentPage,callback:function(e){t.$set(t.pageData,"currentPage",e)},expression:"pageData.currentPage"}})],1),t._v(" "),a("div",{staticClass:"col-sm text-sm-left text-center pt-3"},[t.pageData.totalItems?a("span",{staticClass:"text-muted"},[t._v("Trang "+t._s(t.pageData.currentPage)+" trên "+t._s(t.pageData.totalPages))]):t._e()])])])],1)]):t._e(),t._v(" "),t.listUsers?t._e():a("div",{staticClass:"no-data"},[t._v("\n                Không có dữ liệu phù hợp, vui lòng thử lại với điều kiện tìm kiếm khác.\n            ")])],1)])])},[],!1,P,"data-v-1fc9a9f2",null);e.default=L.exports}});