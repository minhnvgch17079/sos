webpackJsonp([42],{"8Arv":function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var s=a("4WGu"),i=a("KvPw"),l=a.n(i),n=a("7+uW"),r=a("1Wvq"),o=a.n(r),d=a("YmGg"),c=a("Bo22"),u=a.n(c);n.default.filter("fileSize",function(t){if(!t)return"";var e=String(t).split(".");return e[0]+"."+e[1].slice(0,2)});var p={name:"upload-area-fteam",metaInfo:{title:"Update Area Fteam"},components:{VueMonthlyPicker:u.a,salaryService:d.a,vueDropzone:l.a,FileUpload:o.a},data:function(){return{dropzoneOptions:{url:"/upload",parallelUploads:2,maxFilesize:5e4,filesizeBase:1e3,addRemoveLinks:!0,dictDefaultMessage:"\nDrop files here or click to upload<br>\n    "},monthSalary:"",packagesInProgress:0,countPackages:0,isPrepareUpload:!0,resultUploads:[],files:[],name:"file",accept:"application/vnd.ms-excel,application/vnd.openxmlformats-officedocument.spreadsheetml.sheet",extensions:"xls,xlsx",minSize:1024,size:10485760,multiple:!1,directory:!1,drop:!0,addIndex:!1,thread:3,postAction:s.a.baseApiUrl+"AdPackageSalary/uploadExcelUpdateAreaByCod",success:!1}},methods:{startUpdateData:function(){if(console.log(new Date),this.isPrepareUpload=!0,""!==this.resultUploads&&""!==this.monthSalary){var t=this.monthSalary._i.toString().split("/"),e=this.resultUploads;this.updateDataAreaByCod(e,t[1],t[0],0)}},selectMonthUpdate:function(){0!==this.resultUploads.length&&(this.isPrepareUpload=!1)},updateDataAreaByCod:function(t,e,a,s){var i=this;document.getElementById("result-upload").scrollTop=42*s,this.$set(this.resultUploads[s],"count","loading"),this.$set(this.resultUploads[s],"status","loading"),d.a.updateDataAreaByCod({cod_alias:t[s].cod_alias,area:t[s].area,month:e,year:a}).then(function(e){console.log(i.resultUploads),e.data.success?(i.$set(i.resultUploads[s],"count",e.data.count),i.$set(i.resultUploads[s],"status","Thành công"),i.$notify({group:"notifications-default",type:"bg-success text-white",title:"Thành công",text:"Đã update vùng thành công cho COD "+t[0].cod_alias+"!"})):(i.resultUploads[s].count="Not found",i.resultUploads[s].status=e.data.message,i.$notify({group:"notifications-default",type:"bg-danger text-white",title:"Lỗi",text:e.data.message}))}).catch(function(t){i.appLoading=!1,t&&i.$notify({group:"notifications-default",type:"bg-danger text-white",title:"Lỗi",text:"Có lỗi xảy ra. Vui lòng kiểm tra lại"})}).then(function(){s+1>=i.resultUploads.length||i.updateDataAreaByCod(t,e,a,s+1)})},inputFilter:function(t,e,a){if(this.isPrepareUpload=!0,this.packagesInProgress=this.countPackages=0,t&&!e){if(/(\/|^)(Thumbs\.db|desktop\.ini|\..+)$/.test(t.name))return a();if(/\.(php5?|html?|jsx?)$/i.test(t.name))return a()}if(t&&(!e||t.file!==e.file)){t.blob="";var s=window.URL||window.webkitURL;s&&s.createObjectURL&&(t.blob=s.createObjectURL(t.file)),t.thumb="",t.blob&&"image/"===t.type.substr(0,6)&&(t.thumb=t.blob)}},inputFile:function(t,e){if(t&&e&&(t.active&&!e.active&&t.size>=0&&this.minSize>0&&t.size<this.minSize&&this.$refs.upload.update(t,{error:"size"}),t&&e&&!t.active&&e.active)){var a=JSON.parse(t.response);this.$notify({group:"notifications-default",type:a.success?"":"bg-danger text-white",title:a.success?"Thành công":"Lỗi",text:a.message}),!0===a.success&&(this.resultUploads=a.data,""!==this.monthSalary&&(this.isPrepareUpload=!1))}}}},h=a("XyMi");var v=function(t){a("M8Tp"),a("teh7"),a("OSXQ")},f=Object(h.a)(p,function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("h4",{staticClass:"font-weight-bold py-3 mb-4"},[t._v("\n    Upload vùng tính lương cho F-Team\n  ")]),t._v(" "),a("b-card",[a("label",{staticClass:"form-label"},[t._v("Chọn tháng lương")]),t._v(" "),a("vue-monthly-picker",{staticClass:"col col-md-3",on:{selected:t.selectMonthUpdate},model:{value:t.monthSalary,callback:function(e){t.monthSalary=e},expression:"monthSalary"}}),t._v(" "),a("file-upload",{ref:"upload",staticClass:"sr-only",attrs:{name:t.name,"post-action":t.postAction,extensions:t.extensions,accept:t.accept,multiple:t.multiple,directory:t.directory,size:t.size||0,thread:t.thread<1?1:t.thread>5?5:t.thread,drop:t.drop,"add-index":t.addIndex},on:{"input-filter":t.inputFilter,"input-file":t.inputFile},model:{value:t.files,callback:function(e){t.files=e},expression:"files"}}),t._v(" "),0!==t.packagesInProgress&&t.packagesInProgress===t.countPackages?a("img",{staticStyle:{position:"absolute","margin-left":"30%"},attrs:{src:"https://data.whicdn.com/images/187132170/original.gif",alt:"Italian Trulli"}}):t._e(),t._v(" "),a("div",{staticClass:"table-responsive"},[a("table",{staticClass:"table"},[a("thead",[a("tr",[a("th",[t._v("Tên")]),t._v(" "),a("th",[t._v("Kích thước")]),t._v(" "),a("th",[t._v("Tốc độ")]),t._v(" "),a("th",[t._v("Trạng thái")]),t._v(" "),a("th",[t._v("Hành động")])])]),t._v(" "),a("tbody",[t.files.length?t._e():a("tr",[a("td",{attrs:{colspan:"7"}},[a("div",{staticClass:"text-center p-5"},[a("h4",[t._v("Drop files anywhere to upload "),a("div",{staticClass:"text-muted small my-3"},[t._v("or")])]),t._v(" "),a("label",{staticClass:"btn btn-primary btn-lg",attrs:{for:t.name}},[t._v("Select Files")])])])]),t._v(" "),t._l(t.files,function(e){return a("tr",{key:e.id},[a("td",[a("div",{staticClass:"filename"},[t._v("\n              "+t._s(e.name)+"\n            ")]),t._v(" "),e.active||"0.00"!==e.progress?a("b-progress",{staticStyle:{margin:"4px 0 0 0"},attrs:{value:Number(e.progress),variant:e.error?"danger":"",animated:e.active,height:"6px"}}):t._e()],1),t._v(" "),a("td",[t._v(t._s(t._f("fileSize")(e.size/1024/1024))+" MB")]),t._v(" "),a("td",[t._v(t._s(e.speed))]),t._v(" "),e.error?a("td",[t._v(t._s(e.error))]):e.success?a("td",[t._v("success")]):e.active?a("td",[t._v("active")]):a("td"),t._v(" "),a("td",[a("b-dd",{attrs:{text:"Action",size:"sm",right:!t.isRTL}},[a("b-dd-item",{on:{click:function(a){t.$refs.upload.remove(e),t.resultUploads=[]}}},[t._v("Remove")])],1)],1)])})],2)])]),t._v(" "),a("div",{staticClass:"form-row"},[a("div",[t.$refs.upload&&t.$refs.upload.active?a("b-btn",{attrs:{variant:"danger"},on:{click:function(e){t.$refs.upload.active=!1}}},[a("i",{staticClass:"ion ion-md-close",attrs:{"aria-hidden":"true"}}),t._v(" Stop Upload\n        ")]):a("b-btn",{attrs:{variant:"success"},on:{click:function(e){t.$refs.upload.active=!0}}},[a("i",{staticClass:"ion ion-md-arrow-up",attrs:{"aria-hidden":"true"}}),t._v(" Start Upload\n        ")]),t._v(" "),a("b-btn",{attrs:{variant:"outline-primary",disabled:t.isPrepareUpload},on:{click:t.startUpdateData}},[a("i",{staticClass:"ion ion-md-sync",attrs:{"aria-hidden":"true"}}),t._v(" Update Data\n        ")])],1)])],1),t._v(" "),a("br"),t._v(" "),0!==this.resultUploads.length?a("b-card",{attrs:{"border-variant":"primary"}},[a("h4",{staticStyle:{color:"blue"}},[a("u",[t._v("Kết quả xử lý")])]),t._v(" "),a("div",{attrs:{id:"result-upload"}},[a("table",{staticClass:"table table-striped table-result",staticStyle:{"text-align":"center"}},[a("thead",{staticClass:"header-result"},[a("tr",[a("th",[t._v(" STT")]),t._v(" "),a("th",[t._v(" COD Alias")]),t._v(" "),a("th",[t._v(" Vùng")]),t._v(" "),a("th",[t._v(" Số lượng đơn hàng")]),t._v(" "),a("th",[t._v(" Trạng thái")])])]),t._v(" "),t._l(t.resultUploads,function(e,s){return a("tr",[a("td",[t._v(t._s(s+1))]),t._v(" "),a("td",[t._v(t._s(e.cod_alias))]),t._v(" "),a("td",[t._v(t._s(e.area))]),t._v(" "),void 0===e.count?a("td",{staticStyle:{color:"blue"}},[t._v("Chờ cập nhật")]):"loading"===e.count?a("td",[a("img",{attrs:{src:t.baseUrl+"/static/img/loading_ball.gif",width:"45.7",height:"20"}})]):a("td",{class:"Not found"===e.status?"text-danger":"text-info"},[t._v(t._s(e.count))]),t._v(" "),void 0===e.status?a("td",{staticStyle:{color:"blue"}},[t._v("Chờ cập nhật")]):"loading"===e.status?a("td",[a("img",{attrs:{src:t.baseUrl+"/static/img/loading_ball.gif",width:"45.7",height:"20"}})]):a("td",{class:"Thành công"===e.status?"text-success":"text-danger"},[t._v(t._s(e.status))])])})],2)])]):t._e(),t._v(" "),a("notifications",{attrs:{group:"notifications-default"}})],1)},[],!1,v,null,null);e.default=f.exports},M8Tp:function(t,e){},OSXQ:function(t,e){}});