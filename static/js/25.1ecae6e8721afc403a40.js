webpackJsonp([25],{"2VgO":function(t,a){},AdQ0:function(t,a){},bBlA:function(t,a){},nINr:function(t,a){},"r/ik":function(t,a,n){"use strict";Object.defineProperty(a,"__esModule",{value:!0});var c=n("CLZ8"),s=n("agCp"),e={name:"ListAppendix",props:["contract_id"],data:function(){return{listAppendixs:[]}},methods:{showSlideModal:function(){this.$refs.slideModal.show(),this.getListAppendix()},hideSlideModal:function(){this.$refs.slideModal.hide()},getListAppendix:function(){var t=this,a={contract_id:t.contract_id};s.a.getListAppendixOfContract(a).then(function(a){a.data.hasOwnProperty("success")&&a.data.success&&(t.listAppendixs=a.data.data)}).catch(function(t){}).then(function(){})},goto:function(t){var a="/contract/appendix/"+t;this.$router.push(a)}}},o=n("XyMi");var i=function(t){n("AdQ0")},r=Object(o.a)(e,function(){var t=this,a=t.$createElement,n=t._self._c||a;return n("span",{staticClass:"list-appendix"},[n("b-btn",{attrs:{variant:"secondary"},on:{click:function(a){return t.showSlideModal()}}},[t._v("Các phụ lục đính kèm")]),t._v(" "),n("b-modal",{ref:"slideModal",attrs:{"modal-class":"modal-slide","hide-footer":"",static:""}},[n("div",{attrs:{slot:"modal-title"},slot:"modal-title"},[n("p",{staticClass:"text-center text-big mb-4"},[t._v("Danh sách các phụ lục đã đính kèm với hợp đồng")])]),t._v(" "),n("table",{staticClass:"table card-table",staticStyle:{top:"0px",position:"absolute"}},[n("thead",{staticClass:"thead-light"},[n("tr",[n("th",[t._v("Ngày tạo")]),t._v(" "),n("th",[t._v("Trạng thái")]),t._v(" "),n("th",[t._v("Người tạo")]),t._v(" "),n("th")])]),t._v(" "),n("tbody",t._l(t.listAppendixs,function(a){return n("tr",[n("td",[t._v(t._s(a.EmpContractSalary.created))]),t._v(" "),n("td",["active"==a.EmpContractSalary.status?n("span",{staticClass:"badge badge-success badge-pill"},[t._v("HIỆU LỰC")]):t._e(),t._v(" "),"disable"==a.EmpContractSalary.status?n("span",{staticClass:"badge badge-danger badge-pill"},[t._v("HẾT HIỆU LỰC")]):t._e()]),t._v(" "),a.UserCreated.fullname?n("td",[t._v(t._s(a.UserCreated.fullname))]):t._e(),t._v(" "),a.UserCreated.fullname?t._e():n("td",[t._v("Import Excel")]),t._v(" "),n("td",[n("a",{staticClass:"btn btn-success btn-sm",attrs:{href:"#"},on:{click:function(n){return t.goto(a.EmpContractSalary.id)}}},[t._v("\n                            Xem  "),n("i",{staticClass:"ion ion-ios-arrow-dropright-circle"})])])])}),0)])])],1)},[],!1,i,"data-v-3f25b3a8",null).exports,d=n("mCOD"),l=n("7+uW"),_=n("CLX7"),u=n.n(_);l.default.use(u.a);var p={name:"ContractInfo",props:["contract_id","contract","user"],data:function(){return{notify:{message:"",class:"",title:""}}},methods:{showContractDetail:function(){var t=this;this.appLoading=!0;var a={contract_id:this.contract_id};s.a.getContractDetail(a).then(function(a){if(a.data.success){var n=a.data.data;n.hasOwnProperty("EmpContract")?(t.contract.id=n.EmpContract.id,t.contract.contract_number=n.EmpContract.contract_number,t.contract.signed_date=n.EmpContract.contract_date,t.contract.start_date=n.EmpContract.start_date,t.contract.end_date=n.EmpContract.end_date,t.contract.type=n.EmpContract.type,t.contract.has_kpi=n.EmpContract.has_kpi,t.contract.status=n.EmpContract.status,t.user.staff_code=n.EmpContract.staff_code,t.user.national_id=n.EmpProfile.personal_id_number,t.user.fullname=n.User.fullname,t.user.department=n.EmpPosition.department,t.user.position=n.EmpPosition.position_name,t.user.station=n.Station.name):t.alertNotFound()}else t.success=!1,t.alertNotFound()}).catch(function(t){}).then(function(){this.appLoading=!1})},alertNotFound:function(){this.$emit("not_found",!0)},changeToEditMode:function(){this.$emit("edit_mode",!0)},disableContract:function(){var t=this,a={contract_id:t.contract_id};s.a.disableContract(a).then(function(a){t.notify.success=!1,t.notify.title="Không thành công",t.notify.message="Đã có lỗi xảy ra, vui lòng liên hệ bộ phận kỹ thuật để được hỗ trợ",a.data.hasOwnProperty("success")&&(t.notify.message=a.data.message,a.data.success&&(t.notify.title="Thành công",t.notify.success=!0,t.contract.status="disable"))}).then(function(){t.appLoading=!1,t.showNotification(t.notify.success)})},showNotification:function(t){var a="bg-success text-white";t||(a="bg-warning text-dark"),this.$notify({group:"contract-info",title:this.notify.title,text:this.notify.message,type:a})}}};var v=function(t){n("nINr")},h=Object(o.a)(p,function(){var t=this,a=t.$createElement,n=t._self._c||a;return n("div",{staticClass:"row"},[n("h4",[t._v("Hợp đồng "+t._s(t.contract.contract_number))]),t._v(" "),n("div",{staticClass:"col-md-12 contract-detail"},[n("div",{staticClass:"card mb-4"},[n("div",{staticClass:"row no-gutters row-bordered"},[n("div",{staticClass:"col-md-8 col-lg-12 col-xl-8"},[n("h6",{staticClass:"card-header"},[n("i",{staticClass:"ion  ion-ios-cloud-done"}),t._v(" Thông tin hợp đồng\n                        "),"disable"===t.contract.status?n("span",{staticClass:"badge badge-danger"},[t._v("HẾT HIỆU LỰC")]):t._e()]),t._v(" "),n("div",{staticClass:"card-body"},[n("div",{staticClass:"row"},[n("div",{staticClass:"col-3 col-xl-5 text-muted mb-3"},[t._v("Số hợp đồng : ")]),t._v(" "),n("div",{staticClass:"col-9 col-xl-7 mb-3"},[n("span",{staticClass:"text-big"},[t._v(t._s(t.contract.contract_number))])])]),t._v(" "),n("div",{staticClass:"row"},[n("div",{staticClass:"col-3 col-xl-5 text-muted mb-3"},[t._v("Loại hợp đồng : ")]),t._v(" "),n("div",{staticClass:"col-9 col-xl-7 mb-3"},[n("span",{staticClass:"text-big"},[t._v(t._s(t.contract.type))])])]),t._v(" "),n("div",{staticClass:"row"},[n("div",{staticClass:"col-3 col-xl-5 text-muted mb-3"},[t._v("Tính lương theo KPI :  ")]),t._v(" "),n("div",{staticClass:"col-9 col-xl-7 mb-3"},[n("b-form-checkbox",{attrs:{disabled:"",value:"1","unchecked-value":"0"},model:{value:t.contract.has_kpi,callback:function(a){t.$set(t.contract,"has_kpi",a)},expression:"contract.has_kpi"}},[n("b",[t._v("KPI")])])],1)]),t._v(" "),n("div",{staticClass:"row"},[n("div",{staticClass:"col-3 col-xl-5 text-muted mb-3"},[t._v("Ngày ký:  ")]),t._v(" "),n("div",{staticClass:"col-9 col-xl-7 mb-3"},[n("span",{staticClass:"text-big"},[t._v(t._s(t.contract.contract_date))])])]),t._v(" "),n("hr",{staticClass:"border-light container-m--x mt-0 mb-4"}),t._v(" "),n("div",{staticClass:"row"},[n("div",{staticClass:"col-3 col-xl-5 text-muted mb-3"},[t._v("Ngày bắt đầu:   ")]),t._v(" "),n("div",{staticClass:"col-9 col-xl-7 mb-3"},[n("span",{staticClass:"text-big"},[t._v(t._s(t.contract.start_date))])])]),t._v(" "),n("div",{staticClass:"row"},[n("div",{staticClass:"col-3 col-xl-5 text-muted mb-3"},[t._v("Ngày kết thúc :  ")]),t._v(" "),n("div",{staticClass:"col-9 col-xl-7 mb-3"},[t.contract.end_date?n("span",{staticClass:"text-big"},[t._v(t._s(t.contract.end_date))]):n("span",{staticClass:"text-big"},[t._v("Vô thời hạn")])])])]),t._v(" "),n("div",{staticClass:"card-footer border-0 text-center py-3"},[n("div",{staticClass:"row"},[t._m(0),t._v(" "),"active"===t.contract.status?n("button",{staticClass:"btn ml-2 btn btn-outline-info",on:{click:t.changeToEditMode}},[n("i",{staticClass:"ion ion-ios-create"}),t._v("  Cập nhật thông tin hợp đồng")]):t._e(),t._v(" "),"active"===t.contract.status?n("button",{staticClass:"btn ml-2 btn-outline-danger",on:{click:t.disableContract}},[n("i",{staticClass:"ion ion-ios-close-circle-outline"}),t._v(" Vô hiệu hợp đồng")]):t._e(),t._v(" "),"active"!==t.contract.status?n("router-link",{staticClass:"btn ml-2 btn-outline-primary",attrs:{to:{name:"contract-create-username",params:{username:t.user.username}}}},[n("i",{staticClass:"ion ion-md-add"}),t._v("Tạo hợp đồng mới")]):t._e()],1)])]),t._v(" "),n("div",{staticClass:"col-md-4 col-lg-12 col-xl-4 current-salary"},[t._m(1),t._v(" "),n("div",{staticClass:"card-body"},[n("div",{staticClass:"row"},[n("div",{staticClass:"col-6 col-xl-5 text-muted mb-3"},[t._v("Mã nhân viên")]),t._v(" "),n("div",{staticClass:"col-6 col-xl-7 mb-3"},[n("span",{staticClass:"text-big"},[t._v(t._s(t.user.staff_code))])]),t._v(" "),n("div",{staticClass:"col-6 col-xl-5 text-muted mb-3"},[t._v("Họ tên")]),t._v(" "),n("div",{staticClass:"col-6 col-xl-7 mb-3"},[n("span",{staticClass:"text-big"},[t._v(t._s(t.user.fullname))]),t._v(" "),n("sup",{staticClass:"text-success"})]),t._v(" "),n("div",{staticClass:"col-6 col-xl-5 text-muted mb-3"},[t._v("Số CMT")]),t._v(" "),n("div",{staticClass:"col-6 col-xl-7 mb-3"},[n("span",{staticClass:"text-big"},[t._v(t._s(t.user.national_id))])]),t._v(" "),n("div",{staticClass:"col-6 col-xl-5 text-muted mb-3"},[t._v("Vị trí")]),t._v(" "),n("div",{staticClass:"col-6 col-xl-7 mb-3"},[n("span",{staticClass:"text-big"},[t._v(t._s(t.user.department)+" - "+t._s(t.user.position))])]),t._v(" "),n("div",{staticClass:"col-6 col-xl-5 text-muted mb-3"},[t._v("Kho")]),t._v(" "),n("div",{staticClass:"col-6 col-xl-7 mb-3"},[n("span",{staticClass:"text-big"},[t._v(t._s(t.user.station))])])])])])])])]),t._v(" "),n("hr",{staticClass:"border-light container-m--x mt-0 mb-4"}),n("br"),t._v(" "),n("notifications",{attrs:{group:"contract-info"}})],1)},[function(){var t=this.$createElement,a=this._self._c||t;return a("a",{staticClass:"btn ml-2 btn btn-outline-success",attrs:{href:"/adm/pages/contract/print",target:"_blank"}},[a("i",{staticClass:"ion ion-md-print"}),this._v("  In hợp đồng")])},function(){var t=this.$createElement,a=this._self._c||t;return a("h6",{staticClass:"card-header"},[a("i",{staticClass:"ion ion-ios-person"}),this._v(" Thông tin cá nhân")])}],!1,v,"data-v-17ba0d57",null).exports,m=n("mvHQ"),b=n.n(m),C=n("RUzx"),f=n.n(C),g=n("IC97"),x=n("oonE"),y=n("hC/b");l.default.use(u.a);var E={name:"contract-info-update",components:{Notification:Notification,Multiselect:f.a,Datepicker:g.a},props:{contract_id:String,contract:Object,user:Object},data:function(){return{mode:"update",showCreateButton:!0,appLoading:!1,contract_update:{},options:{contract_type:x.a.getTypeOptions()},notify:{message:"",class:"",title:""}}},methods:{onChangeContractDate:function(){y.a.isEmpty(this.contract_update.start_date)&&y.a.isEmpty(this.contract_update.end_date)&&(this.contract_update.start_date=this.contract_update.contract_date,this.contract_update.end_date=x.a.calculateEndDateByContractType(this.contract_update.contract_type,this.contract_update.contract_date),console.log(this.contract_update.end_date))},onChangeStartDate:function(){y.a.isEmpty(this.contract_update.contract_date)&&(this.contract_update.contract_date=this.contract_update.start_date),this.contract_update.end_date=x.a.calculateEndDateByContractType(this.contract_update.type_contract,this.contract_update.start_date)},showNotification:function(t){var a="bg-success text-white";t||(a="bg-warning text-dark"),this.$notify({group:"create-appendix",title:this.notify.title,text:this.notify.message,type:a})},saveContract:function(){var t=this;this.notify.success=!1,this.notify.title="Không thành công";var a=this.contract_update;a.contract_id=this.contract.id,a.type_contract=this.contract_update.contract_type,"indefinite"===this.contract_update.contract_type&&(this.contract_update.end_date=null),s.a.updateContract(a).then(function(a){a.data.hasOwnProperty("success")&&(a.data.success&&(t.notify.success=!0,t.notify.title="Thành công"),t.notify.message=a.data.message)}).then(function(){t.showNotification(t.notify.success),t.notify.success&&setTimeout(function(){location.reload()},600)})},changeToViewMode:function(){this.$emit("edit_mode",!1)},updateAppendix:function(t){this.appendix=t},alertNotFound:function(){this.$emit("not_found",!0)}},created:function(){this.contract_update=JSON.parse(b()(this.contract))}};var k=function(t){n("LZVb"),n("6aA6"),n("bBlA")},w=Object(o.a)(E,function(){var t=this,a=t.$createElement,n=t._self._c||a;return n("div",{staticClass:"row"},[n("div",{staticClass:"col-md-12 contract-detail"},[n("div",{staticClass:"card mb-4"},[n("div",{staticClass:"row no-gutters row-bordered"},[n("div",{staticClass:"col-md-8 col-lg-12 col-xl-8"},[n("h6",{staticClass:"card-header"},[n("i",{staticClass:"ion  ion-ios-cloud-done"}),t._v(" Cập nhật thông tin hợp đồng - "),n("b",[t._v(t._s(t.contract_update.contract_number))])]),t._v(" "),n("div",{staticClass:"card-body"},[n("b-form-row",[n("b-form-group",{staticClass:"col-md-12",attrs:{label:"Nhập ngày kí hợp đồng"}},[n("datepicker",{attrs:{typeable:!0,format:"yyyy-MM-dd",bootstrapStyling:!0,"monday-first":!0,"full-month-name":!0,placeholder:"Chọn ngày kí hợp đồng","calendar-button":!0,"calendar-button-icon":"ion ion-md-calendar","clear-button":!0},on:{input:t.onChangeContractDate},model:{value:t.contract_update.contract_date,callback:function(a){t.$set(t.contract_update,"contract_date",a)},expression:"contract_update.contract_date"}})],1),t._v(" "),n("b-form-group",{staticClass:"col-md-6",attrs:{label:"Chọn ngày HĐ có hiệu lực"}},[n("datepicker",{attrs:{typeable:!0,format:"yyyy-MM-dd",bootstrapStyling:!0,"monday-first":!0,"full-month-name":!0,placeholder:"Ngày HĐ có hiệu lực","calendar-button":!0,"calendar-button-icon":"ion ion-md-calendar","clear-button":!0},on:{input:t.onChangeStartDate},model:{value:t.contract_update.start_date,callback:function(a){t.$set(t.contract_update,"start_date",a)},expression:"contract_update.start_date"}})],1),t._v(" "),"indefinite"!==t.contract_update.contract_type?n("b-form-group",{staticClass:"col-md-6",attrs:{label:"Chọn ngày kết thúc hợp đồng"}},[n("datepicker",{attrs:{typeable:!0,format:"yyyy-MM-dd",bootstrapStyling:!0,"monday-first":!0,"full-month-name":!0,placeholder:"Chọn ngày kết thúc","calendar-button":!0,"calendar-button-icon":"ion ion-md-calendar","clear-button":!0},model:{value:t.contract_update.end_date,callback:function(a){t.$set(t.contract_update,"end_date",a)},expression:"contract_update.end_date"}})],1):t._e(),t._v(" "),n("b-form-group",{staticClass:"col-md-12",attrs:{label:""}},[n("b-form-checkbox",{attrs:{value:"1","unchecked-value":"0"},model:{value:t.contract_update.has_kpi,callback:function(a){t.$set(t.contract_update,"has_kpi",a)},expression:"contract_update.has_kpi"}},[n("b",[t._v("Tính lương theo KPI")])])],1)],1)],1),t._v(" "),n("div",{staticClass:"card-footer border-0 text-center py-3"},[n("div",{staticClass:"row"},[n("button",{staticClass:"btn ml-2 btn btn-outline-warning",on:{click:t.saveContract}},[n("i",{staticClass:"ion ion-ios-save"}),t._v("  Lưu thông tin hợp đồng")]),t._v(" "),n("button",{staticClass:"btn ml-2 btn-outline-info",on:{click:t.changeToViewMode}},[n("i",{staticClass:"ion  ion-md-eye"}),t._v(" Xem hợp đồng")])])])]),t._v(" "),t.user?n("div",{staticClass:"col-md-4 col-lg-12 col-xl-4 current-salary"},[t._m(0),t._v(" "),n("div",{staticClass:"card-body"},[n("div",{staticClass:"row"},[n("div",{staticClass:"col-6 col-xl-5 text-muted mb-3"},[t._v("Mã nhân viên")]),t._v(" "),n("div",{staticClass:"col-6 col-xl-7 mb-3"},[n("span",{staticClass:"text-big"},[t._v(t._s(t.user.staff_code))])]),t._v(" "),n("div",{staticClass:"col-6 col-xl-5 text-muted mb-3"},[t._v("Họ tên")]),t._v(" "),n("div",{staticClass:"col-6 col-xl-7 mb-3"},[n("span",{staticClass:"text-big"},[t._v(t._s(t.user.fullname))]),t._v(" "),n("sup",{staticClass:"text-success"})]),t._v(" "),n("div",{staticClass:"col-6 col-xl-5 text-muted mb-3"},[t._v("Số CMT")]),t._v(" "),n("div",{staticClass:"col-6 col-xl-7 mb-3"},[n("span",{staticClass:"text-big"},[t._v(t._s(t.user.national_id))])]),t._v(" "),n("div",{staticClass:"col-6 col-xl-5 text-muted mb-3"},[t._v("Vị trí")]),t._v(" "),n("div",{staticClass:"col-6 col-xl-7 mb-3"},[n("span",{staticClass:"text-big"},[t._v(t._s(t.user.department)+" - "+t._s(t.user.position))])]),t._v(" "),n("div",{staticClass:"col-6 col-xl-5 text-muted mb-3"},[t._v("Kho")]),t._v(" "),n("div",{staticClass:"col-6 col-xl-7 mb-3"},[n("span",{staticClass:"text-big"},[t._v(t._s(t.user.station))])])])])]):t._e()])])])])},[function(){var t=this.$createElement,a=this._self._c||t;return a("h6",{staticClass:"card-header"},[a("i",{staticClass:"ion ion-ios-person"}),this._v(" Thông tin cá nhân")])}],!1,k,"data-v-6cdd0aad",null).exports,M={name:"contract-detail",components:{ContractInfo:h,LoadingMiniBottom:d.a,ListAppendix:r,Appendix:c.a,ContractInfoUpdate:w},data:function(){return{not_found:!1,appLoading:!1,edit_contract:!1,user:{fullname:"",username:"",department:"",position:"",station:"",tel:"",staff_code:"",national_id:""},contract:{contract_id:"",contract_number:"",start_date:"",contract_date:"",type:"",end_date:"",has_kpi:0,status:"enable",contract_type:""},appendix:{enable_add_appendix:!1}}},methods:{changeModeAppendix:function(){this.appendix.enable_add_appendix?this.appendix.enable_add_appendix=!1:this.appendix.enable_add_appendix=!0},changeModeContract:function(t){console.log(t),this.edit_contract=!!t},getContractData:function(){var t=this,a={contract_id:this.contract.contract_id};s.a.getContractDetail(a).then(function(a){if(a.data.success){var n=a.data.data;n.hasOwnProperty("EmpContract")?(t.contract.id=n.EmpContract.id,t.contract.contract_number=n.EmpContract.contract_number,t.contract.contract_date=n.EmpContract.contract_date,t.contract.start_date=n.EmpContract.start_date,t.contract.end_date=n.EmpContract.end_date,t.contract.type=n.EmpContract.type,t.contract.contract_type=n.EmpContract.type_contract.trim(),t.contract.has_kpi=n.EmpContract.has_kpi,t.contract.status=n.EmpContract.status,t.contract.auto_create_contract_number=1,t.user.id=n.EmpProfile.id,t.user.staff_code=n.EmpProfile.staff_code,t.user.national_id=n.EmpProfile.personal_id_number,t.user.username=n.User.username,t.user.fullname=n.User.fullname,t.user.department=n.EmpPosition.department,t.user.position=n.EmpPosition.position_name,t.user.station=n.Station.name):t.alertNotFound()}else y.a.showMessage(a.data.message,"warning"),t.success=!1,t.alertNotFound()}).catch(function(t){}).then(function(){t.appLoading=!1})},createAppendixSuccessful:function(){this.appendix.enable_add_appendix=!1},getAlertNotFound:function(){this.not_found=!0}},created:function(){this.contract.contract_id=this.$route.params.id,this.getContractData()}};var N=function(t){n("2VgO")},A=Object(o.a)(M,function(){var t=this,a=t.$createElement,n=t._self._c||a;return n("div",{staticClass:"contract-detail"},[t.not_found?t._e():n("div",{staticClass:"hasData"},[t.edit_contract?t._e():n("contract-info",{attrs:{contract_id:t.contract.contract_id,contract:t.contract,user:t.user},on:{not_found:t.getAlertNotFound,edit_mode:t.changeModeContract}}),t._v(" "),t.edit_contract?n("contract-info-update",{attrs:{contract:t.contract,user:t.user},on:{not_found:t.getAlertNotFound,edit_mode:t.changeModeContract}}):t._e(),t._v(" "),"partnership"!==t.contract.contract_type?n("div",[n("appendix",{attrs:{contract_id:t.contract.contract_id,enable_add_appendix:t.appendix.enable_add_appendix},on:{created_appendix:t.createAppendixSuccessful}}),t._v(" "),n("list-appendix",{attrs:{contract_id:t.contract.contract_id}}),t._v(" "),t.appendix.enable_add_appendix?t._e():n("button",{staticClass:"btn btn-outline-danger add-record",attrs:{type:"button"},on:{click:t.changeModeAppendix}},[n("span",[n("i",{staticClass:"ion ion-md-add"}),t._v("Thêm phụ lục "+t._s(t.contract.type_contract))])]),t._v(" "),t.appendix.enable_add_appendix?n("button",{staticClass:"btn add-record",attrs:{type:"button"},on:{click:t.changeModeAppendix}},[t._m(0)]):t._e()],1):t._e()],1),t._v(" "),t.not_found?n("div",{staticClass:"card"},[n("div",{staticClass:"card-body"},[t._v("Không tìm thấy hợp đồng phù hợp")])]):t._e(),t._v(" "),n("loading-mini-bottom",{attrs:{enable:t.appLoading}})],1)},[function(){var t=this.$createElement,a=this._self._c||t;return a("span",[a("i",{staticClass:"ion ion-ios-close"}),this._v("HỦY")])}],!1,N,"data-v-cd1c7962",null);a.default=A.exports}});