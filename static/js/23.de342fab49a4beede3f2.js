webpackJsonp([23],{OTJN:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i("Gu7T"),a=i.n(n),o=i("hC/b"),s=i("Bo22"),l=i.n(s),c=i("PJh5"),r=i.n(c),u=i("RUzx"),h=i.n(u),d=i("TyzE"),p=i("Qbps"),f=i("l48y"),m=i("vEo5"),v=i("CpaI"),g=i("xT3c"),_=i("YmGg"),b={name:"config-checkin-cod",components:{commonHelper:o.a,VueMonthlyPicker:l.a,Moment:r.a,Multiselect:h.a,MultiSelectProvince:d.a,MultiSelectStations:p.a,SingleSelectProfileRegion:f.a,MultiSelectDistricts:m.a,AddressService:v.a,StationService:g.a},data:function(){return{triggerShow:!1,formula:null,formulas:[],provinceId:null,provinceIds:null,count_ws:0,times:[],salaryMonth:(new r.a).format("YYYY-MM"),dataSearch:[],config_id:null,minimumSalary:{area1_prob:null,area1_emp:null,area2_prob:null,area2_emp:null,prob:null,emp:null},isConfigArea:"not_accepted",isFullWorkShift:"not_accepted",filter:{salaryMonth:"",formula:"",region:"",province_id:"",district_id:"",station_id:""},paginConfig:{per_page:10,current_page:1,total_row:0}}},watch:{triggerShow:function(t,e){this.$refs["modal-config"].show()},count_ws:function(t,e){this.generateDataTimesCheckin()}},created:function(){this.getAllFormular()},mounted:function(){this.getConfig()},methods:{openModal:function(){this.triggerShow=!this.triggerShow},setProvince:function(t){this.filter.province_id=t},getAllFormular:function(){var t=this;_.a.getAllFormulaCod().then(function(e){t.formulas=e.data}).catch(function(t){console.log(t)})},createConfig:function(t){var e=this;if(!(this.formula&&this.formula.length>0))return o.a.showMessage("Vui lòng chọn công thức lương!","warning"),void t.preventDefault();if(!this.provinceIds||!this.provinceIds.length)return o.a.showMessage("Vui lòng chọn tỉnh!","warning"),void t.preventDefault();var i=this.salaryMonth.split("-"),n={month:i[1],year:i[0],formulas:this.formula,province_id:this.provinceIds,times:this.times,count_ws:this.count_ws};_.a.createConfigCheckin(n).then(function(t){t.data.success?(o.a.showMessage(t.data.message,"success"),e.clearModal(),e.getConfig()):o.a.showMessage(t.data.message,"warning")}).catch(function(t){console.log(t)})},updateData:function(t){console.log(t)},cloneConfig:function(t){this.openModal(),this.salaryMonth=new r.a(t.year+"-"+t.month).format("YYYY-MM"),this.region={id:t.region},this.formula=t.formula,this.provinceIds=t.province_id,this.districtId=t.district_id,this.stationId=t.station_id,this.wardId=t.ward_id;var e=JSON.parse(t.minimum_salary);this.minimumSalary={area1_prob:e.area1_prob,area1_emp:e.area1_emp,area2_prob:e.area2_prob,area2_emp:e.area2_emp,prob:null,emp:null},this.isConfigArea="accepted",this.isFullWorkShift=!0===t.is_fulltime?"accepted":"not_accepted"},getConfig:function(t){var e=this;_.a.getConfigCheckinCod(t).then(function(t){if(t.data.success){e.dataSearch=[],e.dataSearch=t.data.data;var i=[];e.dataSearch.forEach(function(t){t.formula=t.formula.split(","),t.formula.forEach(function(t){i.push({name:e.formulas[t-1].name,code:t})}),t.formula=i,t.times=JSON.parse(t.times),i=[]}),e.paginConfig.total_row=t.data.count,o.a.showMessage(t.data.message,"success")}else o.a.showMessage(t.data.message,"warning")}).catch(function(t){console.log(t)})},updateConfig:function(t){_.a.updateConfigCheckin(this.dataSearch[t]).then(function(t){var e=t.data;t.data.success?o.a.showMessage(e.message,"success"):o.a.showMessage(e.message,"danger")}).catch(function(t){console.log(t)})},deleteConfig:function(t){isNaN(t)?o.a.showMessage("Chưa truyền id","warning"):_.a.deleteConfigCheckin(t).then(function(t){t.data.success?o.a.showMessage(t.data.message,"success"):o.a.showMessage(t.data.message,"warning")}).catch(function(t){console.log(t)})},addCheckinShift:function(t){this.dataSearch[t].times.push({end:"08:00",late:"07:30",start:"07:00"})},convertFormula:function(t){this.formulas.filter(function(e){return t.includes(e.code.toString())})},handleProvinceSelected:function(t){this.setProvince(t),this.provinceIds=t?t.map(function(t){return t.id}).toString():""},close:function(){this.clearModal()},cancel:function(){this.clearModal()},clearModal:function(){this.provinceIds=null,this.times=[],this.formula=null,this.count_ws=0,this.salaryMonth=(new r.a).format("YYYY-MM")},clearSearch:function(){this.filter={salaryMonth:"",formula:"",region:"",province_id:"",district_id:"",station_id:""}},searchConfig:function(){var t={};if(this.filter.salaryMonth){var e=this.filter.salaryMonth.format("YYYY-MM").split("-");t.year=e[0],t.month=e[1]}""!==this.filter.province_id&&(t.province=this.filter.province_id.map(function(t){return t.id})),""!==this.filter.formula&&(t.formula=this.filter.formula.map(function(t){return t.code})),""!==this.filter.province_id&&(t.province_id=this.filter.province_id.id),this.getConfig(t)},updateProvince:function(t,e){this.dataSearch[e].province_id=t?t.map(function(t){return t.id}).toString():""},generateDataTimesCheckin:function(){this.times=[];for(var t=0;t<this.count_ws;t++)this.times=[].concat(a()(this.times),[{start:null,end:null,late:null}])}}},C=i("XyMi");var y=function(t){i("OEkN"),i("a+r9")},S=Object(C.a)(b,function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("b-card",{attrs:{"no-body":""}},[i("b-card-body",[i("div",{staticClass:"header"},[i("h3",{staticClass:"mt-2"},[t._v("Config checkin COD:")]),t._v(" "),i("b-button",{attrs:{variant:"outline-primary"},on:{click:t.openModal}},[i("i",{staticClass:"ion ion-md-add"}),t._v(" Config ca checkin")])],1),t._v(" "),i("hr"),t._v(" "),i("b-row",[i("b-col",[i("vue-monthly-picker",{attrs:{placeHolder:"Chọn kỳ lương",alignment:"center",dateFormat:"MM-YYYY",clearOption:!1},model:{value:t.filter.salaryMonth,callback:function(e){t.$set(t.filter,"salaryMonth",e)},expression:"filter.salaryMonth"}})],1),t._v(" "),i("b-col",[i("multi-select-province",{attrs:{"display-all":!0,"province-ids":t.provinceIds,"limit-prop":99999,"auto-close":!1,"hide-selected":!0},on:{handleProvinceSelected:t.handleProvinceSelected}})],1),t._v(" "),i("b-col",[i("multiselect",{staticClass:"multiselect-primary",attrs:{options:t.formulas,placeholder:"Chọn công thức lương",selectedLabel:"Đã chọn",deselectLabel:"Bỏ chọn",selectLabel:"Chọn","track-by":"name",label:"name",disabled:!1,searchable:!0,multiple:!0,"hide-selected":!0,"allow-empty":!0,"close-on-select":!1},model:{value:t.filter.formula,callback:function(e){t.$set(t.filter,"formula",e)},expression:"filter.formula"}},[i("span",{attrs:{slot:"noResult"},slot:"noResult"},[t._v("Rất tiếc, không tìm thấy!")])])],1),t._v(" "),i("b-col",[i("b-button",{staticClass:"pt-1 pb-1 mt-1",attrs:{variant:"primary"},on:{click:t.searchConfig}},[i("i",{staticClass:"ion ion-ios-search"}),t._v(" Tìm kiếm")]),t._v(" "),i("b-button",{staticClass:"pt-1 pb-1 mt-1",attrs:{variant:"danger"},on:{click:t.clearSearch}},[i("i",{staticClass:"ion ion-ios-close-circle-outline"}),t._v(" Xóa lọc")])],1)],1),t._v(" "),i("hr"),t._v(" "),i("table",{staticClass:"table table-hover"},[i("tr",[i("th",[t._v("ID")]),t._v(" "),i("th",[t._v("Tháng")]),t._v(" "),i("th",[t._v("Năm")]),t._v(" "),i("th",[t._v("Công thức")]),t._v(" "),i("th",[t._v("Tỉnh")]),t._v(" "),i("th",[t._v("Ca checkin")]),t._v(" "),i("th",[t._v("Chỉnh sửa")])]),t._v(" "),t._l(t.dataSearch,function(e,n){return i("tr",{key:n},[i("th",[t._v(t._s(e.id))]),t._v(" "),i("th",[t._v(t._s(e.month))]),t._v(" "),i("th",[t._v(t._s(e.year))]),t._v(" "),i("th",{staticStyle:{"max-width":"300px"}},[i("multiselect",{staticClass:"multiselect-primary",attrs:{options:t.formulas,placeholder:"Chọn công thức lương",selectedLabel:"Đã chọn",deselectLabel:"Bỏ chọn",selectLabel:"Chọn","track-by":"name",label:"name",disabled:!1,searchable:!0,multiple:!0,"hide-selected":!0,"allow-empty":!0,"close-on-select":!1},model:{value:e.formula,callback:function(i){t.$set(e,"formula",i)},expression:"data.formula"}},[i("span",{attrs:{slot:"noResult"},slot:"noResult"},[t._v("Rất tiếc, không tìm thấy!")])])],1),t._v(" "),i("th",{staticStyle:{"max-width":"300px"}},[i("multi-select-province",{attrs:{"display-all":!0,"province-ids":e.province_id,"limit-prop":99999,"auto-close":!1,"hide-selected":!0},on:{handleProvinceSelected:function(e){return t.updateProvince(e,n)}},model:{value:e.province_id,callback:function(i){t.$set(e,"province_id",i)},expression:"data.province_id"}})],1),t._v(" "),i("th",[t._l(e.times,function(n,a){return i("div",{key:a},[i("br"),t._v(" "),i("p",[i("b",[t._v("- Ca "+t._s(a+1)+": ")]),i("b-button",{attrs:{variant:"danger",size:"sm"},on:{click:function(t){return e.times.splice(a,1)}}},[t._v("Xoá Ca")])],1),t._v(" "),i("b-card",[i("b-row",[i("b-col",[i("p",[t._v("Bắt đầu:")]),t._v(" "),i("b-form-input",{attrs:{type:"time"},model:{value:n.start,callback:function(e){t.$set(n,"start",e)},expression:"time.start"}})],1),t._v(" "),i("b-col",[i("p",[t._v("Kết thúc:")]),t._v(" "),i("b-form-input",{attrs:{type:"time"},model:{value:n.end,callback:function(e){t.$set(n,"end",e)},expression:"time.end"}})],1),t._v(" "),i("b-col",[i("p",[t._v("Checkin muộn:")]),t._v(" "),i("b-form-input",{attrs:{type:"time"},model:{value:n.late,callback:function(e){t.$set(n,"late",e)},expression:"time.late"}})],1)],1)],1)],1)}),t._v(" "),i("br"),t._v(" "),i("b-button",{attrs:{variant:"success"},on:{click:function(e){return t.addCheckinShift(n)}}},[t._v("Thêm Ca")])],2),t._v(" "),i("th",[i("b-button",{attrs:{variant:"warning"},on:{click:function(e){return t.updateConfig(n)}}},[t._v("Update")]),t._v(" "),i("b-button",{attrs:{variant:"danger"},on:{click:function(i){return t.deleteConfig(e.id)}}},[t._v("Delete")])],1)])})],2),t._v(" "),i("hr"),t._v(" "),t.paginConfig.total_row>0?i("b-pagination",{staticClass:"mt-2",attrs:{"total-rows":t.paginConfig.total_row,"per-page":t.paginConfig.per_page,align:"center",size:"sm"},model:{value:t.paginConfig.current_page,callback:function(e){t.$set(t.paginConfig,"current_page",e)},expression:"paginConfig.current_page"}}):t._e(),t._v(" "),i("b-modal",{ref:"modal-config",attrs:{"no-close-on-backdrop":"",size:"lg",title:"Config ca checkin COD","cancel-title":"Hủy bỏ",static:""},on:{ok:t.createConfig,cancel:t.cancel,close:t.close}},[i("b-row",[i("b-col",[i("multiselect",{staticClass:"multiselect-primary",attrs:{options:t.formulas,placeholder:"Chọn công thức lương",selectedLabel:"Đã chọn",deselectLabel:"Bỏ chọn",selectLabel:"Chọn","track-by":"name",label:"name",disabled:!1,searchable:!0,multiple:!0,"hide-selected":!0,"allow-empty":!0,"close-on-select":!1},model:{value:t.formula,callback:function(e){t.formula=e},expression:"formula"}},[i("span",{attrs:{slot:"noResult"},slot:"noResult"},[t._v("Rất tiếc, không tìm thấy!")])])],1)],1),t._v(" "),i("br"),t._v(" "),i("b-row",[i("b-col",[i("multi-select-province",{attrs:{"display-all":!0,"province-ids":t.provinceIds,"limit-prop":99999,"auto-close":!1,"hide-selected":!0},on:{handleProvinceSelected:t.handleProvinceSelected}})],1)],1),t._v(" "),i("br"),t._v(" "),i("b-row",[i("b-col",[i("p",[t._v("Kỳ lương:")]),t._v(" "),i("vue-monthly-picker",{staticClass:"monthly-picker",attrs:{placeHolder:"Chọn kỳ lương",alignment:"center",dateFormat:"MM-YYYY",clearOption:!1},model:{value:t.salaryMonth,callback:function(e){t.salaryMonth=e},expression:"salaryMonth"}})],1),t._v(" "),i("b-col",[i("p",[t._v("Số ca:")]),t._v(" "),i("b-form-input",{attrs:{type:"number",placeholder:"Nhập số ca checkin"},model:{value:t.count_ws,callback:function(e){t.count_ws=e},expression:"count_ws"}})],1)],1),t._v(" "),t._l(t.times,function(e,n){return i("div",{key:n},[i("br"),t._v(" "),i("p",[i("b",[t._v("- Ca "+t._s(n+1)+":")])]),t._v(" "),i("b-card",[i("b-row",[i("b-col",[i("p",[t._v("Bắt đầu:")]),t._v(" "),i("b-form-input",{attrs:{type:"time"},model:{value:e.start,callback:function(i){t.$set(e,"start",i)},expression:"time.start"}})],1),t._v(" "),i("b-col",[i("p",[t._v("Kết thúc:")]),t._v(" "),i("b-form-input",{attrs:{type:"time"},model:{value:e.end,callback:function(i){t.$set(e,"end",i)},expression:"time.end"}})],1),t._v(" "),i("b-col",[i("p",[t._v("Checkin muộn:")]),t._v(" "),i("b-form-input",{attrs:{type:"time"},model:{value:e.late,callback:function(i){t.$set(e,"late",i)},expression:"time.late"}})],1)],1)],1)],1)})],2)],1)],1)},[],!1,y,"data-v-4d81e8b2",null);e.default=S.exports},Qbps:function(t,e,i){"use strict";var n=i("RUzx"),a=i.n(n),o=i("xT3c"),s={name:"multi-select-stations",components:{Multiselect:a.a},props:{stationIds:{},allStation:{},autoClose:{},hideSelected:{},limitProp:{default:5},isDisabled:{default:!1}},data:function(){return{autoClosed:!0,hideSelect:!1,option:null,options:[]}},created:function(){var t=this;void 0!==this.allStation&&null!==this.allStation&&this.allStation.length>0&&(this.options=this.allStation,void 0!==this.stationIds&&null!==this.stationIds&&this.stationIds.length>0&&(this.option=this.allStation.filter(function(e){return t.stationIds.split(",").includes(e.id.toString())}))),void 0!==this.autoClose&&null!==this.autoClose&&(this.autoClosed=this.autoClose),void 0!==this.hideSelected&&null!==this.hideSelected&&(this.hideSelect=this.hideSelected)},watch:{hideSelected:function(t,e){this.hideSelect=this.hideSelected},autoClose:function(t,e){this.autoClosed=this.autoClose},option:function(t,e){this.$emit("stationIds",this.option.map(function(t){return t.id}))},allStation:function(t,e){this.options=t},stationIds:function(t,e){t&&this.allStation.length>0&&(this.option=this.allStation.filter(function(e){return t.split(",").includes(e.id.toString())}))}},methods:{getAllStations:function(){var t=this;o.a.getAllStationByProvinceIds().then(function(e){e.data.success&&(t.options=e.data.data)}).catch(function(t){console.log(t)})}}},l=i("XyMi");var c=function(t){i("cTqd")},r=Object(l.a)(s,function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[i("multiselect",{staticClass:"multiselect-primary",attrs:{options:t.options,multiple:!0,placeholder:"Chọn kho",label:"name","track-by":"name",selectedLabel:"Đã chọn",deselectLabel:"Bỏ chọn",selectLabel:"Chọn",disabled:t.isDisabled,limit:t.limitProp,"hide-selected":t.hideSelect,"close-on-select":t.autoClosed},model:{value:t.option,callback:function(e){t.option=e},expression:"option"}},[i("span",{attrs:{slot:"noResult"},slot:"noResult"},[t._v("Rất tiếc. Không tìm thấy.")])])],1)},[],!1,c,"data-v-65017e17",null);e.a=r.exports},VLNM:function(t,e){},"a+r9":function(t,e){},cTqd:function(t,e){},vEo5:function(t,e,i){"use strict";var n=i("vfns"),a=i("CpaI"),o=i("RUzx"),s={name:"multi-select-districts",components:{Multiselect:i.n(o).a},props:{provinceId:{type:String},districtId:{type:String},isDisabled:{type:Boolean}},data:function(){return{storage:null,option:[],options:[]}},created:function(){this.storage=new n.a,this.getListDistrict()},watch:{option:function(t,e){this.$emit("handleSelectedDistrict",t)},provinceId:function(t,e){this.option=[],this.options=[],this.getListDistrict()},districtId:function(t,e){null!==t&&this.setSelectedOption()}},methods:{setSelectedOption:function(){var t=this;this.options.length>0&&this.districtId&&(this.option=this.options.find(function(e){return parseInt(e.id)===parseInt(t.districtId)}))},getListDistrict:function(){var t=this;if(!this.provinceId||null==this.provinceId)return this.options=[],void(this.option=null);var e="listDistrictsByProvince-"+this.provinceId,i=this.storage.get(e);if(i)this.options=i,this.setSelectedOption();else{var n={provinceId:this.provinceId};a.a.getDistrictByProvinceId(n).then(function(i){i.data.success&&(t.options=i.data.data,t.storage.set(e,t.options),t.setSelectedOption())}).catch(function(t){console.log(t)})}}}},l=i("XyMi");var c=function(t){i("VLNM")},r=Object(l.a)(s,function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"mb-4"},[i("multiselect",{staticClass:"oneline-height",attrs:{options:t.options,placeholder:"Chọn quận/huyện",multiple:!0,disabled:t.isDisabled,label:"name","track-by":"name","close-on-select":!1,"clear-on-select":!1,selectedLabel:"Đã chọn",deselectLabel:"Bỏ chọn",selectLabel:"Chọn"},model:{value:t.option,callback:function(e){t.option=e},expression:"option"}},[i("template",{slot:"selection"},[t._v("Đã chọn")]),t._v(" "),i("span",{attrs:{slot:"noResult"},slot:"noResult"},[t._v("Rất tiếc. Không tìm thấy.")])],2)],1)},[],!1,c,"data-v-170eadc8",null);e.a=r.exports}});