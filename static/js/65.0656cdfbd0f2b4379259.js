webpackJsonp([65],{"3rAA":function(t,a,e){"use strict";Object.defineProperty(a,"__esModule",{value:!0});var s=e("IC97"),i=e("PJh5"),o=e.n(i),n=e("RUzx"),l=e.n(n),c=e("fAdw"),r=e("qaB4"),d=e("mCOD"),u=e("w6Ui"),p=e("KVzY"),g=e("7+uW"),h=e("4WGu");g.default.use(p.default);var m={components:{Datepicker:s.a,Multiselect:l.a,LaddaBtn:r.a,SidenavRouterLink:u.g,LoadingMiniBottom:d.a},data:function(){return{from:o()().format("YYYY-MM-DD"),to:o()().format("YYYY-MM-DD"),shopeeAuditPackage:{pkg_order:"",uploaded_username:""},selectStatus:{name:"Tất cả",status_type:""},statusTypes:[{name:"Tất cả",status_type:""},{name:"Chưa đối soát",status_type:"not_audited"},{name:"Đã đối soát",status_type:"audited"}],isUploadSuccess:0,loading:[!1,!1],pageData:{currentPage:1,totalPages:0,totalItems:0,perPage:10,sortBy:"id",sortDesc:!1},appLoading:!1,listAuditPackages:[],packageAjax:[],inputDisable:!1,checkResult:!1,packageStatuses:[],packageDebtBill:[],loadingSum:!1,uploadErrorMsg:"",importFile:null,loadingExcel:!1,loadingExcelHtml:'\n      <div class="sk-folding-cube sk-primary">\n        <div class="sk-cube1 sk-cube"></div>\n        <div class="sk-cube2 sk-cube"></div>\n        <div class="sk-cube4 sk-cube"></div>\n        <div class="sk-cube3 sk-cube"></div>\n      </div>\n      <h5 class="text-center mb-0">LOADING...</h5>\n    '}},methods:{showImportModal:function(){this.resetModal(),this.$refs.importExcelModal.show()},hideImportModal:function(){this.$refs.importExcelModal.hide()},uploadFile:function(t){var a=this;if(a.importFile)if("csv"===this.importFile.name.split(".").pop()){var e=new FormData;e.append("file_upload",a.importFile),a.uploadErrorMsg="",a.startLoading(t),c.a.uploadFileAuditShopee(e).then(function(e){e.data.success?(a.isUploadSuccess=1,a.updateLoadingValue(t,!1),window.location.href="/adm/audit/upload-manage?success=true"):(a.isUploadSuccess=-1,e.data.message&&(a.uploadErrorMsg=e.data.message),a.updateLoadingValue(t,!1))}).catch(function(e){e&&(a.isUploadSuccess=-1,a.updateLoadingValue(t,!1))}).then(function(){a.updateLoadingValue(t,!1),a.appLoading=!1})}else alert("Bạn phải upload file định dạng .csv!");else alert("Bạn chưa chọn file upload!")},searchAuditPackage:function(t,a,e){var s=this,i={pkg_alias:s.shopeeAuditPackage.pkg_order,uploaded_username:s.shopeeAuditPackage.uploaded_username,created_from:this.customFormatter(s.from),created_to:this.customFormatter(s.to),status:this.selectStatus.status_type,page:t};a&&(this.pageData.currentPage=1,i.page=1),s.appLoading=!0,this.startLoading(e),c.a.searchAuditPackage(i).then(function(t){t.data.success?(s.checkResult=t.data.success,s.packageStatuses=t.data.options.packageStatuses,s.pageData.totalItems=t.data.options.total,s.pageData.perPage=t.data.options.per_page,s.pageData.totalPages=t.data.options.total_page,s.listAuditPackages=t.data.options.packages,s.updateLoadingValue(e,!1)):s.updateLoadingValue(e,!1)}).catch(function(t){t&&s.updateLoadingValue(e,!1)}).then(function(){s.updateLoadingValue(e,!1),s.appLoading=!1})},deleteAuditPackage:function(t){var a=this;if(confirm("Bạn chắc chắn muốn xóa?")){var e={pkg_order:t};c.a.deleteWAuditPackage(e).then(function(t){t.data.success?(alert("Xóa thành công!!"),a.searchAuditPackage(a.pageData.currentPage)):alert("Xóa không thành công!! Hãy thử lại")}).catch(function(t){t&&alert("Xóa không thành công!! Hãy thử lại")})}},exportFile:function(){var t=this,a=h.a.domainDownloadFile,e={pkg_alias:t.shopeeAuditPackage.pkg_order,uploaded_username:t.shopeeAuditPackage.uploaded_username,created_from:this.customFormatter(t.from),created_to:this.customFormatter(t.to),status:this.selectStatus.status_type};t.loadingExcel=!0,c.a.exportFile(e).then(function(t){if(t.data.success)window.location.href=a+t.data.data;else{var e=t.data.msg?t.data.msg:"Có lỗi xảy ra. Hãy thử lại nhé!";alert(e)}}).catch(function(t){t&&alert("Có lỗi xảy ra. Hãy thử lại nhé!")}).then(function(){t.loadingExcel=!1})},exportFileV2:function(){var t=this,a={pkg_alias:t.shopeeAuditPackage.pkg_order,uploaded_username:t.shopeeAuditPackage.uploaded_username,created_from:this.customFormatter(t.from),created_to:this.customFormatter(t.to),status:this.selectStatus.status_type};t.loadingExcel=!0,c.a.exportFileV2(a).then(function(a){t.$router.push("/audit/download-manage")}).catch(function(t){}).then(function(){t.loadingExcel=!1})},customFormatter:function(t){return o()(t).format("YYYY-MM-DD")},dateSelectedFromInChild:function(t){this.from=t},dateSelectedToInChild:function(t){this.to=t},resetForm:function(){this.shopeeAuditPackage.pkg_order="",this.shopeeAuditPackage.uploaded_username=""},resetModal:function(){this.isUploadSuccess=0,this.uploadErrorMsg="",this.$refs.importFile.reset()},startLoading:function(t){this.loading[t]||this.updateLoadingValue(t,!0)},updateLoadingValue:function(t,a){this.loading[t]=a,this.loading=this.loading.slice(0)},pageChanged:function(t){this.searchAuditPackage(t),this.pageData.currentPage=t},clickAlias:function(t){return"/admin?alias="+t}},computed:{totalItems:function(){return this.listBills.length},totalPages:function(){return Math.ceil(this.totalItems/this.perPage)}}},_=e("XyMi");var v=function(t){e("6aA6"),e("OWXj")},f=Object(_.a)(m,function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",[e("div",{staticClass:"ui-block"},[e("b-form-row",[e("h4",{staticClass:"ui-block-heading col-md-6"},[t._v("Đối soát Shopee")]),t._v(" "),e("div",{staticClass:"col-md-6 center"},[e("b-button",{staticClass:"btn btn-success",on:{click:t.showImportModal}},[e("i",{staticClass:"sidenav-icon ion ion-md-filing"}),t._v("\n          Upload đơn hàng\n        ")]),t._v(" "),e("button",{staticClass:"btn btn-primary"},[e("sidenav-router-link",{attrs:{to:"/audit/upload-manage"}},[t._v("Quản lý upload")])],1),t._v(" "),e("button",{staticClass:"btn btn-warning"},[e("sidenav-router-link",{attrs:{to:"/audit/download-manage"}},[t._v("Quản lý download")])],1)],1)]),t._v(" "),e("div",[e("form",[e("div",{staticClass:"form-filter"},[e("b-form-row",[e("div",{staticClass:"col-md-6"},[e("b-form-group",{attrs:{label:"Mã đơn hàng"}},[e("b-input",{attrs:{type:"text",placeholder:"Nhập mã đơn hàng cách nhau bởi dấu phẩy"},model:{value:t.shopeeAuditPackage.pkg_order,callback:function(a){t.$set(t.shopeeAuditPackage,"pkg_order",a)},expression:"shopeeAuditPackage.pkg_order"}})],1)],1),t._v(" "),e("div",{staticClass:"col-md-6"},[e("b-form-group",{attrs:{label:"Người upload"}},[e("b-input",{attrs:{type:"text",placeholder:"Nhập tên người upload file"},model:{value:t.shopeeAuditPackage.uploaded_username,callback:function(a){t.$set(t.shopeeAuditPackage,"uploaded_username",a)},expression:"shopeeAuditPackage.uploaded_username"}})],1)],1)]),t._v(" "),e("b-form-row",[e("div",{staticClass:"col-md-12"},[e("b-form-group",{attrs:{label:"Trạng thái"}},[e("multiselect",{attrs:{"track-by":"name",label:"name",placeholder:"Chọn trạng thái",options:t.statusTypes,searchable:!1,"allow-empty":!1},model:{value:t.selectStatus,callback:function(a){t.selectStatus=a},expression:"selectStatus"}})],1)],1)]),t._v(" "),e("b-form-row",[e("div",{staticClass:"col-md-6"},[e("b-form-group",{attrs:{label:"Từ:"}},[e("datepicker",{staticClass:"from-date",attrs:{bootstrapStyling:!0,format:t.customFormatter,disabled:t.inputDisable},on:{selected:t.dateSelectedFromInChild},model:{value:t.from,callback:function(a){t.from=a},expression:"from"}})],1)],1),t._v(" "),e("div",{staticClass:"col-md-6"},[e("b-form-group",{attrs:{label:"Đến:"}},[e("datepicker",{staticClass:"from-date",attrs:{bootstrapStyling:!0,format:t.customFormatter,disabled:t.inputDisable},on:{selected:t.dateSelectedToInChild},model:{value:t.to,callback:function(a){t.to=a},expression:"to"}})],1)],1)])],1),t._v(" "),e("b-form-row",[e("div",{staticClass:"align-content-center center"},[t.loadingExcel?e("BlockUI",{attrs:{message:"Dữ liệu đang được xử lý, vui lòng đợi!",html:t.loadingExcelHtml}}):t._e(),t._v(" "),e("ladda-btn",{staticClass:"btn",attrs:{"data-style":"zoom-out"},nativeOn:{click:function(a){return t.resetForm(a)}}},[t._v("\n              Nhập lại\n            ")]),t._v(" "),e("ladda-btn",{staticClass:"btn btn-success",attrs:{loading:t.loading[1],"data-style":"zoom-out"},nativeOn:{click:function(a){return t.searchAuditPackage(t.pageData.currentPage,!0,1)}}},[e("i",{staticClass:"sidenav-icon ion ion-md-search"}),t._v("\n              Tìm kiếm\n            ")]),t._v(" "),e("b-btn",{staticClass:"btn btn-success",attrs:{type:"button"},on:{click:t.exportFileV2}},[e("i",{staticClass:"sidenav-icon ion ion-md-filing"}),t._v("\n              Xuất file\n            ")])],1)])],1)]),t._v(" "),t.checkResult?e("div",{staticClass:"result",attrs:{id:"results"}},[t.listAuditPackages.length>0?e("b-card",{attrs:{"no-body":""}},[e("div",{staticClass:"table-result"},[e("b-card-body",{staticClass:"pt-0 pb-3"},[e("div",{staticClass:"row"},[e("div",{staticClass:"col-sm pt-3"},[e("b-pagination",{attrs:{"total-rows":t.pageData.totalItems,"per-page":t.pageData.perPage},on:{change:t.pageChanged},model:{value:t.pageData.currentPage,callback:function(a){t.$set(t.pageData,"currentPage",a)},expression:"pageData.currentPage"}}),t._v("\n                Tổng số đơn hàng: "+t._s(t.pageData.totalItems)+"\n              ")],1),t._v(" "),e("div",{staticClass:"col-sm text-sm-left text-center pt-3"},[t.pageData.totalItems?e("span",{staticClass:"text-muted"},[t._v("Trang "+t._s(t.pageData.currentPage)+" trên "+t._s(t.pageData.totalPages))]):t._e()])])]),t._v(" "),e("div",{staticClass:"table-responsive mb-4"},[e("table",{staticClass:"table mb-0 table-bordered table-striped"},[e("thead",{staticStyle:{width:"100%"}},[e("tr",[e("th",{attrs:{width:"90%"}},[t._v("Thông tin đơn hàng")]),t._v(" "),e("th",{attrs:{width:"10%"}},[t._v("Thao tác")])])]),t._v(" "),e("tbody",t._l(t.listAuditPackages,function(a){return e("tr",{staticClass:"tr-bill"},[e("td",[e("span",[e("b",[t._v("Mã đơn hàng:  ")])]),t._v(" "),e("a",{staticClass:"text-decoration-none text-alias",attrs:{href:t.clickAlias(a.Package.alias),target:"_blank"}},[t._v("\n                      "+t._s(a.Package.alias)+"\n                    ")]),t._v(" "),e("br"),t._v(" "),1==a.Package.is_freeship?e("span",{staticClass:"font-weight-bold"},[t._v("Free Ship cho khách")]):t._e(),t._v(" "),0==a.Package.is_freeship?e("span",{staticClass:"font-weight-bold"},[t._v("Khách trả tiền Ship")]):t._e(),t._v(" "),e("br"),e("br"),t._v(" "),e("span",{staticClass:"font-weight-bold"},[t._v("Trạng thái: ")]),t._v(" "+t._s(t.packageStatuses[a.Package.package_status_id])+" "),e("br"),t._v(" "),e("span",{staticClass:"font-weight-bold"},[t._v("Tiền thu hộ: ")]),t._v(" "+t._s(a.Package.getFinalPickMoney)),e("br"),t._v(" "),e("span",{staticClass:"font-weight-bold"},[t._v("Phí dịch vụ: ")]),t._v(" "+t._s(a.Package.isExcludeInsuranceFee)),e("br"),t._v(" "),e("span",{staticClass:"font-weight-bold"},[t._v("Shop trả trước: ")]),t._v(" "+t._s(a.Package.getFinalPrePaidAmount)),e("br"),t._v(" "),e("span",{staticClass:"font-weight-bold"},[t._v("Phí đồng kiểm: ")]),t._v(" "+t._s(a.Package.getFinalCoCheckFee)),e("br"),t._v(" "),e("span",{staticClass:"font-weight-bold"},[t._v("Phí chuyển hoàn: ")]),t._v(" "+t._s(a.Package.getFinalReturnFee)),e("br"),t._v(" "),e("span",{staticClass:"font-weight-bold"},[t._v("Khuyến mãi: ")]),t._v(" "+t._s(a.Package.discountAmount)),e("br"),t._v(" "),e("span",{staticClass:"font-weight-bold"},[t._v("Tiền trả shop: ")]),t._v(" "+t._s(a.Package.finalCashBack)),e("br"),t._v(" "),e("span",{staticClass:"font-weight-bold"},[t._v("Tên KH: ")]),t._v(" "+t._s(a.Package.customer_fullname)+" "),e("br"),t._v(" "),e("span",{staticClass:"font-weight-bold"},[t._v("Địa chỉ: ")]),t._v(" "+t._s(a.Package.customer_first_address)+" - "+t._s(a.Package.customer_last_address)+" "),e("br"),t._v(" "),e("span",{staticClass:"font-weight-bold"},[t._v("ĐT KH: ")]),t._v(" "+t._s(a.Package.customer_tel)+" "),e("br"),t._v(" "),e("span",[e("b",[t._v("Người upload: ")]),t._v(t._s(a.PackageWaudit?a.PackageWaudit.uploaded_username:""))])]),t._v(" "),e("td",[e("b-button",{attrs:{size:"sm",variant:"danger"},on:{click:function(e){return t.deleteAuditPackage(a.Package.order)}}},[e("i",{staticClass:"ion ion-md-trash"}),t._v("\n                      Xóa\n                    ")])],1)])}),0)])])],1)]):t._e(),t._v(" "),0==t.listAuditPackages.length?e("div",{staticClass:"no-data"},[e("b-alert",{attrs:{show:"",dismissible:"",variant:"warning"}},[e("i",{staticClass:"sidenav-icon ion ion-ios-warning"}),t._v("\n          Không có dữ liệu phù hợp, vui lòng thử lại.\n        ")])],1):t._e()],1):t._e(),t._v(" "),e("loading-mini-bottom",{attrs:{enable:t.appLoading}})],1),t._v(" "),e("b-modal",{ref:"importExcelModal",attrs:{title:"Import Excel đối soát",static:""}},[e("div",{staticClass:"d-block text-center"},[1==t.isUploadSuccess?e("b-alert",{attrs:{variant:"success",show:""}},[t._v("Upload file thành công")]):t._e(),t._v(" "),-1==t.isUploadSuccess?e("b-alert",{attrs:{variant:"danger",show:""}},[t._v(t._s(t.uploadErrorMsg?t.uploadErrorMsg:"Upload file không thành công"))]):t._e(),t._v(" "),e("b-form-file",{ref:"importFile",attrs:{variant:"outline-default",state:Boolean(t.importFile),placeholder:"Chọn file...",accept:".csv"},model:{value:t.importFile,callback:function(a){t.importFile=a},expression:"importFile"}}),t._v(" "),e("div",{staticClass:"mt-3"},[t._v("File đã chọn: "+t._s(t.importFile&&t.importFile.name))]),t._v(" "),t.importFile?e("ladda-btn",{staticClass:"btn btn-primary",attrs:{loading:t.loading[0],"data-style":"zoom-out"},nativeOn:{click:function(a){return t.uploadFile(0)}}},[e("i",{staticClass:"sidenav-icon ion ion-md-search"}),t._v("\n        Upload\n      ")]):t._e()],1),t._v(" "),e("div",{staticClass:"w-100",attrs:{slot:"modal-footer"},slot:"modal-footer"},[e("b-btn",{staticClass:"float-right",attrs:{variant:"default"},on:{click:t.hideImportModal}},[t._v("\n        Đóng\n      ")])],1)])],1)},[],!1,v,"data-v-78fc7825",null);a.default=f.exports},OWXj:function(t,a){}});