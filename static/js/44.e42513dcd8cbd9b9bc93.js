webpackJsonp([44],{R3I8:function(t,e){},qkSh:function(t,e,a){"use strict";var n=a("JJbb");e.a={getEvaluationList:function(t){return n.a.get("evaluations/list",{params:t})},getRecompenseAndVoteOfUser:function(t){return n.a.get("evaluations/getRecompenseAndVoteOfUser",{params:t})},getEvaluationByUser:function(t){return n.a.get("evaluations/getEvaluationByUser",{params:t})},addEvaluation:function(t){return n.a.post("evaluations/add",t)},getListEvaluationNotes:function(t){return n.a.get("evaluations/getListEvaluationNotes",{params:t})},addNote:function(t){return n.a.post("evaluations/addNote",t)},changeStatusEvaluationOfStaff:function(t){return n.a.post("evaluations/changeStatusEvaluationOfStaff",t)},changeStatusRecompenseOfStaff:function(t){return n.a.post("evaluations/changeStatusRecompenseOfStaff",t)},uploadReport:function(t){return n.a.post("evaluations/uploadReport",t)},checkIsManagement:function(t){return n.a.get("evaluations/checkIsManagement",{params:t})}}},yQeu:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=a("fZjL"),o=a.n(n),i=a("qkSh"),s=a("9fS5"),r=a("5vjp"),l=a("F/2K"),d=a("a/7L"),c=a("YlZe"),u=a("csCE"),v=a("l48y"),m=a("ufke"),p=a("QKlT"),_=a.n(p),h=a("VvlD"),g=a("PJh5"),f=a.n(g),S={name:"evaluation-employee-manager",components:{SingleSelectProfileRegion:v.a,SkRotatingPlane:s.a,SingleSelectModule:r.a,SingleSelectProvince:l.a,SingleSelectStation:d.a,SingleSelectPosition:c.a,SingleSelectDepartment:u.a,SingleSelectWorkType:m.a,flatPickr:_.a},data:function(){return{keyword:"",staff_code:"",region:"",provinceId:"",stationId:"",moduleId:"",departmentName:"",positionId:"",work_type_id:"",evaluations:[],appLoading:!1,currentPage:1,totalItems:0,perPage:10,groupOptions:[],range_time:null,time_format:null,rangeConfig:{mode:"range",altInput:!0,dateFormat:"d-m-Y",altFormat:"d-m-Y"},evaluationDetail:""}},created:function(){this.getStartEndFromTimeRange(),this.search()},computed:{totalPages:function(){return Math.ceil(this.totalItems/this.perPage)}},watch:{range_time:function(t,e){this.getStartEndFromTimeRange()}},methods:{searchEvaluation:function(){this.currentPage=1,this.search()},getStartEndFromTimeRange:function(){if(!this.range_time)return this.time_format={from:h.a.daysInThisMonth(21,20).from,to:h.a.daysInThisMonth(21,20).to},!0;var t=this.range_time.split("to").map(function(t){return t.trim()});2===t.length&&(this.time_format={from:f()(t[0],"DD-MM-YYYY").format("YYYY-MM-DD"),to:f()(t[1],"DD-MM-YYYY").format("YYYY-MM-DD")})},search:function(){var t=this;this.appLoading=!0;var e={staff_code:this.staff_code,keyword:this.keyword,region:this.region,provinceId:this.provinceId,stationId:this.stationId,moduleId:this.moduleId,departmentName:this.departmentName,positionId:this.positionId,workTypeId:this.work_type_id,from:this.time_format.from,to:this.time_format.to,page:this.currentPage,limit:this.perPage};i.a.getEvaluationList(e).then(function(e){e.data.success&&(t.evaluations=e.data.data,t.totalItems=e.data.count,t.groupOptions=t.getGroupOptions(e.data.group_staff))}).catch(function(t){console.log(t)}).then(function(){t.appLoading=!1})},setValueEvaluationDetail:function(t){this.evaluationDetail=t},checkGroupUser:function(t){return["12","14","17","18"].includes(t)},handleSelectedModule:function(t){this.moduleId=t?t.id:""},handleSelectedRegion:function(t){this.region=t?t.id:""},handleSelectedProvince:function(t){this.provinceId=t?t.id:""},handleSelectedStation:function(t){this.stationId=t?t.id:""},handleSelectedDepartment:function(t){this.departmentName=t?t.name:""},handleSelectedPosition:function(t){this.positionId=t?t.id:""},handleSelectedWorkType:function(t){this.work_type_id=t?t.id:""},getGroupOptions:function(t){var e=[{value:"",text:"Group"}];return o()(t).forEach(function(a){e.push({text:t[a].Group.name,value:t[a].Group.id})}),e}}},b=a("XyMi");var k=function(t){a("R3I8"),a("OEkN")},y=Object(b.a)(S,function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("div",{staticClass:"ui-block"},[a("h4",{staticClass:"ui-block-heading"},[t._v("Quản lý đánh giá nhân viên")]),t._v(" "),a("hr"),t._v(" "),a("div",{staticClass:"mb-2"},[a("b-row",{staticClass:"h-col-50"},[a("b-col",{attrs:{md:"2"}},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.staff_code,expression:"staff_code"}],staticClass:"form-control",attrs:{placeholder:"Mã Profile",type:"number",min:"9",max:"12"},domProps:{value:t.staff_code},on:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.searchEvaluation(e)},input:function(e){e.target.composing||(t.staff_code=e.target.value)}}})]),t._v(" "),a("b-col",{attrs:{md:"2"}},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.keyword,expression:"keyword"}],staticClass:"form-control",attrs:{type:"text",placeholder:"username, Họ tên"},domProps:{value:t.keyword},on:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.searchEvaluation(e)},input:function(e){e.target.composing||(t.keyword=e.target.value)}}})]),t._v(" "),a("b-col",{attrs:{md:"2"}},[a("single-select-profile-region",{on:{handleSelectedRegion:t.handleSelectedRegion}})],1),t._v(" "),a("b-col",{attrs:{md:"2"}},[a("single-select-province",{on:{handleSelectedProvince:t.handleSelectedProvince}})],1),t._v(" "),a("b-col",{attrs:{md:"2"}},[a("single-select-station",{attrs:{"province-id":t.provinceId},on:{handleSelectedStation:t.handleSelectedStation}})],1),t._v(" "),a("b-col",{attrs:{md:"2"}},[a("single-select-department",{on:{handleSelectedDepartment:t.handleSelectedDepartment}})],1),t._v(" "),a("b-col",{staticClass:"mb-2",attrs:{md:"2"}},[a("single-select-position",{attrs:{departmentName:t.departmentName,"position-job":t.positionId},on:{handleSelectedPosition:t.handleSelectedPosition}})],1),t._v(" "),a("b-col",{staticClass:"mb-2",attrs:{md:"2"}},[a("single-select-work-type",{attrs:{"position-job":t.positionId,"work-type-id":t.work_type_id},on:{handleSelectedWorkType:t.handleSelectedWorkType}})],1),t._v(" "),a("b-col",{staticClass:"mb-2",attrs:{md:"2"}},[a("single-select-module",{attrs:{"station-id":t.stationId,"module-id":t.moduleId,selectLabel:"Chọn"},on:{handleSelectedModule:t.handleSelectedModule}})],1),t._v(" "),a("b-col",{staticClass:"mb-2",attrs:{md:"2"}},[a("flat-pickr",{attrs:{config:t.rangeConfig,placeholder:t.time_format.from+" to "+t.time_format.to},model:{value:t.range_time,callback:function(e){t.range_time=e},expression:"range_time"}})],1)],1),t._v(" "),a("b-row",[a("b-col",{staticClass:"text-right",attrs:{md:"12"}},[a("b-btn",{attrs:{type:"button",variant:"primary"},on:{click:function(e){return t.searchEvaluation()}}},[a("i",{staticClass:"sidenav-icon ion ion-md-search"}),t._v(" Tìm kiếm")])],1)],1)],1),t._v(" "),a("div",{staticClass:"mb-3"},[a("div",{directives:[{name:"loading",rawName:"v-loading",value:t.appLoading,expression:"appLoading"}],staticClass:"wrapper-list-master"},[t.evaluations.length>0?a("b-card",{attrs:{"no-body":""}},[a("table",{staticClass:"table b-table table-striped table-hover is_align_middle"},[a("thead",[a("tr",[a("th",[t._v("STT")]),t._v(" "),a("th",[t._v("Mã nhân viên")]),t._v(" "),a("th",[t._v("Tên nhân viên")]),t._v(" "),a("th",[t._v("Số điện thoại")]),t._v(" "),a("th",[t._v("Username")]),t._v(" "),a("th",[t._v("Group")]),t._v(" "),a("th",[t._v("Module")]),t._v(" "),a("th",[t._v("Cần cải thiện")]),t._v(" "),a("th",[t._v("Bình thường")]),t._v(" "),a("th",[t._v("Đáng khen ngợi")]),t._v(" "),a("th",[t._v("Thẻ vàng")]),t._v(" "),a("th",[t._v("Thẻ đỏ")]),t._v(" "),a("th",[t._v("Shop vote")]),t._v(" "),a("th",[t._v("Action")])])]),t._v(" "),a("tbody",t._l(t.evaluations,function(e,n){return a("tr",[a("td",[t._v(t._s((t.currentPage-1)*t.perPage+n+1))]),t._v(" "),a("td",[t._v(t._s(e.staff_code))]),t._v(" "),a("td",[e.link_avatar?a("img",{staticClass:"rounded-circle",staticStyle:{"border-radius":"50%"},attrs:{src:e.link_avatar,width:"35",height:"35",alt:"avatar"}}):t._e(),t._v("\n                                   "+t._s(e.fullname)+"\n                            ")]),t._v(" "),a("td",[t._v(t._s(e.tel))]),t._v(" "),a("td",[t._v(t._s(e.username))]),t._v(" "),a("td",[t._v(t._s(e.group))]),t._v(" "),a("td",[t._v(t._s(e.module))]),t._v(" "),a("td",[t._v(t._s(e.manager.need_improve))]),t._v(" "),a("td",[t._v(t._s(e.manager.normal))]),t._v(" "),a("td",[t._v(t._s(e.manager.praise))]),t._v(" "),a("td",[t._v(t._s(e.recompense.yellow_card))]),t._v(" "),a("td",[t._v(t._s(e.recompense.red_card))]),t._v(" "),t.checkGroupUser(e.group_id)?a("td",[t._v("\n                                "+t._s(Math.round(e.shop.average_vote))),a("i",{staticClass:"ion ion-ios-star yellow-icon"}),t._v("\n                                / "+t._s(e.shop.count_vote)+" lượt vote\n                            ")]):a("td",[t._v("Không có dữ liệu")]),t._v(" "),a("td",[a("router-link",{staticClass:"btn btn-md btn-outline-info",attrs:{to:{name:"detail-evaluation",params:{id:e.user_id},query:{from:t.time_format.from,to:t.time_format.to}}}},[a("i",{staticClass:"ion ion-md-eye"})])],1)])}),0)]),t._v(" "),t.totalPages>1?a("div",{staticClass:"mt-3"},[a("b-row",[a("b-col",{attrs:{md:"6"}},[a("b-pagination",{attrs:{"total-rows":t.totalItems,"per-page":t.perPage},on:{input:t.search},model:{value:t.currentPage,callback:function(e){t.currentPage=e},expression:"currentPage"}})],1),t._v(" "),a("b-col",{attrs:{md:"6"}},[a("span",{staticClass:"text-muted"},[t._v("Trang "+t._s(t.currentPage)+" trên "+t._s(t.totalPages))])])],1)],1):t._e()]):t._e(),t._v(" "),!1===t.appLoading&&0===t.evaluations.length?a("div",[a("span",{staticClass:"pl-3 font-weight-bold"},[t._v("Rất tiếc, không tìm thấy profile phù hợp.")])]):t._e()],1)])])])},[],!1,k,"data-v-d7a6a7a4",null);e.default=y.exports}});