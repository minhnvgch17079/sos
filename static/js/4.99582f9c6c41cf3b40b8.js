webpackJsonp([4],{"3Tsc":function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var s=a("RUzx"),i=a.n(s),o=a("IC97"),n=a("qaB4"),r=a("7+uW"),l=a("agCp"),d=a("sUu7"),c=a("+cgA"),u=a("a/7L"),f=a("5vjp"),m=a("Gqp4"),h=a("ufke"),p=a("csCE"),v=a("YlZe"),_=a("n9Ve"),g=a("Y/vs"),b={name:"modal-create-fast-contract",components:{},props:["user","isCod","isWhStaff"],data:function(){return{trialSalaryWhStaff:0,typeContract:"parttime",contractOptions:[{text:"Hợp tác kinh doanh",value:"partnership"},{text:"Cộng tác viên",value:"parttime"}]}},created:function(){},watch:{},methods:{hideModal:function(){this.$refs.createContractModalRef.hide()},createFastContract:function(){var t=this;this.$startLoading();var e={user_id:this.user.id,has_kpi:0,trial_salary_wf_staff:this.trialSalaryWhStaff,type_contract:this.typeContract};""===this.typeContract&&delete e.type_contract,g.a.fastCreateContract(e).then(function(e){e.data.success?(t.$notify({group:"default",type:"bg-success text-white",title:"Thông báo",text:"Bạn đã tạo hợp đồng nhanh thành công!"}),setTimeout(function(){t.$router.go()},1e3)):t.$notify({group:"default",type:"bg-warning text-dark",title:"Thông báo",text:e.data.message})}).catch(function(t){console.log(t)}).then(function(){t.$stopLoading(),t.$refs.createContractModalRef.hide()})},resetDefault:function(){}}},C=a("XyMi"),y=Object(C.a)(b,function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("b-modal",{ref:"createContractModalRef",attrs:{id:"modal-create-fast-contract",static:""},on:{hidden:t.resetDefault}},[a("div",{attrs:{slot:"modal-title"},slot:"modal-title"},[t._v("\n      Tạo hợp đồng nhanh\n    ")]),t._v(" "),a("div",[t.isWhStaff?a("div",[a("div",{staticClass:"col-form-label pt-0"},[t._v("Lương thử việc nhân viên xử lý hàng")]),t._v(" "),a("b-form-input",{attrs:{type:"number",placeholder:"Nhập lương thử việc"},model:{value:t.trialSalaryWhStaff,callback:function(e){t.trialSalaryWhStaff=e},expression:"trialSalaryWhStaff"}})],1):a("div",[a("div",{staticClass:"col-form-label pt-0"},[t._v("Chọn loại hợp đồng")]),t._v(" "),a("b-form-select",{attrs:{options:t.contractOptions},model:{value:t.typeContract,callback:function(e){t.typeContract=e},expression:"typeContract"}})],1)]),t._v(" "),a("template",{slot:"modal-footer"},[a("button",{staticClass:"btn btn-secondary",attrs:{type:"button"},on:{click:t.hideModal}},[t._v("Cancel")]),t._v(" "),a("button",{staticClass:"btn btn-primary",attrs:{type:"button"},on:{click:t.createFastContract}},[t._v("Tạo hợp đồng")])])],2)],1)},[],!1,null,null,null).exports,w=a("phbQ"),k={name:"modal-profile-log",components:{},props:["profileId","show"],data:function(){return{logFieldLocale:{position_job_name:"Vị trí làm việc",ranking:"Cấp bậc nhân viên",manager_level:"Cấp bậc quản lý",start_date_day:"Ngày lương chuẩn",validate_tel:"Xác minh số điện thoại",group_name:"Nhóm",status_id:"Trạng thái",station_name:"Kho",module_name:"Module tính lương",virtual_user:"Tài khoản ảo",master_profile:"Master Profile"},validateTels:{1:"Đã xác minh",0:"Chưa xác minh"},virtualUsers:{0:"Không phải là tài khoản ảo",1:"Là tài khoản ảo"},statusNames:{1:"Không hoạt động",2:"Bị khóa",3:"Đang hoạt động"},loading:!0,logs:[]}},watch:{show:function(t,e){this.getLogs(this.profileId),this.$refs["modal-log"].show()}},methods:{hideModal:function(){this.$refs["modal-log"].hide()},getLogs:function(t){var e=this;this.loading=!0;var a={profile_id:t};w.a.getLogs(a).then(function(t){t.data.success&&(e.logs=t.data.data,e.formatData(),console.log(e.logs))}).catch(function(t){console.log(t)}).then(function(){e.loading=!1})},formatData:function(){var t=this;this.logs.forEach(function(e){e.data.validate_tel&&(e.data.validate_tel=t.validateTels[""+e.data.validate_tel]),e.data.virtual_user&&(e.data.virtual_user=t.virtualUsers[""+e.data.virtual_user]),e.data.status_id&&(e.data.status_id=t.statusNames[""+e.data.status_id])})}}};var x=function(t){a("teh7"),a("xqhi")},S=Object(C.a)(k,function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("b-modal",{ref:"modal-log",attrs:{scrollable:"",id:"modal-logs",size:"lg",title:"Lịch sử thay đổi tài khoản",static:""}},[t.loading?a("div",[a("div",{staticClass:"sk-wave sk-primary"},[a("div",{staticClass:"sk-rect sk-rect1"}),t._v(" "),a("div",{staticClass:"sk-rect sk-rect2"}),t._v(" "),a("div",{staticClass:"sk-rect sk-rect3"}),t._v(" "),a("div",{staticClass:"sk-rect sk-rect4"}),t._v(" "),a("div",{staticClass:"sk-rect sk-rect5"})])]):a("div",[0==t.logs.length?a("div",[a("p",[t._v("Không có lịch sử thay đổi tài khoản")])]):t._e(),t._v(" "),a("div",{staticClass:"scrollable strip"},t._l(t.logs,function(e,s){return a("div",{key:s,staticClass:"row",staticStyle:{padding:"8px"}},[a("div",{staticClass:"col-4 text-center"},[a("router-link",{staticClass:"mt-2",attrs:{to:{name:"edit-user",params:{id:e.created_user_id}}}},[t._v(t._s(e.created_username))]),t._v(" "),a("br"),t._v("\n            "+t._s(e.created)+"\n        ")],1),t._v(" "),a("div",{staticClass:"col-8"},t._l(e.data,function(e,s){return a("div",{key:s},[s in t.logFieldLocale?a("p",["master_profile"===s?[t._v("\n                  Cập nhật master profile mới: "),a("b",[a("router-link",{attrs:{to:{name:"edit-master-profile",params:{id:e.id}}}},[t._v(t._s(e.fullname)+"("+t._s(e.staff_code)+")")])],1)]:[t._v("\n                Cập nhật "),a("b",[t._v('"'+t._s(t.logFieldLocale[s])+'"')]),t._v(" mới: "),a("b",[t._v(t._s(e))])]],2):t._e()])}),0)])}),0)]),t._v(" "),a("div",{attrs:{slot:"modal-footer"},slot:"modal-footer"},[a("b-button",{staticClass:"float-right",attrs:{variant:"primary"},on:{click:function(e){return t.hideModal()}}},[t._v("\n    Đóng\n    ")])],1)])},[],!1,x,"data-v-3ffd4daa",null).exports,P=a("VvlD"),L=a("9Wgl");r.default.use(d.a);var M={name:"AddUser",components:{LaddaBtn:n.a,Notification:Notification,Multiselect:i.a,Datepicker:o.a,MultiSelectUser:c.a,SingleSelectStation:u.a,SingleSelectModule:f.a,SingleSelectMasterProfile:m.a,SingleSelectWorkType:h.a,SingleSelectDepartment:p.a,SingleSelectPosition:v.a,SingleSelectValidCodFormula:_.a,ModalCreateFastContract:y,ModalProfileLog:S},data:function(){return{isProcessingUpdate:!1,selectedModule:null,whStaffPositions:L.a.WH_STAFF_POSITIONS,isChangePass:!1,leaders:null,employees:null,userdata:{id:null,profile_id:null,contract_id:null,department:"",department_id:"",position_job:"",work_type_id:"",default_work:[],station_id:"",module_id:"",ranking:"",manager_level:"",start_date_day:"",cod_formula:0,created:"",created_by:"",modified_by:"",user_password:"",username:""},masterProfile:{master_id:""},masterInfo:{},options:{default_work:[{text:"Lên xuống tải",value:"loading_unloading"},{text:"Đóng bao",value:"bagging"},{text:"Sorting",value:"sorting"},{text:"Làm hàng",value:"labeling"}],ranking:[{text:"Chọn cấp bậc",value:""},{text:"F1",value:"F1"},{text:"F2",value:"F2"},{text:"J1",value:"J1"},{text:"J2",value:"J2"},{text:"J3",value:"J3"},{text:"S1",value:"S1"},{text:"S2",value:"S2"},{text:"S3",value:"S3"},{text:"S4",value:"S4"},{text:"S5",value:"S5"},{text:"Xóa cấp bậc",value:" "}],manager_level:[{text:"Chọn cấp quản lý",value:""},{text:"M1",value:"M1"},{text:"M2",value:"M2"},{text:"M3",value:"M3"},{text:"M4",value:"M4"},{text:"M5",value:"M5"},{text:"M6",value:"M6"},{text:"M7",value:"M7"},{text:"M8",value:"M8"},{text:"M9",value:"M9"},{text:"M10",value:"M10"},{text:"Xóa cấp quản lý",value:" "}]},show_defaultwork:!1,allow_edit_level:!1,notify:{message:"",class:"",title:"",duration:""},notify_add_user:{showDismissibleAlert:!1,message:"",type:""},toogleLog:!1,searchData:{selectLeader:[],selectEmployee:[],loadingSearch:!1},time_format:"",canCustomUserName:!1}},created:function(){this.getStartEndFromTimeRange()},computed:{isAdd:function(){return"add-user"===this.$route.name},isEdit:function(){return"edit-user"===this.$route.name},isCod:function(){return!!this.userdata.department&&"cod"===this.userdata.department.toLowerCase()},isWhStaff:function(){return!!this.userdata.position_job&&[40,41,42,70].includes(parseInt(this.userdata.position_job))},hasContract:function(){return null!=this.userdata.contract_id}},watch:{userdata:{handler:function(t){var e=this;if(this.whStaffPositions.includes(parseInt(this.userdata.position_job))?this.show_defaultwork=!0:this.show_defaultwork=!1,this.userdata.position_job){var a={user_id:this.userdata.id};l.a.checkEditLevel(a).then(function(t){t.data.hasOwnProperty("success")&&t.data.success&&(e.allow_edit_level=t.data.allow_edit)})}},deep:!0},"userdata.position_job":function(t){this.checkCanCustomUserName(t)},isChangePass:function(t,e){!1===t&&(this.userdata.user_password="")}},mounted:function(){if(this.isAdd)this.$route.params.id&&(this.masterProfile.master_id=this.$route.params.id);else{if(!this.$route.params.id)return;this.$route.params.id&&this.getDetail(this.$route.params.id)}},methods:{getStartEndFromTimeRange:function(){return this.time_format={from:P.a.daysInThisMonth(21,20).from,to:P.a.daysInThisMonth(21,20).to},!0},checkCanCustomUserName:function(t){var e=this,a={position_job:t};l.a.checkCanCustomUserName(a).then(function(t){t.data.success?e.canCustomUserName=!0:e.canCustomUserName=!1}).catch(function(t){console.log(t)})},selectedLeader:function(t){this.searchData.selectLeader=t},selectedEmployee:function(t){this.searchData.selectEmployee=t},getListLeaderByStaff:function(t){var e=this,a={userId:t,isLeader:1};l.a.getListUser(a).then(function(t){t.data.success&&(e.leaders=t.data.data)}).catch(function(t){console.log(t)})},getListStaffByLeader:function(t){var e=this,a={userId:t,isLeader:0};l.a.getListUser(a).then(function(t){t.data.success&&(e.employees=t.data.data)}).catch(function(t){console.log(t)})},toggleLogModal:function(){this.toogleLog=!this.toogleLog},getDetail:function(t){var e=this;this.$startLoading();var a={user_id:t};l.a.getUser(a).then(function(t){if(t.data.hasOwnProperty("success"))if(t.data.success){var a=t.data.data;e.masterProfile.master_id=a.MasterProfile.id,e.userdata.contract_id=a.EmpContract.id,e.userdata.id=a.User.id,e.userdata.profile_id=a.EmpProfile.id,e.userdata.username=a.User.username,e.userdata.department=a.EmpDepartment.name,e.userdata.department_id=a.EmpDepartment.id,e.userdata.position_job=a.EmpProfile.position_job,e.userdata.work_type_id=a.UserWorkType.work_type_id,e.userdata.default_work=a.EmpProfile.default_work?a.EmpProfile.default_work:[],e.userdata.start_date_day=a.EmpProfile.start_date_day,e.userdata.station_id=a.Station.id,e.userdata.module_id=a.User.module_id,e.userdata.created_by=a.User.created_by,e.userdata.created=a.User.created,e.userdata.modified_by=a.User.modified_by,e.userdata.ranking=a.EmpProfile.ranking,e.userdata.manager_level=a.EmpProfile.manager_level,e.userdata.cod_formula=parseInt(t.data.cod_formula.formula),e.masterInfo=a.MasterProfile,e.getListLeaderByStaff(e.userdata.id),e.getListStaffByLeader(e.userdata.id)}else e.notify.success=!1,e.notify.message=t.data.message,e.showNotification(!1);else e.notify.message="Có lỗi xảy ra, không load được thông tin tài khoản",e.showNotification(!1)}).catch(function(t){console.log(t)}).then(function(){e.$stopLoading()})},showNotification:function(t){var e="bg-success text-white";t||(e="bg-warning text-dark"),this.$notify({group:"add-user",title:this.notify.title,text:this.notify.message,type:e,duration:this.notify.duration})},addUser:function(){var t=this;if(!this.validateForm())return!1;this.isProcessingUpdate=!0,this.$startLoading(),this.$validator.validateAll().then(function(e){if(e){var a=t.userdata;a.master_id=t.masterProfile.master_id,l.a.addUser(a).then(function(e){if(e.data.hasOwnProperty("success"))if(e.data.success){var a=e.data.data.user_id;t.notify_add_user.type="success",t.notify_add_user.showDismissibleAlert=!0,t.notify_add_user.message=e.data.message,t.getDetail(a),t.$router.push({name:"edit-user",params:{id:a}})}else t.notify.success=!1,t.notify.message=e.data.message,t.showNotification(!1);else t.notify.success=!1}).catch(function(e){t.notify.success=!1,t.notify.message="Có lỗi xảy ra, liên hệ IT để được hỗ trợ",t.showNotification(!1)}).then(function(){t.isProcessingUpdate=!1})}else t.isProcessingUpdate=!1,t.notify.success=!1,t.notify.message="Vui lòng nhập đủ thông tin yêu cầu",t.showNotification(!1)}).catch(function(t){console.log(t)}).then(function(){t.$stopLoading()})},editUser:function(){var t=this;if(!this.validateForm())return!1;this.isProcessingUpdate=!0,this.$startLoading(),this.$validator.validateAll().then(function(e){if(e){var a=t.userdata;delete a.username,a.user_id=t.$route.params.id,a.master_id=t.masterProfile.master_id,l.a.editUser(a).then(function(e){e.data.hasOwnProperty("success")?e.data.success?(t.notify.success=!0,t.notify.message=e.data.message,t.showNotification(!0)):(t.notify.success=!1,t.notify.message=e.data.message,t.showNotification(!1)):(t.notify.success=!1,t.notify.message="Có lỗi xảy ra, vui lòng thử lại",t.showNotification(!0))}).catch(function(t){console.log(t)}).then(function(){t.isProcessingUpdate=!1})}else t.isProcessingUpdate=!1,t.notify.success=!1,t.notify.message="Vui lòng nhập đủ thông tin yêu cầu",t.showNotification(!1)}).catch(function(t){console.log(t)}).then(function(){t.$stopLoading()})},updateLeaderForStaff:function(){var t=this,e=this.searchData.selectLeader.map(function(t){return t.id}),a={staffId:this.userdata.id,leaderIds:e};l.a.updateLeaderForStaff(a).then(function(e){e.data.success&&(t.notify.success=!0,t.notify.message=e.data.message,t.showNotification(!0))}).catch(function(t){console.log(t)})},updateStaffForLeader:function(){var t=this,e=this.searchData.selectEmployee.map(function(t){return t.id}),a={leaderId:this.userdata.id,staffIds:e};l.a.updateStaffForLeader(a).then(function(e){e.data.success&&(t.notify.success=!0,t.notify.message=e.data.message,t.showNotification(!0))}).catch(function(t){console.log(t)})},getMasterProfile:function(t){var e=this,a={master_id:t};l.a.getMasterProfile(a).then(function(t){t.data.success&&(e.masterInfo=t.data.data)})},handleChooseMasterProfile:function(t){this.masterProfile.master_id=t?t.id:"",this.getMasterProfile(t.id)},handleSelectedModule:function(t){this.userdata.module_id=t?t.id:""},handleSelectedStation:function(t){this.userdata.station_id=t?t.id:""},handleSelectedDepartment:function(t){this.userdata.department_id=t?t.id:"",this.userdata.department=t?t.name:""},handleSelectedPosition:function(t){this.userdata.position_job=t?t.id:""},handleSelectedWorkType:function(t){this.userdata.work_type_id=t?t.id:""},handleSelectedFormula:function(t){this.userdata.cod_formula=t?t.value:""},loadingChecked:function(t){},baggingChecked:function(t){this.userdata.default_work.includes("bagging")?this.userdata.default_work=this.userdata.default_work.filter(function(t){return"bagging"!==t}):this.userdata.default_work.push("bagging"),this.userdata.default_work=this.userdata.default_work.filter(function(t){return"sorting"!==t}),this.userdata.default_work=this.userdata.default_work.filter(function(t){return"labeling"!==t})},sortingChecked:function(t){this.userdata.default_work.includes("sorting")?this.userdata.default_work=this.userdata.default_work.filter(function(t){return"sorting"!==t}):this.userdata.default_work.push("sorting"),this.userdata.default_work=this.userdata.default_work.filter(function(t){return"bagging"!==t}),this.userdata.default_work=this.userdata.default_work.filter(function(t){return"labeling"!==t})},labelingChecked:function(t){this.userdata.default_work.includes("labeling")?this.userdata.default_work=this.userdata.default_work.filter(function(t){return"labeling"!==t}):this.userdata.default_work.push("labeling"),this.userdata.default_work=this.userdata.default_work.filter(function(t){return"bagging"!==t}),this.userdata.default_work=this.userdata.default_work.filter(function(t){return"sorting"!==t})},validateForm:function(){return!(this.whStaffPositions.includes(parseInt(this.userdata.position_job))&&(!this.userdata.default_work||0===this.userdata.default_work.length))||(this.notify.success=!1,this.notify.message="Vui lòng chọn công việc mặc định",this.showNotification(!1),!1)}}};var N=function(t){a("LZVb"),a("6aA6"),a("ME8P")},$=Object(C.a)(M,function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"update-user"},[a("div",{staticClass:"row header"},[a("div",{staticClass:"col-md-8"},[t.isAdd?a("h2",[t._v("Thêm tài khoản")]):a("h2",[t._v("Sửa thông tin tài khoản")])]),t._v(" "),a("div",{staticClass:"col-md-4"},[a("b-row",[a("b-col",{staticClass:"text-right",attrs:{md:"12"}},["edit-user"===t.$route.name?a("b-btn",{attrs:{variant:"btn btn-outline-secondary"},on:{click:t.toggleLogModal}},[t._v("Lịch sử thay đổi tài khoản")]):t._e(),t._v(" "),a("router-link",{staticClass:"btn btn-outline-success ml-1",attrs:{to:{name:"manager-master-profile"}}},[a("i",{staticClass:"ion ion-ios-arrow-back"}),t._v(" Quản lý Profile")])],1)],1)],1)]),t._v(" "),a("div",{staticClass:"row"},[a("div",{staticClass:"col-md-12 create-user"},[a("div",{staticClass:"card mb-4"},[a("div",{staticClass:"row no-gutters row-bordered"},[a("div",{staticClass:"col-md-4 find-master-profile"},[a("div",{staticClass:"col-md-12 col-lg-12 col-xl-12"},[t._m(0),t._v(" "),a("div",{staticClass:"card-body"},[t.isAdd?a("b-form-group",{staticClass:"w-100",attrs:{label:"Tìm kiếm Profile"}},[a("b-input-group",[a("single-select-master-profile",{attrs:{"show-info":!0,"master-id":t.masterProfile.master_id},on:{handleChooseMasterProfile:t.handleChooseMasterProfile},model:{value:t.masterProfile.master_id,callback:function(e){t.$set(t.masterProfile,"master_id",e)},expression:"masterProfile.master_id"}})],1)],1):t._e(),t._v(" "),a("div",{staticClass:"row"},[a("div",{staticClass:"col-6 col-xl-5 text-muted mb-3"},[t._v("Họ tên")]),t._v(" "),a("div",{staticClass:"col-6 col-xl-7 mb-3"},[a("span",{staticClass:"text-big"},[t._v(t._s(t.masterInfo.fullname))])]),t._v(" "),a("div",{staticClass:"col-6 col-xl-5 text-muted mb-3"},[t._v("Mã nhân viên")]),t._v(" "),a("div",{staticClass:"col-6 col-xl-7 mb-3"},[a("span",{staticClass:"text-big"},[t._v(t._s(t.masterInfo.staff_code))])]),t._v(" "),a("div",{staticClass:"col-6 col-xl-5 text-muted mb-3"},[t._v("Số CMT")]),t._v(" "),a("div",{staticClass:"col-6 col-xl-7 mb-3"},[a("span",{staticClass:"text-big"},[t._v(t._s(t.masterInfo.personal_id_number))])]),t._v(" "),a("div",{staticClass:"col-6 col-xl-5 text-muted mb-3"},[t._v("Điện thoại")]),t._v(" "),a("div",{staticClass:"col-6 col-xl-7 mb-3"},[a("span",{staticClass:"text-big"},[t._v(t._s(t.masterInfo.tel))])]),t._v(" "),a("div",{staticClass:"col-6 col-xl-5 text-muted mb-3"},[t._v("Email")]),t._v(" "),a("div",{staticClass:"col-6 col-xl-7 mb-3"},[a("span",{staticClass:"text-big"},[t._v(t._s(t.masterInfo.personal_email))])])]),t._v(" "),t.isEdit?a("div",[a("router-link",{attrs:{to:{name:"detail-evaluation",params:{id:t.$route.params.id},query:{from:t.time_format.from,to:t.time_format.to}}}},[t._v("Thông tin đánh giá trong tháng "),a("i",{staticClass:"ion ion-ios-arrow-dropright"})])],1):t._e(),t._v(" "),a("div",[a("router-link",{attrs:{to:{name:"edit-master-profile",params:{id:t.masterProfile.master_id}}}},[t._v("Chi tiết profile "),a("i",{staticClass:"ion ion-ios-arrow-dropright"})])],1)],1)])]),t._v(" "),a("div",{staticClass:"col-md-8 input-user-info"},[a("div",{staticClass:"row no-gutters"},[a("div",{staticClass:"col-md-12 col-lg-12 col-xl-12"},[t._m(1),t._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:t.masterProfile.master_id,expression:"masterProfile.master_id"}],staticClass:"card-body"},[a("b-form-row",[t.isEdit?a("b-form-group",{staticClass:"col-md-4",attrs:{label:"Username"}},[a("b-form-input",{attrs:{disabled:!0,value:t.userdata.username}})],1):t._e(),t._v(" "),a("b-form-group",{staticClass:"col-md-4",attrs:{label:"Ngày vào"}},[a("datepicker",{attrs:{typeable:!0,name:"join-date",format:"dd-MM-yyyy",bootstrapStyling:!0,"monday-first":!0,"full-month-name":!0,placeholder:"Ngày vào","calendar-button":!0,"calendar-button-icon":"ion ion-md-calendar","clear-button":!0,disabled:!0},model:{value:t.masterInfo.join_date,callback:function(e){t.$set(t.masterInfo,"join_date",e)},expression:"masterInfo.join_date"}})],1)],1),t._v(" "),a("b-form-row",[a("b-form-group",{staticClass:"col-md-4",attrs:{label:"Chọn kho"}},[a("single-select-station",{attrs:{"station-id":t.userdata.station_id,selectLabel:"Chọn"},on:{handleSelectedStation:t.handleSelectedStation}}),t._v(" "),a("input",{directives:[{name:"validate",rawName:"v-validate",value:"required",expression:"'required'"},{name:"model",rawName:"v-model",value:t.userdata.station_id,expression:"userdata.station_id"}],attrs:{type:"hidden",name:"input-station"},domProps:{value:t.userdata.station_id},on:{input:function(e){e.target.composing||t.$set(t.userdata,"station_id",e.target.value)}}}),t._v(" "),a("span",{directives:[{name:"show",rawName:"v-show",value:"required"==t.errors.firstRule("input-station"),expression:"errors.firstRule('input-station') == 'required'"}],staticClass:"help is-danger"},[t._v("Không để trống trường này ")])],1),t._v(" "),a("b-form-group",{staticClass:"col-md-4",attrs:{label:"Module tính lương"}},[a("single-select-module",{attrs:{"station-id":t.userdata.station_id,"module-id":t.userdata.module_id,selectLabel:"Chọn"},on:{handleSelectedModule:t.handleSelectedModule}})],1),t._v(" "),a("b-form-group",{staticClass:"col-md-4",attrs:{label:"Ngày lương chuẩn"}},[a("datepicker",{attrs:{format:"dd-MM-yyyy",bootstrapStyling:!0,"monday-first":!0,"full-month-name":!0,placeholder:"Ngày lương chuẩn",required:!0,"calendar-button":!0,"calendar-button-icon":"ion ion-md-calendar","clear-button":!0},model:{value:t.userdata.start_date_day,callback:function(e){t.$set(t.userdata,"start_date_day",e)},expression:"userdata.start_date_day"}})],1)],1),t._v(" "),a("b-form-row",[a("b-form-group",{staticClass:"col-md-4",attrs:{label:"Chọn bộ phận"}},[a("single-select-department",{attrs:{"department-id":t.userdata.department_id},on:{handleSelectedDepartment:t.handleSelectedDepartment}}),t._v(" "),a("input",{directives:[{name:"validate",rawName:"v-validate",value:"required",expression:"'required'"},{name:"model",rawName:"v-model",value:t.userdata.department_id,expression:"userdata.department_id"}],attrs:{type:"hidden",name:"input-department"},domProps:{value:t.userdata.department_id},on:{input:function(e){e.target.composing||t.$set(t.userdata,"department_id",e.target.value)}}}),t._v(" "),a("span",{directives:[{name:"show",rawName:"v-show",value:"required"==t.errors.firstRule("input-department"),expression:"errors.firstRule('input-department') == 'required'"}],staticClass:"help is-danger"},[t._v("Không để trống trường này ")])],1),t._v(" "),a("b-form-group",{staticClass:"col-md-4",attrs:{label:"Chọn vị trí"}},[a("single-select-position",{attrs:{"department-id":t.userdata.department_id,"position-job":t.userdata.position_job},on:{handleSelectedPosition:t.handleSelectedPosition}}),t._v(" "),a("input",{directives:[{name:"validate",rawName:"v-validate",value:"required",expression:"'required'"},{name:"model",rawName:"v-model",value:t.userdata.position_job,expression:"userdata.position_job"}],attrs:{type:"hidden",name:"input-position"},domProps:{value:t.userdata.position_job},on:{input:function(e){e.target.composing||t.$set(t.userdata,"position_job",e.target.value)}}}),t._v(" "),a("span",{directives:[{name:"show",rawName:"v-show",value:"required"==t.errors.firstRule("input-position"),expression:"errors.firstRule('input-position') == 'required'"}],staticClass:"help is-danger"},[t._v("Không để trống trường này ")])],1),t._v(" "),a("b-form-group",{staticClass:"col-md-4",attrs:{label:"Kiểu nhân viên"}},[a("single-select-work-type",{attrs:{"position-job":t.userdata.position_job,"work-type-id":t.userdata.work_type_id},on:{handleSelectedWorkType:t.handleSelectedWorkType}}),t._v(" "),a("input",{directives:[{name:"validate",rawName:"v-validate",value:"required",expression:"'required'"},{name:"model",rawName:"v-model",value:t.userdata.work_type_id,expression:"userdata.work_type_id"}],attrs:{type:"hidden",name:"input-work-type"},domProps:{value:t.userdata.work_type_id},on:{input:function(e){e.target.composing||t.$set(t.userdata,"work_type_id",e.target.value)}}}),t._v(" "),a("span",{directives:[{name:"show",rawName:"v-show",value:"required"==t.errors.firstRule("input-work-type"),expression:"errors.firstRule('input-work-type') == 'required'"}],staticClass:"help is-danger"},[t._v("Không để trống trường này ")])],1)],1),t._v(" "),t.canCustomUserName&&t.isAdd?a("b-form-row",[a("b-form-group",{staticClass:"col-md-6",attrs:{label:"Username của tài xế xe thuê",id:"input-group-user-name"}},[a("b-form-input",{directives:[{name:"validate",rawName:"v-validate",value:{required:!0,regex:/^[a-zA-Z0-9]*$/},expression:"{required: true, regex: /^[a-zA-Z0-9]*$/ }"}],class:{"is-danger":t.errors.has("input-user-name")},attrs:{id:"input-user-name",placeholder:"Nhập username",name:"input-user-name"},model:{value:t.userdata.username,callback:function(e){t.$set(t.userdata,"username",e)},expression:"userdata.username"}}),t._v(" "),a("span",{directives:[{name:"show",rawName:"v-show",value:"required"==t.errors.firstRule("input-user-name"),expression:"errors.firstRule('input-user-name') == 'required'"}],staticClass:"help is-danger"},[t._v("Không để trống trường này ")]),t._v(" "),a("span",{directives:[{name:"show",rawName:"v-show",value:"regex"==t.errors.firstRule("input-user-name"),expression:"errors.firstRule('input-user-name') == 'regex'"}],staticClass:"help is-danger"},[t._v("Vui lòng nhập chữ hoặc số")])],1)],1):t._e(),t._v(" "),t.isCod?a("b-form-row",[a("b-form-group",{staticClass:"col-md-6",attrs:{label:"Công thức lương COD"}},[a("single-select-valid-cod-formula",{attrs:{"station-id":this.userdata.station_id,"position-job":this.userdata.position_job,"work-type-id":this.userdata.work_type_id,formula:this.userdata.cod_formula},on:{handleSelectedFormula:t.handleSelectedFormula}})],1)],1):t._e(),t._v(" "),a("b-form-row",[a("b-form-group",{staticClass:"col-md-12",attrs:{label:"Thêm người quản lý",id:"input-group-tel"}},[a("multi-select-user",{attrs:{users:t.leaders},on:{onChange:t.selectedLeader}})],1)],1),t._v(" "),a("b-form-row",[a("b-form-group",{staticClass:"col-md-12",attrs:{label:"Thêm nhân viên",id:"input-group-tel"}},[a("multi-select-user",{attrs:{users:t.employees},on:{onChange:t.selectedEmployee}})],1)],1),t._v(" "),a("b-form-row",[a("b-form-group",{staticClass:"col-md-4",attrs:{disabled:!t.allow_edit_level,label:"Cấp bậc NV"}},[a("b-form-select",{attrs:{name:"select-ranking",options:t.options.ranking},model:{value:t.userdata.ranking,callback:function(e){t.$set(t.userdata,"ranking",e)},expression:"userdata.ranking"}})],1),t._v(" "),a("b-form-group",{staticClass:"col-md-4",attrs:{disabled:!t.allow_edit_level,label:"Cấp bậc quản lý"}},[a("b-form-select",{attrs:{name:"select-manager-level",options:t.options.manager_level},model:{value:t.userdata.manager_level,callback:function(e){t.$set(t.userdata,"manager_level",e)},expression:"userdata.manager_level"}})],1)],1),t._v(" "),a("b-form-row",{directives:[{name:"show",rawName:"v-show",value:t.show_defaultwork,expression:"show_defaultwork"}]},[a("b-form-group",{staticClass:"col-md-12",attrs:{label:"Công việc mặc định"}},[a("b-form-checkbox-group",{attrs:{id:"checkbox-default-work",name:"select-default-work"},model:{value:t.userdata.default_work,callback:function(e){t.$set(t.userdata,"default_work",e)},expression:"userdata.default_work"}},[a("b-form-checkbox",{staticClass:"custom-checkbox",attrs:{value:"loading_unloading"},on:{change:t.loadingChecked}},[t._v("Lên xuống tải")]),t._v(" "),a("b-form-checkbox",{staticClass:"custom-checkbox",attrs:{value:"bagging"},on:{change:t.baggingChecked}},[t._v("Đóng bao")]),t._v(" "),a("b-form-checkbox",{staticClass:"custom-checkbox",attrs:{value:"sorting"},on:{change:t.sortingChecked}},[t._v("Sorting")]),t._v(" "),a("b-form-checkbox",{staticClass:"custom-checkbox",attrs:{value:"labeling"},on:{change:t.labelingChecked}},[t._v("Làm hàng")])],1)],1)],1),t._v(" "),t.isEdit?a("b-form-row",{staticClass:"mb-4"},[a("div",{staticClass:"col-md-12"},[t.isChangePass?a("b-form-input",{staticClass:"w-50 d-inline-block",attrs:{type:"text",placeholder:"Nhập mật khẩu"},model:{value:t.userdata.user_password,callback:function(e){t.$set(t.userdata,"user_password",e)},expression:"userdata.user_password"}}):t._e(),t._v(" "),t.isChangePass?a("b-btn",{staticClass:"btn btn-default btn-sm",on:{click:function(e){t.isChangePass=!1}}},[t._v("Hủy thay đổi mật khẩu")]):a("b-btn",{staticClass:"btn btn-warning btn-sm",on:{click:function(e){t.isChangePass=!0}}},[t._v("Thay đổi mật khẩu")])],1)]):t._e(),t._v(" "),t.isEdit?a("b-form-row",[a("div",{staticClass:"col-3mb-3"},[a("span",{staticClass:"text-muted"},[t._v("Tạo bởi:")]),t._v(" "+t._s(this.userdata.created_by)+"\n                                            "),a("span",{staticClass:"font-italic"},[t._v("("+t._s(this.userdata.created)+")")])])]):t._e()],1),t._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:!t.masterProfile.master_id,expression:"!masterProfile.master_id"}],staticClass:"card-body"},[a("div",{staticClass:"alert alert-danger",staticStyle:{"text-align":"center"},attrs:{role:"alert","aria-live":"polite","aria-atomic":"true"}},[t._v("Vui lòng chọn profile trước khi thêm tài khoản ! nếu chưa có vui lòng tạo Profile")])])])])])])])])]),t._v(" "),a("div",{staticClass:"notification-user"},[a("b-alert",{attrs:{variant:t.notify_add_user.type,dismissible:"",fade:"",show:t.notify_add_user.showDismissibleAlert},on:{dismissed:function(e){t.notify_add_user.showDismissibleAlert=!1}}},[t._v("\n            "+t._s(t.notify_add_user.message)+"\n        ")])],1),t._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:t.masterProfile.master_id,expression:"masterProfile.master_id"}],staticClass:"card-footer border-0 text-center py-3"},[t.isEdit&&!t.hasContract?[t.isWhStaff||t.isCod?a("b-btn",{directives:[{name:"b-modal",rawName:"v-b-modal.modal-create-fast-contract",modifiers:{"modal-create-fast-contract":!0}}],attrs:{type:"button",variant:"btn btn-outline-success"}},[a("i",{staticClass:"ion ion-ios-add"}),t._v(" Tạo hợp đồng nhanh\n            ")]):t._e(),t._v(" "),a("router-link",{staticClass:"btn btn-outline-primary",attrs:{to:{name:"contract-create-username",params:{username:t.userdata.username}}}},[a("i",{staticClass:"ion ion-md-add"}),t._v("Tạo hợp đồng")])]:t.isEdit?a("router-link",{staticClass:"btn btn-success",attrs:{to:{name:"contract-detail",params:{id:t.userdata.contract_id}}}},[a("i",{staticClass:"ion ion-md-search"}),t._v(" Xem chi tiết hợp đồng")]):t._e(),t._v(" "),t.isAdd?a("ladda-btn",{staticClass:"btn btn-primary",attrs:{loading:t.isProcessingUpdate,"data-style":"expand-right"},nativeOn:{click:function(e){return t.addUser()}}},[a("i",{staticClass:"ion ion-ios-add"}),t._v(" Thêm tài khoản\n        ")]):a("ladda-btn",{staticClass:"btn btn-info",attrs:{loading:t.isProcessingUpdate,"data-style":"expand-right"},nativeOn:{click:function(e){t.editUser(),t.updateLeaderForStaff(),t.updateStaffForLeader()}}},[a("i",{staticClass:"icon ion-md-archive"}),t._v(" Cập nhật tài khoản\n        ")])],2),t._v(" "),a("div",[a("modal-create-fast-contract",{attrs:{user:t.userdata,"is-cod":t.isCod,"is-wh-staff":t.isWhStaff}})],1),t._v(" "),a("notifications",{attrs:{group:"add-user"}}),t._v(" "),a("modal-profile-log",{attrs:{show:t.toogleLog,"profile-id":t.userdata.profile_id}})],1)},[function(){var t=this.$createElement,e=this._self._c||t;return e("h6",{staticClass:"card-header"},[e("i",{staticClass:"ion  ion-ios-add-circle"}),this._v(" Thông tin\n                                master profile ")])},function(){var t=this.$createElement,e=this._self._c||t;return e("h6",{staticClass:"card-header"},[e("i",{staticClass:"ion  ion-ios-add-circle"}),this._v(" Thông tin tài khoản")])}],!1,N,null,null);e.default=$.exports},Gqp4:function(t,e,a){"use strict";var s=a("agCp"),i=a("RUzx"),o={name:"singe-select-master-profile",props:{masterId:{default:""},showInfo:{type:Boolean,default:!1}},components:{Multiselect:a.n(i).a},data:function(){return{profileOption:null,profileOptions:[],saveAllProfileOption:[],masterInfo:[]}},created:function(){this.getAllProfile()},watch:{profileOption:function(t,e){this.$emit("handleChooseMasterProfile",t)}},methods:{getAllProfile:function(){var t=this;this.$startLoading(),s.a.getAllMasterProfile().then(function(e){e.data.success&&(t.profileOptions=e.data.data,t.saveAllProfileOption=e.data.data,t.profileOption=t.masterId?t.profileOptions.find(function(e){return e.id===t.masterId}):null)}).catch(function(t){console.log("where error: handleChooseObjectType")}).then(function(){t.$stopLoading()})},search:function(t){var e=this.saveAllProfileOption.filter(function(e){return-1!==(e.name.toLowerCase()+e.staffCode.toLowerCase()+e.personalIdNumber.toLowerCase()).search(t)});e.length>0&&(this.profileOptions=e)},customLabel:function(t){return t.name+" - "+t.personalIdNumber}}},n=a("XyMi"),r=Object(n.a)(o,function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"w-100"},[a("multiselect",{attrs:{options:t.profileOptions,placeholder:"Tìm kiếm theo CMND, Họ tên, Mã nhân viên",label:"name","track-by":"name",selectedLabel:"Đã chọn",deselectLabel:"Bỏ chọn",selectLabel:"Chọn","custom-label":t.customLabel,"allow-empty":!1,searchable:!0,"internal-search":!1,"show-no-results":!1},on:{"search-change":t.search},model:{value:t.profileOption,callback:function(e){t.profileOption=e},expression:"profileOption"}},[a("span",{attrs:{slot:"noResult"},slot:"noResult"},[t._v("Rất tiếc. Không tìm thấy.")])])],1)},[],!1,null,null,null);e.a=r.exports},ME8P:function(t,e){},Vk8r:function(t,e){},"Y/vs":function(t,e,a){"use strict";var s=a("PikB");e.a={fastCreateContract:function(t){return s.a.post("AdContract/createDefaultContract",t)},getInitSalary:function(t){return s.a.get("AdContract/getInitSalary",{params:t})}}},n9Ve:function(t,e,a){"use strict";var s=a("phbQ"),i=a("RUzx"),o={name:"single-select-valid-cod-formula",components:{Multiselect:a.n(i).a},props:{placeholder:{type:String,default:"Chọn công thức tính lương COD"},positionJob:{type:String},workTypeId:{type:String},stationId:{type:String},formula:{type:Number},isDisabled:{type:Boolean}},data:function(){return{option:null,options:[],notify:{message:"",class:"",title:""}}},created:function(){this.getListFormulas()},watch:{option:function(t,e){this.$emit("handleSelectedFormula",t)},positionJob:function(t,e){this.autoChangeFormula()},workTypeId:function(t,e){this.autoChangeFormula()},stationId:function(t,e){this.autoChangeFormula()},formula:function(t,e){t&&this.setSelectedOption()}},methods:{clickFormula:function(t,e){t.disabled&&e.stopPropagation()},setSelectedOption:function(){var t=this;this.options.length>0&&this.formula&&(this.option=this.options.find(function(e){return parseInt(e.value)===parseInt(t.formula)}))},getListFormulas:function(){var t=this;s.a.getValidSalaryFormulasOfCod().then(function(e){e.data.success&&(t.options=e.data.data,t.setSelectedOption())}).catch(function(t){console.log(t)})},autoChangeFormula:function(){var t=this;if(this.stationId&&this.positionJob&&this.workTypeId){var e={position_job:this.positionJob,work_type_id:this.workTypeId,station_id:this.stationId};s.a.calculateCodFormula(e).then(function(e){if(e.data.success){var a=parseInt(e.data.data.formula);a>0&&(t.option=t.options.find(function(t){return t.value===a}),t.notify.success=!0,t.notify.message=e.data.message,t.showNotification(!0))}else t.notify.success=!1,t.notify.message=e.data.message,t.showNotification(!1)}).catch(function(t){console.log(t)})}},showNotification:function(t){var e="bg-success text-white";t||(e="bg-warning text-dark"),this.$notify({group:"default",title:this.notify.title,text:this.notify.message,type:e})}}},n=a("XyMi");var r=function(t){a("Vk8r")},l=Object(n.a)(o,function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"valid-formula-cod mb-4 w-100"},[a("multiselect",{attrs:{options:t.options,placeholder:t.placeholder,disabled:t.isDisabled,label:"name","track-by":"name",selectedLabel:"Đã chọn",deselectLabel:"Bỏ chọn",selectLabel:"Chọn"},scopedSlots:t._u([{key:"option",fn:function(e){return[a("div",{class:e.option.disabled?"disabled-option":"",on:{click:function(a){return t.clickFormula(e.option,a)}}},[t._v(t._s(e.option.name))])]}}]),model:{value:t.option,callback:function(e){t.option=e},expression:"option"}},[t._v(" "),a("span",{attrs:{slot:"noResult"},slot:"noResult"},[t._v("Rất tiếc. Không tìm thấy.")])])],1)},[],!1,r,"data-v-65cd65ac",null);e.a=l.exports},xqhi:function(t,e){}});