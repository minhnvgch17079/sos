webpackJsonp([67],{UqwX:function(t,e){},tjwQ:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=i("4WGu"),s=i("KvPw"),n=i.n(s),l=i("Bo22"),r=i.n(l),d=i("7+uW"),o=i("1Wvq"),c=i.n(o);d.default.filter("fileSize",function(t){if(!t)return"";var e=String(t).split(".");return e[0]+"."+e[1].slice(0,2)});var p={name:"ecom-deduction-upload",metaInfo:{title:"Deductions upload - Forms"},components:{vueDropzone:n.a,FileUpload:c.a,VueMonthlyPicker:r.a},data:function(){return{dropzoneOptions:{url:"/upload",maxFilesize:5e4,filesizeBase:1e3,addRemoveLinks:!0},timeUpdate:"",resultUploads:{},files:[],name:"file",accept:"application/vnd.ms-excel,application/vnd.openxmlformats-officedocument.spreadsheetml.sheet",extensions:"xls,xlsx",minSize:1024,size:10485760,multiple:!1,directory:!1,drop:!0,addIndex:!1,thread:3,detailRoot:["detail/","../partnership-payslip/detail/"],postAction:[a.a.baseApiUrl+"AdPayslip/uploadExcelPayslip",a.a.baseApiUrl+"AdPartnershipPayslip/uploadExcelPayslip"],success:!1,indexTypeEmp:0,typeOfEmployee:["Bảng lương nhân viên","Bảng lương hợp tác kinh doanh"]}},methods:{inputFilter:function(t,e,i){if(t&&!e){if(/(\/|^)(Thumbs\.db|desktop\.ini|\..+)$/.test(t.name))return i();if(/\.(php5?|html?|jsx?)$/i.test(t.name))return i()}if(t&&(!e||t.file!==e.file)){t.blob="";var a=window.URL||window.webkitURL;a&&a.createObjectURL&&(t.blob=a.createObjectURL(t.file))}},inputFile:function(t,e){t&&e&&(t.active&&!e.active&&t.size>=0&&this.minSize>0&&t.size<this.minSize&&this.$refs.upload.update(t,{error:"size"}),t&&e&&!t.active&&e.active&&(this.resultUploads=JSON.parse(t.response)))},changTypeEmpUpload:function(){0===this.indexTypeEmp?this.indexTypeEmp=1:this.indexTypeEmp=0,this.files=[],this.resultUploads={}},selectMonthUpdate:function(){this.files=[],this.resultUploads={}}}},v=i("XyMi");var u=function(t){i("UqwX")},h=Object(v.a)(p,function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"payslip-manager-page"},[i("div",{staticClass:"ui-block"},[i("h4",{staticClass:"text-center"},[i("div",{staticClass:"text-center"},[t._v("Upload thưởng phạt cho: "),i("b",{staticStyle:{color:"green"}},[t._v(t._s(t.typeOfEmployee[t.indexTypeEmp]))]),t._v(" "),i("b-btn",{attrs:{size:"sm",variant:"outline-danger btn-round icon-btn borderless"},on:{click:t.changTypeEmpUpload}},[i("i",{staticClass:"ion ion-md-refresh"})])],1)]),t._v(" "),i("div",[i("b-btn",{attrs:{variant:"success"}},[i("i",{staticClass:"ion ion-md-arrow-down",attrs:{"aria-hidden":"true"}}),t._v(" "),i("a",{attrs:{href:"/admin/files/deductions/Template_deduction.xlsx",target:"_blank"}},[t._v(" File mẫu")])]),t._v(" "),i("b-btn",{directives:[{name:"b-toggle",rawName:"v-b-toggle.collapse1",modifiers:{collapse1:!0}}],attrs:{variant:"danger"}},[t._v("Quy ước File upload")]),t._v(" "),i("b-collapse",{staticClass:"mt-2",attrs:{id:"collapse1"}},[i("b-card",[i("p",{staticClass:"card-text"},[t._v("\n                        - Cho phép upload file excel "),i("br"),t._v("\n                        - Bắt buộc có thông tin tên đăng nhập phải chính xác "),i("br"),t._v("\n                        - Khoản trừ ghi rõ dấu - phía trước "),i("br"),t._v("\n                        - Số tiền theo định dạng: 1000000 (không có . hoặc , hoặc khoảng trắng) "),i("br"),t._v("\n                        - Nhân viên có thể có nhiều khoản thưởng phạt. mỗi khoản sẽ tương ứng với một dòng dữ liệu "),i("br"),t._v("\n                        - Mỗi lần xử lý dữ liệu các khoản thưởng ,phạt... sẽ được thêm vào => tránh upload một file nhiều lần sẽ dẫn đến trùng lặp "),i("br"),t._v("\n                        - Các trường hợp lỗi nên chỉnh sửa và upload bằng file excel khác"),i("br")])])],1)],1),t._v(" "),i("div",{attrs:{id:"upload-deductions"}},[i("form",{attrs:{method:"post"}},[i("b-form-row",[i("file-upload",{ref:"upload",staticClass:"sr-only",attrs:{name:t.name,"post-action":t.postAction[t.indexTypeEmp],extensions:t.extensions,accept:t.accept,multiple:t.multiple,directory:t.directory,size:t.size||0,thread:t.thread<1?1:t.thread>5?5:t.thread,drop:t.drop,"add-index":t.addIndex,data:{time_update:t.timeUpdate}},on:{"input-filter":t.inputFilter,"input-file":t.inputFile},model:{value:t.files,callback:function(e){t.files=e},expression:"files"}}),t._v(" "),i("div",{staticClass:"table-responsive"},[i("table",{staticClass:"table"},[i("thead",[i("tr",[i("th",[t._v("#")]),t._v(" "),i("th",[t._v("File name")]),t._v(" "),i("th",[t._v("Size")]),t._v(" "),i("th",[t._v("Speed")]),t._v(" "),i("th",[t._v("Upload file")]),t._v(" "),i("th",[t._v("Action")])])]),t._v(" "),i("tbody",[t.files.length?t._e():i("tr",[i("td",{attrs:{colspan:"7"}},[i("div",{staticClass:"text-center p-5"},[i("h4",[t._v("Kéo thả file để upload\n                                            "),i("div",{staticClass:"text-muted small my-3"},[t._v("hoặc")])]),t._v(" "),i("label",{staticClass:"btn btn-primary btn-lg",attrs:{for:t.name}},[t._v("Chọn file")])])])]),t._v(" "),t._l(t.files,function(e,a){return i("tr",{key:e.id},[i("td",[t._v(t._s(a))]),t._v(" "),i("td",[i("div",{staticClass:"filename"},[t._v("\n                                        "+t._s(e.name)+"\n                                    ")]),t._v(" "),e.active||"0.00"!==e.progress?i("b-progress",{staticStyle:{margin:"4px 0 0 0"},attrs:{value:Number(e.progress),variant:e.error?"danger":"",animated:e.active,height:"6px"}}):t._e()],1),t._v(" "),i("td",[t._v(t._s(t._f("fileSize")(e.size/1024/1024))+" MB")]),t._v(" "),i("td",[t._v(t._s(e.speed))]),t._v(" "),e.error?i("td",[t._v(t._s(e.error))]):e.success?i("td",[t._v("success")]):e.active?i("td",[t._v("active")]):i("td"),t._v(" "),i("td",[i("b-dd",{attrs:{text:"Action",size:"sm",right:!t.isRTL}},[i("b-dd-item",{attrs:{disabled:!e.active},on:{click:function(i){e.active&&t.$refs.upload.update(e,{error:"cancel"})}}},[t._v("\n                                            Cancel\n                                        ")]),t._v(" "),e.active?i("b-dd-item",{on:{click:function(i){return t.$refs.upload.update(e,{active:!1})}}},[t._v("Abort\n                                        ")]):e.error&&t.$refs.upload.features.html5?i("b-dd-item",{on:{click:function(i){return t.$refs.upload.update(e,{active:!0,error:"",progress:"0.00"})}}},[t._v("\n                                            Retry upload\n                                        ")]):i("b-dd-item",{attrs:{disabled:e.success},on:{click:function(i){!e.success&&t.$refs.upload.update(e,{active:!0})}}},[t._v("\n                                            Upload\n                                        ")]),t._v(" "),i("b-dd-divider"),t._v(" "),i("b-dd-item",{on:{click:function(i){return t.$refs.upload.remove(e)}}},[t._v("Remove")])],1)],1)])})],2)])]),t._v(" "),i("b-dd",{attrs:{split:"",right:t.isRTL},on:{click:function(e){t.$refs.upload.$el.querySelector("input").click()}}},[i("template",{slot:"button-content"},[i("i",{staticClass:"ion ion-md-add"}),t._v(" Chọn file khác\n                        ")])],2),t._v(" "),i("vue-monthly-picker",{attrs:{placeHolder:"Thời gian áp dụng"},on:{selected:t.selectMonthUpdate},model:{value:t.timeUpdate,callback:function(e){t.timeUpdate=e},expression:"timeUpdate"}}),t._v(" "),t.$refs.upload&&t.$refs.upload.active?i("b-btn",{attrs:{variant:"danger"},on:{click:function(e){t.$refs.upload.active=!1}}},[i("i",{staticClass:"ion ion-md-close",attrs:{"aria-hidden":"true"}}),t._v(" Hủy\n                    ")]):i("b-btn",{attrs:{variant:"success"},on:{click:function(e){t.$refs.upload.active=!0}}},[i("i",{staticClass:"ion ion-md-arrow-up",attrs:{"aria-hidden":"true"}}),t._v(" Xử lý file\n                    ")])],1)],1)]),t._v(" "),i("h3",{staticClass:"text-center"},[t._v("Kết quả xử lý file upload")]),t._v(" "),i("div",{staticClass:"result-upload"},[i("table",{staticClass:"table table-result"},[t._m(0),t._v(" "),t._l(t.resultUploads,function(e,a){return i("tr",[i("td",[t._v(t._s(a+1))]),t._v(" "),i("td",[t._v(t._s(e.username))]),t._v(" "),i("td",[t._v(t._s(e.fullname))]),t._v(" "),"success"==e.status?i("td",{staticClass:"text-success"},[t._v(t._s(e.status))]):i("td",{staticClass:"text-danger"},[t._v("flase")]),t._v(" "),i("td",[e.message?i("span",[t._v(" "+t._s(e.message)+" ")]):e.id?i("a",{attrs:{href:t.detailRoot[t.indexTypeEmp]+e.id,target:"_blank"}},[t._v("Chi tiết")]):i("span",{staticClass:"text-danger"},[t._v(" Không tìm thấy NV ")])])])})],2)])])])},[function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("thead",{staticClass:"header-result"},[i("tr",[i("th",[t._v(" STT")]),t._v(" "),i("th",[t._v(" Tên đăng nhập")]),t._v(" "),i("th",[t._v(" Họ tên")]),t._v(" "),i("th",[t._v(" Cập nhật Thưởng/ phạt")]),t._v(" "),i("th",[t._v(" Thông tin chi tiết")])])])}],!1,u,"data-v-53cd9c48",null);e.default=h.exports}});