webpackJsonp([51],{M8Tp:function(t,e){},qc5g:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var s=a("4WGu"),i=a("KvPw"),r=a.n(i),n=a("7+uW"),o=a("1Wvq"),l=a.n(o),c=a("YmGg");n.default.filter("fileSize",function(t){if(!t)return"";var e=String(t).split(".");return e[0]+"."+e[1].slice(0,2)});var d={name:"upload-area-excel",metaInfo:{title:"Update Area"},components:{salaryService:c.a,vueDropzone:r.a,FileUpload:l.a},data:function(){return{dropzoneOptions:{url:"/upload",parallelUploads:2,maxFilesize:5e4,filesizeBase:1e3,addRemoveLinks:!0,dictDefaultMessage:"\nDrop files here or click to upload<br>\n    "},urlTemplate:s.a.baseApiUrl+"files/templates/template_upload_excel_update_area_pkgs.xlsx",packagesInProgress:0,countPackages:0,isPrepareUpload:!0,listErrorOrders:[],continueUpdate:!0,resultUploads:{},files:[],name:"file",accept:"application/vnd.ms-excel,application/vnd.openxmlformats-officedocument.spreadsheetml.sheet",extensions:"xls,xlsx",minSize:1024,size:10485760,multiple:!1,directory:!1,drop:!0,addIndex:!1,thread:3,postAction:s.a.baseApiUrl+"AdPackageSalary/uploadExcelUpdateArea",success:!1}},methods:{updateDataAreaPackages:function(){var t=this;this.isPrepareUpload=!0,c.a.updateDataAreaPackages().then(function(e){e.data.success?(t.packagesInProgress+=e.data.count,t.listErrorOrders=t.listErrorOrders.concat(e.data.error_data),t.packagesInProgress===t.countPackages&&(t.continueUpdate=!1),t.$notify({group:"notifications-default",type:"bg-success text-white",title:"Thành công",text:"Đã update vùng thành công cho "+t.packagesInProgress+" đơn hàng!"})):(t.continueUpdate=!1,t.listErrorOrders=t.listErrorOrders.concat(e.data.error_data),t.$notify({group:"notifications-default",type:"bg-danger text-white",title:"Lỗi",text:e.data.message}))}).catch(function(e){t.appLoading=!1,e&&t.$notify({group:"notifications-default",type:"bg-danger text-white",title:"Lỗi",text:"Có lỗi xảy ra. Vui lòng kiểm tra lại"})}).then(function(){if(!t.continueUpdate)return 0;t.updateDataAreaPackages()})},inputFilter:function(t,e,a){if(this.isPrepareUpload=!0,this.packagesInProgress=this.countPackages=0,this.listErrorOrders=[],t&&!e){if(/(\/|^)(Thumbs\.db|desktop\.ini|\..+)$/.test(t.name))return a();if(/\.(php5?|html?|jsx?)$/i.test(t.name))return a()}if(t&&(!e||t.file!==e.file)){t.blob="";var s=window.URL||window.webkitURL;s&&s.createObjectURL&&(t.blob=s.createObjectURL(t.file)),t.thumb="",t.blob&&"image/"===t.type.substr(0,6)&&(t.thumb=t.blob)}},inputFile:function(t,e){if(t&&e&&(t.active&&!e.active&&t.size>=0&&this.minSize>0&&t.size<this.minSize&&this.$refs.upload.update(t,{error:"size"}),t&&e&&!t.active&&e.active)){var a=JSON.parse(t.response);this.$notify({group:"notifications-default",type:a.success?"":"bg-danger text-white",title:a.success?"Thành công":"Lỗi",text:a.message}),!0===a.success&&(this.isPrepareUpload=!1,this.countPackages=a.count)}}}},p=a("XyMi");var u=function(t){a("M8Tp")},v=Object(p.a)(d,function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("h4",{staticClass:"font-weight-bold py-3 mb-4"},[t._v("\n    Upload vùng tính lương cho đơn hàng\n  ")]),t._v(" "),a("b-card",[a("a",{attrs:{href:t.urlTemplate}},[a("strong",[t._v(" "),a("u",[t._v("Download template")])])]),t._v(" "),a("file-upload",{ref:"upload",staticClass:"sr-only",attrs:{name:t.name,"post-action":t.postAction,extensions:t.extensions,accept:t.accept,multiple:t.multiple,directory:t.directory,size:t.size||0,thread:t.thread<1?1:t.thread>5?5:t.thread,drop:t.drop,"add-index":t.addIndex},on:{"input-filter":t.inputFilter,"input-file":t.inputFile},model:{value:t.files,callback:function(e){t.files=e},expression:"files"}}),t._v(" "),0!==t.packagesInProgress&&t.packagesInProgress===t.countPackages?a("img",{staticStyle:{position:"absolute","margin-left":"30%"},attrs:{src:"https://data.whicdn.com/images/187132170/original.gif",alt:"Italian Trulli"}}):t._e(),t._v(" "),a("div",{staticClass:"table-responsive"},[a("table",{staticClass:"table"},[a("thead",[a("tr",[a("th",[t._v("Tên")]),t._v(" "),a("th",[t._v("Kích thước")]),t._v(" "),a("th",[t._v("Tốc độ")]),t._v(" "),a("th",[t._v("Trạng thái")]),t._v(" "),a("th",[t._v("Hành động")])])]),t._v(" "),a("tbody",[t.files.length?t._e():a("tr",[a("td",{attrs:{colspan:"7"}},[a("div",{staticClass:"text-center p-5"},[a("h4",[t._v("Drop files anywhere to upload "),a("div",{staticClass:"text-muted small my-3"},[t._v("or")])]),t._v(" "),a("label",{staticClass:"btn btn-primary btn-lg",attrs:{for:t.name}},[t._v("Select Files")])])])]),t._v(" "),t._l(t.files,function(e){return a("tr",{key:e.id},[a("td",[a("div",{staticClass:"filename"},[t._v("\n              "+t._s(e.name)+"\n            ")]),t._v(" "),e.active||"0.00"!==e.progress?a("b-progress",{staticStyle:{margin:"4px 0 0 0"},attrs:{value:Number(e.progress),variant:e.error?"danger":"",animated:e.active,height:"6px"}}):t._e()],1),t._v(" "),a("td",[t._v(t._s(t._f("fileSize")(e.size/1024/1024))+" MB")]),t._v(" "),a("td",[t._v(t._s(e.speed))]),t._v(" "),e.error?a("td",[t._v(t._s(e.error))]):e.success?a("td",[t._v("success")]):e.active?a("td",[t._v("active")]):a("td"),t._v(" "),a("td",[a("b-dd",{attrs:{text:"Action",size:"sm",right:!t.isRTL}},[a("b-dd-item",{on:{click:function(a){return t.$refs.upload.remove(e)}}},[t._v("Remove")])],1)],1)])})],2)])]),t._v(" "),a("div",{staticClass:"form-row"},[a("div",[t.$refs.upload&&t.$refs.upload.active?a("b-btn",{attrs:{variant:"danger"},on:{click:function(e){t.$refs.upload.active=!1}}},[a("i",{staticClass:"ion ion-md-close",attrs:{"aria-hidden":"true"}}),t._v(" Stop Upload\n        ")]):a("b-btn",{attrs:{variant:"success"},on:{click:function(e){t.$refs.upload.active=!0}}},[a("i",{staticClass:"ion ion-md-arrow-up",attrs:{"aria-hidden":"true"}}),t._v(" Start Upload\n        ")]),t._v(" "),a("b-btn",{attrs:{variant:"outline-primary",disabled:t.isPrepareUpload},on:{click:t.updateDataAreaPackages}},[a("i",{staticClass:"ion ion-md-sync",attrs:{"aria-hidden":"true"}}),t._v(" Update Data\n        ")])],1),t._v(" "),0!==t.packagesInProgress?a("div",{staticClass:"col-md-8"},[a("div",[a("b-progress",{staticStyle:{margin:"1.5% 0 0 2%"},attrs:{variant:"success",value:t.packagesInProgress,max:t.countPackages,label:1e5,height:"0.5rem",animated:""}})],1),t._v(" "),a("div",{staticStyle:{"text-align":"center","font-size":"12px"}},[a("p",[a("span",{staticStyle:{color:"blue"}},[t._v(t._s(t.packagesInProgress))]),t._v("/"),a("b",[t._v(t._s(t.countPackages)+" packages")])])])]):t._e()])],1),t._v(" "),0!==t.listErrorOrders.length?a("b-card",[a("strong",[t._v("Danh sách đơn hàng "),a("span",{staticStyle:{color:"red"}},[a("u",[t._v("không tồn tại")])]),t._v(" hoặc "),a("span",{staticStyle:{color:"red"}},[a("u",[t._v("không lưu được")])]),t._v(":")]),t._v(" "),a("div",{staticStyle:{"font-family":"Verdana","margin-left":"2%"}},t._l(t.listErrorOrders,function(e,s){return a("div",[a("b",[t._v(t._s(s+1)+".")]),t._v(" "),a("i",[t._v(t._s(e))])])}),0)]):t._e(),t._v(" "),a("notifications",{attrs:{group:"notifications-default"}})],1)},[],!1,u,null,null);e.default=v.exports}});