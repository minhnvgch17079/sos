webpackJsonp([1],{OkiZ:function(t,e){},cz9i:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var s=a("RUzx"),i=a.n(s),r=a("qaB4"),n=a("7+uW"),o=a("sUu7"),l=a("+cgA"),d=a("iR9c"),c=a("csCE"),u=a("YlZe"),m=a("moEt");n.default.use(o.a);var p={name:"update-user-company",components:{LaddaBtn:r.a,Notification:Notification,Multiselect:i.a,MultiSelectUser:l.a,SingleSelectDepartment:c.a,SingleSelectPosition:u.a,SingleSelectCompanyProfile:m.a},data:function(){return{isProcessingUpdate:!1,leaders:null,employees:null,userdata:{id:null,company_id:null,department_name:"Vận hành xe tải",department_id:11,position_job:"99",created:"",created_by:"",modified_by:"",password:"",password_confirm:"",username:"",fullname:"",contact_tel:""},masterInfo:{id:""},toogleLog:!1,canCustomUserName:!1}},created:function(){if(this.isAdd)this.$route.params.id&&(this.masterInfo.id=this.$route.params.id,this.getCompanyProfile());else{if(!this.$route.params.id)return;this.$route.params.id&&this.getUserCompany()}},computed:{isAdd:function(){return"add-user-company"===this.$route.name},isEdit:function(){return"edit-user-company"===this.$route.name}},watch:{},methods:{validateForm:function(){return!(this.whStaffPositions.includes(parseInt(this.userdata.position_job))&&(!this.userdata.default_work||0===this.userdata.default_work.length))||(this.notify.success=!1,this.notify.message="Vui lòng chọn công việc mặc định",this.showNotification(!1),!1)},addUser:function(){var t=this,e={company_id:this.masterInfo.id,username:this.userdata.username,department_id:this.userdata.department_id,position_job:this.userdata.position_job,password:this.userdata.password,password_confirm:this.userdata.password_confirm};d.a.addUser(e).then(function(e){if(e.data.hasOwnProperty("success"))if(e.data.success){var a=e.data.data.user_id;t.$notify({group:"default",type:"text-white bg-primary",text:e.data.message}),t.$router.push({name:"edit-user-company",params:{id:a}})}else t.$notify({group:"default",type:"text-white bg-warning",title:"Xảy ra lỗi",text:e.data.message}),t.showNotification(!1);else t.notify.success=!1}).catch(function(e){t.notify.success=!1,t.notify.message="Có lỗi xảy ra, liên hệ IT để được hỗ trợ",t.showNotification(!1)}).then(function(){t.isProcessingUpdate=!1})},handleSelectedDepartment:function(t){this.userdata.department_id=t?t.id:"",this.userdata.department=t?t.name:""},handleSelectedPosition:function(t){this.userdata.position_job=t?t.id:""},handleChooseProfileCompany:function(t){this.masterInfo.id=t?t.id:"",this.getCompanyProfile(t.id)},getCompanyProfile:function(){var t=this,e={master_id:this.masterInfo.id};d.a.getCompanyProfile(e).then(function(e){e.data.success&&(t.masterInfo=e.data.data.detail)})},getUserCompany:function(){var t=this;this.$startLoading();var e={user_id:this.$route.params.id};d.a.getUserCompany(e).then(function(e){if(e.data.hasOwnProperty("success"))if(e.data.success){var a=e.data.data[0];t.masterInfo=a.OrganizationProfile,t.userdata.username=a.ErpUser.username,t.userdata.id=a.ErpUser.id}else t.notify.success=!1,t.notify.message=e.data.message,t.showNotification(!1);else t.notify.message="Có lỗi xảy ra, không load được thông tin tài khoản",t.showNotification(!1)}).catch(function(t){console.log(t)}).then(function(){t.$stopLoading()})}}},h=a("XyMi");var f=function(t){a("LZVb"),a("6aA6"),a("OkiZ")},v=Object(h.a)(p,function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"update-user"},[a("div",{staticClass:"row header"},[a("div",{staticClass:"col-md-8"},[t.isAdd?a("h2",[t._v("Thêm tài khoản")]):a("h2",[t._v("Sửa thông tin tài khoản")])]),t._v(" "),a("div",{staticClass:"col-md-4"},[a("b-row",[a("b-col",{staticClass:"text-right",attrs:{md:"12"}},[a("router-link",{staticClass:"btn btn-outline-success ml-1",attrs:{to:{name:"manager-master-company-profile"}}},[a("i",{staticClass:"ion ion-ios-arrow-back"}),t._v(" Quản lý Profile Công ty")])],1)],1)],1)]),t._v(" "),a("div",{staticClass:"row"},[a("div",{staticClass:"col-md-12 create-user"},[a("div",{staticClass:"card mb-4"},[a("div",{staticClass:"row no-gutters row-bordered"},[a("div",{staticClass:"col-md-4 find-master-profile"},[a("div",{staticClass:"col-md-12 col-lg-12 col-xl-12"},[t._m(0),t._v(" "),a("div",{staticClass:"card-body"},[t.isAdd?a("b-form-group",{staticClass:"w-100",attrs:{label:"Tìm kiếm Profile"}},[a("b-input-group",[a("single-select-company-profile",{attrs:{"show-info":!0,"master-id":t.masterInfo.id},on:{handleChooseProfileCompany:t.handleChooseProfileCompany},model:{value:t.masterInfo.id,callback:function(e){t.$set(t.masterInfo,"id",e)},expression:"masterInfo.id"}})],1)],1):t._e(),t._v(" "),a("div",{staticClass:"row"},[a("div",{staticClass:"col-6 col-xl-5 text-muted mb-3"},[t._v("Loại công ty")]),t._v(" "),a("div",{staticClass:"col-6 col-xl-7 mb-3"},[a("span",{staticClass:"text-big"},[t._v(t._s(t.masterInfo.organization_type))])]),t._v(" "),a("div",{staticClass:"col-6 col-xl-5 text-muted mb-3"},[t._v("Tên công ty")]),t._v(" "),a("div",{staticClass:"col-6 col-xl-7 mb-3"},[a("span",{staticClass:"text-big"},[t._v(t._s(t.masterInfo.fullname))])]),t._v(" "),a("div",{staticClass:"col-6 col-xl-5 text-muted mb-3"},[t._v("Mã số thuế")]),t._v(" "),a("div",{staticClass:"col-6 col-xl-7 mb-3"},[a("span",{staticClass:"text-big"},[t._v(t._s(t.masterInfo.tax_iden_number))])]),t._v(" "),a("div",{staticClass:"col-6 col-xl-5 text-muted mb-3"},[t._v("Điện thoại liên hệ")]),t._v(" "),a("div",{staticClass:"col-6 col-xl-7 mb-3"},[a("span",{staticClass:"text-big"},[t._v(t._s(t.masterInfo.contact_tel))])]),t._v(" "),a("div",{staticClass:"col-6 col-xl-5 text-muted mb-3"},[t._v("Email liên hệ")]),t._v(" "),a("div",{staticClass:"col-6 col-xl-7 mb-3"},[a("span",{staticClass:"text-big"},[t._v(t._s(t.masterInfo.contact_email))])])]),t._v(" "),a("div",[a("router-link",{attrs:{to:{name:"edit-master-profile-company",params:{id:t.masterInfo.id}}}},[t._v("Chi tiết profile công ty"),a("i",{staticClass:"ion ion-ios-arrow-dropright"})])],1)],1)])]),t._v(" "),a("div",{staticClass:"col-md-8 input-user-info"},[a("div",{staticClass:"row no-gutters"},[a("div",{staticClass:"col-md-12 col-lg-12 col-xl-12"},[t._m(1),t._v(" "),a("div",{staticClass:"card-body"},[a("b-form-row",[a("b-form-group",{staticClass:"col-md-4",attrs:{label:"Chọn bộ phận"}},[a("single-select-department",{attrs:{"department-id":t.userdata.department_id,"is-disabled":!0},on:{handleSelectedDepartment:t.handleSelectedDepartment}}),t._v(" "),a("input",{directives:[{name:"validate",rawName:"v-validate",value:"required",expression:"'required'"},{name:"model",rawName:"v-model",value:t.userdata.department_id,expression:"userdata.department_id"}],attrs:{type:"hidden",name:"input-department"},domProps:{value:t.userdata.department_id},on:{input:function(e){e.target.composing||t.$set(t.userdata,"department_id",e.target.value)}}}),t._v(" "),a("span",{directives:[{name:"show",rawName:"v-show",value:"required"==t.errors.firstRule("input-department"),expression:"errors.firstRule('input-department') == 'required'"}],staticClass:"help is-danger"},[t._v("Không để trống trường này ")])],1),t._v(" "),a("b-form-group",{staticClass:"col-md-4",attrs:{label:"Chọn vị trí"}},[a("single-select-position",{attrs:{"department-id":t.userdata.department_id,"position-job":t.userdata.position_job,"is-disabled":!0},on:{handleSelectedPosition:t.handleSelectedPosition}}),t._v(" "),a("input",{directives:[{name:"validate",rawName:"v-validate",value:"required",expression:"'required'"},{name:"model",rawName:"v-model",value:t.userdata.position_job,expression:"userdata.position_job"}],attrs:{type:"hidden",name:"input-position"},domProps:{value:t.userdata.position_job},on:{input:function(e){e.target.composing||t.$set(t.userdata,"position_job",e.target.value)}}}),t._v(" "),a("span",{directives:[{name:"show",rawName:"v-show",value:"required"==t.errors.firstRule("input-position"),expression:"errors.firstRule('input-position') == 'required'"}],staticClass:"help is-danger"},[t._v("Không để trống trường này ")])],1)],1),t._v(" "),a("b-form-row",[a("b-form-group",{staticClass:"col-md-4"},[a("template",{slot:"label"},[t._v("\n                                                Tên tài khoản\n                                            ")]),t._v(" "),a("b-form-input",{directives:[{name:"validate",rawName:"v-validate",value:"required",expression:"'required'"}],class:{"is-danger":t.errors.has("username")},attrs:{id:"username",name:"username",placeholder:"Nhập username (nên có tên công ty phía trước)",disabled:!t.isAdd},model:{value:t.userdata.username,callback:function(e){t.$set(t.userdata,"username",e)},expression:"userdata.username"}}),t._v(" "),a("span",{directives:[{name:"show",rawName:"v-show",value:"required"==t.errors.firstRule("username"),expression:"errors.firstRule('username') == 'required'"}],staticClass:"help is-danger"},[t._v("Không để trống trường này ")])],2)],1),t._v(" "),t.isAdd?a("b-form-row",[a("b-form-group",{staticClass:"col-md-4"},[a("template",{slot:"label"},[t._v("\n                                                Nhập mật khẩu\n                                            ")]),t._v(" "),a("b-form-input",{directives:[{name:"validate",rawName:"v-validate",value:"required",expression:"'required'"}],class:{"is-danger":t.errors.has("password")},attrs:{id:"password",name:"password",type:"password",placeholder:"Nhập password"},model:{value:t.userdata.password,callback:function(e){t.$set(t.userdata,"password",e)},expression:"userdata.password"}}),t._v(" "),a("span",{directives:[{name:"show",rawName:"v-show",value:"required"==t.errors.firstRule("username"),expression:"errors.firstRule('username') == 'required'"}],staticClass:"help is-danger"},[t._v("Không để trống trường này ")])],2),t._v(" "),a("b-form-group",{staticClass:"col-md-4"},[a("template",{slot:"label"},[t._v("\n                                                Nhập lại mật khẩu\n                                            ")]),t._v(" "),a("b-form-input",{directives:[{name:"validate",rawName:"v-validate",value:"required",expression:"'required'"}],class:{"is-danger":t.errors.has("password_confirm")},attrs:{id:"password_confirm",name:"password_confirm",type:"password",placeholder:"Nhập lại password"},model:{value:t.userdata.password_confirm,callback:function(e){t.$set(t.userdata,"password_confirm",e)},expression:"userdata.password_confirm"}}),t._v(" "),a("span",{directives:[{name:"show",rawName:"v-show",value:"required"==t.errors.firstRule("password_confirm"),expression:"errors.firstRule('password_confirm') == 'required'"}],staticClass:"help is-danger"},[t._v("Không để trống trường này ")])],2)],1):t._e()],1),t._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:!t.$route.params.id,expression:"!$route.params.id"}],staticClass:"card-body"},[a("div",{staticClass:"alert alert-danger",staticStyle:{"text-align":"center"},attrs:{role:"alert","aria-live":"polite","aria-atomic":"true"}},[t._v("Vui lòng chọn profile trước khi thêm tài khoản ! nếu chưa có vui lòng tạo Profile")])])])])])])])])]),t._v(" "),a("div",{staticClass:"card-footer border-0 text-center py-3"},[t.isAdd?a("ladda-btn",{staticClass:"btn btn-primary",attrs:{loading:t.isProcessingUpdate,"data-style":"expand-right"},nativeOn:{click:function(e){return t.addUser()}}},[a("i",{staticClass:"ion ion-ios-add"}),t._v(" Thêm tài khoản\n        ")]):a("ladda-btn",{staticClass:"btn btn-info",attrs:{loading:t.isProcessingUpdate,"data-style":"expand-right"}},[a("i",{staticClass:"icon ion-md-archive"}),t._v(" Cập nhật tài khoản\n        ")])],1),t._v(" "),a("notifications",{attrs:{group:"add-user-company"}})],1)},[function(){var t=this.$createElement,e=this._self._c||t;return e("h6",{staticClass:"card-header"},[e("i",{staticClass:"ion  ion-ios-add-circle"}),this._v(" Thông tin profile công ty")])},function(){var t=this.$createElement,e=this._self._c||t;return e("h6",{staticClass:"card-header"},[e("i",{staticClass:"ion  ion-ios-add-circle"}),this._v(" Thông tin tài khoản")])}],!1,f,null,null);e.default=v.exports},moEt:function(t,e,a){"use strict";var s=a("iR9c"),i=a("RUzx"),r={name:"singe-select-company-profile",props:{masterId:{default:""},showInfo:{type:Boolean,default:!1}},components:{Multiselect:a.n(i).a},data:function(){return{profileOption:null,profileOptions:[],saveAllProfileOption:[],masterInfo:[]}},created:function(){this.getCompanyProfileList()},watch:{profileOption:function(t,e){this.$emit("handleChooseProfileCompany",t)}},methods:{getCompanyProfileList:function(){var t=this;this.$startLoading(),s.a.getCompanyProfileList().then(function(e){e.data.success&&(t.profileOptions=e.data.data.data,t.saveAllProfileOption=e.data.data.data,t.profileOption=t.masterId?t.profileOptions.find(function(e){return e.id===t.masterId}):null)}).catch(function(t){console.log("where error: handleChooseObjectType")}).then(function(){t.$stopLoading()})},search:function(t){var e=this.saveAllProfileOption.filter(function(e){return-1!==(e.fullname.toLowerCase()+e.tax_iden_number.toLowerCase()).search(t)});e.length>0&&(this.profileOptions=e)},customLabel:function(t){return""+t.fullname}}},n=a("XyMi"),o=Object(n.a)(r,function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"w-100"},[a("multiselect",{attrs:{options:t.profileOptions,placeholder:"Tìm kiếm theo tên","track-by":"id",selectedLabel:"Đã chọn",deselectLabel:"Bỏ chọn",selectLabel:"Chọn","custom-label":t.customLabel,"allow-empty":!1,searchable:!0,"internal-search":!1,"show-no-results":!1},on:{"search-change":t.search},model:{value:t.profileOption,callback:function(e){t.profileOption=e},expression:"profileOption"}},[a("span",{attrs:{slot:"noResult"},slot:"noResult"},[t._v("Rất tiếc. Không tìm thấy.")])])],1)},[],!1,null,null,null);e.a=o.exports}});