webpackJsonp([52],{dMGj:function(t,a,e){"use strict";Object.defineProperty(a,"__esModule",{value:!0});var i=e("fZjL"),s=e.n(i),n=e("4WGu"),o=e("YmGg"),r=e("QKlT"),l=e.n(r),c=e("qaB4"),d={name:"ara-packages",metaInfo:{title:"Area Packages"},components:{salaryService:o.a,flatPickr:l.a,LaddaBtn:c.a},data:function(){return{totalCountDate:0,countDate:0,infoCod:{},codAlias:"",range_time:"",loadingButton:!1,loadingExport:!1,rangeConfig:{mode:"range",altInput:!0,dateFormat:"Y-m-d",altFormat:"Y-m-d"},dataUrl:n.a.baseApiUrl+"AdSalaryCods/getAllPackagesOfCodInRangeTime",searchKeys:["alias","type","street","ward","prioritize","date","order","customer_province","district","cart_alias"],sortBy:"date",sortDesc:!1,perPage:10,fields:[{key:"date",label:"Ngày tháng",sortable:!0,thStyle:"width: 12%"},{key:"order",sortable:!0,thStyle:"width: 4%"},{key:"type",label:"Loại",sortable:!0,thStyle:"width: 4%"},{key:"first_address",label:"Địa chỉ lấy",sortable:!0},{key:"cart_alias",label:"Mã giỏ",sortable:!0},{key:"street",label:"Đường/Phố",sortable:!0},{key:"ward",label:"Phường/Xã",sortable:!0},{key:"district",label:"Quận/Huyện",sortable:!0},{key:"customer_province",label:"Tỉnh/Thành Phố",sortable:!0},{key:"area_package",label:"Đơn",sortable:!0,thStyle:"width: 4%"},{key:"area_cart",label:"Giỏ",sortable:!0,thStyle:"width: 4%"},{key:"area_street",label:"Đường",sortable:!0,thStyle:"width: 4%"},{key:"area_ward",label:"Phường/Xã",sortable:!0,thStyle:"width: 4%"},{key:"prioritize",label:"Tính theo",sortable:!0,thStyle:"width: 4%"}],articlesData:[],originalArticlesData:[],currentPage:1}},computed:{aliasState:function(){return!(!/(T|t)([0-9]+)/.test(this.codAlias)&&""!==this.codAlias)},totalItems:function(){return this.articlesData.length},totalPages:function(){return Math.ceil(this.totalItems/this.perPage)}},methods:{exportExcel:function(){var t=this;0!==this.articlesData.length&&(this.loadingExport=!0,o.a.exportDataPackagesArea({codAlias:this.infoCod.cod_alias,data:this.articlesData}).then(function(a){a.data.hasOwnProperty("success")&&(t.$notify({group:"notifications-default",type:a.data.success?"":"bg-danger text-white",title:a.data.success?"Thành công":"Lỗi",text:a.data.message}),a.data.hasOwnProperty("path")&&(window.location.href=a.data.path))}).catch(function(){t.$notify({group:"notifications-default",type:"bg-danger text-white",title:"Lỗi",text:"Đã có lỗi xảy ra."})}).then(function(){t.loadingExport=!1}))},runProcess:function(){var t=this;if(this.articlesData=this.originalArticlesData=[],this.countDate=this.totalCountDate=0,this.infoCod={},""===this.codAlias||""===this.range_time)return!1;var a=this.range_time.split(" to ");if(void 0===a[0]||void 0===a[1]||a[0]===a[1])return this.$notify({group:"notifications-default",type:"bg-danger text-white",title:"Lỗi",text:"Khoảng thời gian không hợp lệ!"}),0;this.loadingButton=!0,o.a.getInfoCod({alias:this.codAlias}).then(function(a){if(a.data.hasOwnProperty("success")){if(t.$notify({group:"notifications-default",type:a.data.success?"":"bg-danger text-white",title:a.data.success?"Thành công":"Lỗi",text:a.data.message}),!a.data.success)return 0;t.infoCod=a.data.data}}).catch(function(){t.$notify({group:"notifications-default",type:"bg-danger text-white",title:"Lỗi",text:"Đã có lỗi xảy ra."})}).then(function(){if(void 0===t.infoCod.cod_id)return t.loadingButton=!1,0;var a=t.range_time.split(" to "),e=new Date(a[0]).getTime(),i=new Date(a[1]).getTime();t.totalCountDate=i+864e5-e,t.getDataDateByDate(t.infoCod.cod_id,e,i)})},getDataDateByDate:function(t,a,e){var i=this,s={codId:t,from:a,to:a+864e5};o.a.getAllPackagesOfCodInRangeTime(s).then(function(t){if(i.countDate+=864e5,t.data.hasOwnProperty("success")&&(i.$notify({group:"notifications-default",type:t.data.success?"":"bg-danger text-white",title:t.data.success?"Thành công":"Lỗi",text:t.data.message+" cho ngày "+new Date(a).toLocaleDateString()}),t.data.success&&t.data.hasOwnProperty("data"))){var e=t.data.data;i.articlesData=i.articlesData.concat(e),i.originalArticlesData=i.articlesData.slice(0)}}).catch(function(){return i.$notify({group:"notifications-default",type:"bg-danger text-white",title:"Lỗi",text:"Đã có lỗi xảy ra khi lấy dữ liệu ngày "+new Date(a).toLocaleDateString()}),i.loadingButton=!1,0}).then(function(){if(a+864e5>e)return i.loadingButton=!1,0;i.getDataDateByDate(t,a+864e5,e)})},filter:function(t){var a=this,e=t.toLowerCase(),i=this.originalArticlesData.filter(function(t){return console.log(),-1!==s()(t).filter(function(t){return a.searchKeys.includes(t)}).map(function(a){return String(t[a])}).join("|").toLowerCase().indexOf(e)||!e});this.articlesData=i}},mounted:function(){},created:function(){}},g=e("XyMi");var u=function(t){e("OEkN"),e("kZhe")},h=Object(g.a)(d,function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",[t._m(0),t._v(" "),e("b-card",{staticStyle:{"background-image":"-webkit-linear-gradient(right, #FAFAFA, #FAFAFA 50%, transparent 10%, transparent 100%)"},attrs:{"no-body":""}},[e("b-card-body",[e("div",{staticClass:"row"},[e("div",{staticClass:"col-md-4"},[e("div",[e("label",{staticClass:"form-label"},[t._v("Mã COD")]),t._v(" "),e("b-form-input",{attrs:{id:"inputLive",disabled:t.loadingExport,type:"text",state:t.aliasState,"aria-describedby":"inputLiveFeedback",placeholder:"Nhập mã COD"},model:{value:t.codAlias,callback:function(a){t.codAlias="string"==typeof a?a.trim():a},expression:"codAlias"}}),t._v(" "),e("b-form-invalid-feedback",{attrs:{id:"inputLiveFeedback"}},[t._v("\n              Vui lòng kiểm tra lại mã Cod\n            ")])],1),t._v(" "),e("br"),t._v(" "),e("div",[e("b-form-group",{attrs:{label:"Khoảng thời gian"}},[e("flat-pickr",{attrs:{config:t.rangeConfig,placeholder:"Chọn khoảng thời gian"},model:{value:t.range_time,callback:function(a){t.range_time=a},expression:"range_time"}}),t._v(" "),""!==t.range_time?e("p",{staticStyle:{"font-size":"13px","line-height":"30px"}},[e("strong",[e("i",[t._v(" (*) ứng với dữ liệu từ "),e("span",{staticStyle:{color:"red"}},[t._v(t._s(t.range_time.split(" to ")[0]))]),t._v(" đến "),e("span",{staticStyle:{color:"red"}},[t._v(t._s(t.range_time.split(" to ")[1]))])])])]):t._e()],1)],1),t._v(" "),e("div",[e("ladda-btn",{staticClass:"btn btn-primary",staticStyle:{width:"40%"},attrs:{disabled:t.loadingExport,loading:t.loadingButton,"data-style":"expand-right"},nativeOn:{click:function(a){return t.runProcess(a)}}},[t._v("\n              Show\n            ")]),t._v(" "),e("ladda-btn",{staticClass:"btn btn-success",staticStyle:{width:"40%"},attrs:{disabled:t.loadingButton||0===t.articlesData.length,loading:t.loadingExport,"data-style":"expand-right"},nativeOn:{click:function(a){return t.exportExcel(a)}}},[t._v("\n              Xuất excel\n            ")])],1),t._v(" "),e("div"),t._v(" "),e("div")]),t._v(" "),void 0!==t.infoCod.cod_id?e("div",{staticClass:"col-md-8",staticStyle:{float:"right"}},[e("div",{staticClass:"media col-md-10 col-lg-8 col-xl-7 py-5 mx-auto",staticStyle:{float:"right"}},[e("img",{staticClass:"d-block ui-w-100 rounded",attrs:{src:t.baseUrl+"/static/img/noimage.png",alt:"",width:"300",height:"300"}}),t._v(" "),e("div",{staticClass:"media-body ml-5"},[e("h4",{staticClass:"font-weight-bold mb-4"},[t._v(t._s(t.infoCod.fullname)+" - "+t._s(t.infoCod.user_id))]),t._v(" "),e("div",{staticClass:"text-muted mb-4"},[e("p",[e("strong",[t._v("Kho: ")]),t._v(t._s(t.infoCod.station_name)+" - "+t._s(t.infoCod.station_id))]),t._v(" "),e("p",[e("strong",[t._v("Vị trí: ")]),t._v(t._s(t.infoCod.position_name)+" - "+t._s(t.infoCod.position_id))])])])])]):e("div",{staticClass:"col-md-7",staticStyle:{float:"right"}},[e("div",{staticClass:"media col-md-10 col-lg-8 col-xl-7 py-5 mx-auto",staticStyle:{float:"right"}},[e("img",{staticClass:"d-block ui-w-100 rounded",attrs:{src:t.baseUrl+"/static/img/noimage.png",alt:"",width:"300",height:"300"}}),t._v(" "),e("div",{staticClass:"media-body ml-5"},[e("h4",{staticClass:"font-weight-bold mb-4"},[t._v(".........")]),t._v(" "),e("div",{staticClass:"text-muted mb-4"},[e("p",[e("strong",[t._v("Kho: ")]),t._v(".........")]),t._v(" "),e("p",[e("strong",[t._v("Vị trí: ")]),t._v(".........")])])])])])])])],1),t._v(" "),e("br"),t._v(" "),e("b-card",{attrs:{"no-body":""}},[e("b-card-body",[e("div",{staticClass:"row pr-bar"},[e("div",{staticClass:"col"},[t._v("\n          Số lượng:  \n          "),e("b-select",{staticClass:"d-inline-block w-auto",attrs:{size:"sm",options:[10,20,30,40,50]},model:{value:t.perPage,callback:function(a){t.perPage=a},expression:"perPage"}}),t._v("\n          trên "+t._s(t.articlesData.length)+" đơn hàng\n        ")],1),t._v(" "),e("div",{staticClass:"col"},[e("b-progress",{staticClass:"mt-8",attrs:{max:t.totalCountDate}},[e("b-progress-bar",{attrs:{value:t.countDate,precision:2,"show-progress":""}})],1)],1),t._v(" "),e("div",{staticClass:"col"},[e("b-input",{staticClass:"d-inline-block float-lg-right w-50",attrs:{size:"sm",placeholder:"Tìm kiếm..."},on:{input:function(a){return t.filter(a)}}})],1)])]),t._v(" "),e("hr",{staticClass:"border-light m-0"}),t._v(" "),e("div",{staticClass:"table-responsive"},[e("table",{staticClass:"w-100"},[e("tr",[e("th",{staticClass:"w-25"},[t._v("Đơn hàng")]),t._v(" "),e("th",{staticClass:"w-45"},[t._v("Thông tin địa chỉ")]),t._v(" "),e("th",{staticClass:"w-35"},[t._v("Vùng tính lương")])]),t._v(" "),e("tr",[e("td",{attrs:{colspan:"3"}},[e("b-table",{ref:"dataTable",staticClass:"card-table",staticStyle:{"text-align":"center"},attrs:{id:"dataTable",items:t.articlesData,fields:t.fields,"sort-by":t.sortBy,"sort-desc":t.sortDesc,striped:!0,bordered:!0,"current-page":t.currentPage,"per-page":t.perPage},on:{"update:sortBy":function(a){t.sortBy=a},"update:sort-by":function(a){t.sortBy=a},"update:sortDesc":function(a){t.sortDesc=a},"update:sort-desc":function(a){t.sortDesc=a}}})],1)])])]),t._v(" "),e("b-card-body",{staticClass:"pt-0 pb-3"},[e("div",{staticClass:"row"},[e("div",{staticClass:"col-sm text-sm-left text-center pt-3"},[t.totalItems?e("span",{staticClass:"text-muted"},[t._v("Trang "+t._s(t.currentPage)+" trên "+t._s(t.totalPages))]):t._e()]),t._v(" "),e("div",{staticClass:"col-sm pt-3"},[t.totalItems?e("b-pagination",{staticClass:"justify-content-center justify-content-sm-end m-0",attrs:{"total-rows":t.totalItems,"per-page":t.perPage,size:"sm"},model:{value:t.currentPage,callback:function(a){t.currentPage=a},expression:"currentPage"}}):t._e()],1)])])],1),t._v(" "),e("notifications",{attrs:{group:"notifications-default"}})],1)},[function(){var t=this.$createElement,a=this._self._c||t;return a("h4",{staticClass:"d-flex justify-content-between align-items-center w-100 font-weight-bold py-3 mb-4"},[a("div",[this._v("Bảng hiển thị vùng của đơn hàng")])])}],!1,u,"data-v-c8346474",null);a.default=h.exports},kZhe:function(t,a){}});