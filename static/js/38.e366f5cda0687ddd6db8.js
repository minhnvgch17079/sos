webpackJsonp([38],{"Rg+5":function(t,e){},"Yd6+":function(t,e){},fVJ4:function(t,e,s){"use strict";var a=s("4WGu"),n=s("mtWM"),o=s.n(n),i=s("RUzx"),c={name:"select-rc-type",props:{placeholder:{type:String,default:"Chọn gói cam kết hoàn"}},components:{Multiselect:s.n(i).a},data:function(){return{rcTypes:[],selectedRCType:""}},methods:{getOptions:function(){var t=this;o.a.get(a.a.baseApiUrl+"shops/getReturnCouponType").then(function(e){e.data.success&&(t.rcTypes=e.data.data.options.rcTypes)}).catch(function(t){})},onSelect:function(t){this.selectedRCType=t.code,this.$emit("selected",this.selectedRCType)},onRemove:function(){this.$emit("selected","")},reset:function(){this.selectedRCType="",this.$emit("selected",this.selectedRCType.code)}},created:function(){this.getOptions()}},l=s("XyMi");var r=function(t){s("Rg+5")},d=Object(l.a)(c,function(){var t=this,e=t.$createElement;return(t._self._c||e)("multiselect",{attrs:{options:t.rcTypes,multiple:!1,placeholder:t.placeholder,"track-by":"name",label:"name",selectLabel:"",selectedLabel:"",deselectLabel:"x"},on:{select:t.onSelect,remove:t.onRemove},model:{value:t.selectedRCType,callback:function(e){t.selectedRCType=e},expression:"selectedRCType"}})},[],!1,r,"data-v-0ecd1fee",null);e.a=d.exports},pyM1:function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=s("PJh5"),n=s.n(a),o=s("IC97"),i=s("w6Ui"),c=s("GyeY"),l=s("fVJ4"),r=s("qaB4"),d=s("kNeQ"),p=s("KVzY"),u=s("7+uW"),h=s("4WGu"),_=s("mtWM"),v=s.n(_);u.default.use(p.default);var b={components:{SidenavRouterLink:i.g,SelectCtmCare:c.a,SelectRcType:l.a,LaddaBtn:r.a,Datepicker:o.a},data:function(){return{selected:{ctmCare:[],rcType:[]},monthDeduction:n()().subtract(1,"month").format("YYYY-MM"),shops:{shop_code:""},pageData:{currentPage:1,totalPages:0,totalItems:0,perPage:50,sortBy:"id",sortDesc:!1},checkResult:!1,listShops:[],loadingExcel:!1,loadingExcelHtml:'\n      <div class="sk-folding-cube sk-primary">\n        <div class="sk-cube1 sk-cube"></div>\n        <div class="sk-cube2 sk-cube"></div>\n        <div class="sk-cube4 sk-cube"></div>\n        <div class="sk-cube3 sk-cube"></div>\n      </div>\n      <h5 class="text-center mb-0">LOADING...</h5>\n    ',rcTypeInfo:"",btnDisableZip:!0,canViewAll:!1}},methods:{showImportModal:function(){this.$refs.rcTypeInfoModal.show()},hideImportModal:function(){this.$refs.rcTypeInfoModal.hide()},getRcTypeInfo:function(){var t=this;v.a.get(h.a.baseApiUrl+"shops/getRcTypeInfo").then(function(e){e.data.success&&(t.rcTypeInfo=e.data.data)}).catch(function(t){})},slug:function(t){return"/admin/shops/downloadRcPkg/"+t},downloadRcFileZip:function(){var t=this,e={month_return_coupon:t.customFormatterMonth(this.monthDeduction)};t.loadingExcel=!0,d.a.downloadRcFileZip(e).then(function(t){if(t.data.success)window.location.href=t.data.data;else{var e=t.data.msg?t.data.msg:"Có lỗi xảy ra. Hãy thử lại nhé!";alert(e)}}).catch(function(t){t&&alert("Có lỗi xảy ra. Hãy thử lại nhé!")}).then(function(){t.loadingExcel=!1})},customFormatterMonth:function(t){return n()(t).format("YYYY-MM")},monthSelectedInChild:function(t){this.monthDeduction=t},resetForm:function(){this.shops.shop_code="",this.$refs.select_ctmCare.reset(),this.$refs.select_rcType.reset()},searchReturnCouponResult:function(t,e){var s=this,a={shop_code:s.shops.shop_code,ctm_care:s.selected.ctmCare,rc_type:s.selected.rcType,month_return_coupon:s.customFormatterMonth(this.monthDeduction),page:t,limit:s.pageData.perPage};e&&(this.pageData.currentPage=1,a.page=1),s.loadingExcel=!0,d.a.searchReturnCouponResult(a).then(function(t){t.data.success&&(s.checkResult=t.data.success,s.pageData.totalItems=t.data.options.total,s.pageData.perPage=t.data.options.per_page,s.pageData.totalPages=t.data.options.total_page,s.listShops=t.data.options.shops,s.canViewAll=t.data.options.canViewAll)}).catch(function(t){}).then(function(){s.loadingExcel=!1})},exportResult:function(){var t=this,e={shop_code:t.shops.shop_code,ctm_care:t.selected.ctmCare,rc_type:t.selected.rcType,month_return_coupon:t.customFormatterMonth(this.monthDeduction)};t.loadingExcel=!0,d.a.exportReturnCouponResult(e).then(function(t){if(t.data.success)window.location.href=t.data.data;else{var e=t.data.msg?t.data.msg:"Có lỗi xảy ra. Hãy thử lại nhé!";alert(e)}}).catch(function(t){t&&alert("Có lỗi xảy ra. Hãy thử lại nhé!")}).then(function(){t.loadingExcel=!1})},pageChanged:function(t){this.searchReturnCouponResult(t),this.pageData.currentPage=t}},filters:{shopStatus:function(t){return t?"1"===t?"Đang làm việc":"2"===t?"Đã dừng":"3"===t?"Chưa kiểm duyệt":"Tiếp tục liên hệ":""}},created:function(){this.getRcTypeInfo()}},g=s("XyMi");var m=function(t){s("Yd6+")},f=Object(g.a)(b,function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[s("div",{staticClass:"ui-block"},[s("b-form-row",[s("h4",{staticClass:"ui-block-heading col-md-6"},[t._v("Quản lý hoàn phí trả")]),t._v(" "),s("div",{staticClass:"col-md-6 center"},[s("b-button",{staticClass:"btn btn-success",on:{click:t.showImportModal}},[s("i",{staticClass:"sidenav-icon ion ion-md-information-circle"}),t._v("\n                  Thông tin các gói cam kết hoàn\n              ")]),t._v(" "),s("b-button",{staticClass:"btn btn-warning"},[s("sidenav-router-link",{attrs:{to:"/shops/return-coupon"}},[s("i",{staticClass:"sidenav-icon ion ion-md-fastforward"}),t._v("Quản lý cam kết hoàn")])],1)],1)]),t._v(" "),s("div",[s("form",[s("div",{staticClass:"form-filter"},[s("b-form-row",[s("div",{staticClass:"col-md-6"},[s("b-form-group",{attrs:{label:"Mã shop"}},[s("b-input",{attrs:{type:"text",placeholder:"Nhiều mã cách nhau bởi dấu phẩy. Ví dụ: S1,S2..."},model:{value:t.shops.shop_code,callback:function(e){t.$set(t.shops,"shop_code",e)},expression:"shops.shop_code"}})],1)],1),t._v(" "),s("div",{staticClass:"col-md-6"},[s("b-form-group",{attrs:{label:"CSKH"}},[s("select-ctmCare",{ref:"select_ctmCare",on:{selected:function(e){t.selected.ctmCare=e}}})],1)],1)]),t._v(" "),s("b-form-row",[s("div",{staticClass:"col-md-6"},[s("b-form-group",{attrs:{label:"Gói cam kết hoàn"}},[s("select-rc-type",{ref:"select_rcType",on:{selected:function(e){t.selected.rcType=e}}})],1)],1),t._v(" "),s("div",{staticClass:"col-md-6"},[s("b-form-group",{attrs:{label:"Chọn tháng tính phí hoàn:"}},[s("datepicker",{attrs:{"minimum-view":"month","maximum-view":"month",bootstrapStyling:!0,format:t.customFormatterMonth},on:{selected:t.monthSelectedInChild},model:{value:t.monthDeduction,callback:function(e){t.monthDeduction=e},expression:"monthDeduction"}})],1)],1)])],1),t._v(" "),s("b-form-row",[s("div",{staticClass:"align-content-center center"},[t.loadingExcel?s("BlockUI",{attrs:{message:"Dữ liệu đang được xử lý, vui lòng đợi!",html:t.loadingExcelHtml}}):t._e(),t._v(" "),s("b-button",{staticClass:"btn",on:{click:t.resetForm}},[t._v("\n              Nhập lại\n            ")]),t._v(" "),s("b-button",{staticClass:"btn btn-success",on:{click:function(e){return t.searchReturnCouponResult(t.pageData.currentPage,!0)}}},[s("i",{staticClass:"sidenav-icon ion ion-md-search"}),t._v("\n              Tìm kiếm\n            ")]),t._v(" "),s("b-button",{staticClass:"btn btn-success",on:{click:function(e){return t.exportResult()}}},[s("i",{staticClass:"sidenav-icon ion ion-md-cloud-download"}),t._v("\n              Xuất File Chi Tiết\n            ")]),t._v(" "),t.canViewAll&&t.listShops.length>0?s("b-btn",{staticClass:"btn btn-danger",attrs:{disabled:!t.canViewAll||0==t.listShops.length,type:"button"},on:{click:t.downloadRcFileZip}},[s("i",{staticClass:"sidenav-icon ion ion-md-cloud-download"}),t._v("\n              Tải file zip\n            ")]):t._e()],1)])],1)]),t._v(" "),t.checkResult?s("div",{staticClass:"result",attrs:{id:"results"}},[t.listShops.length>0?s("b-card",{attrs:{"no-body":""}},[s("div",{staticClass:"table-result"},[s("b-card-body",{staticClass:"pt-0 pb-3"},[s("div",{staticClass:"row"},[s("div",{staticClass:"col-sm pt-3"},[s("b-pagination",{attrs:{"total-rows":t.pageData.totalItems,"per-page":t.pageData.perPage},on:{change:t.pageChanged},model:{value:t.pageData.currentPage,callback:function(e){t.$set(t.pageData,"currentPage",e)},expression:"pageData.currentPage"}}),t._v("\n                Tổng số shop: "+t._s(t.pageData.totalItems)+"\n              ")],1),t._v(" "),s("div",{staticClass:"col-sm text-sm-left text-center pt-3"},[t.pageData.totalItems?s("span",{staticClass:"text-muted"},[t._v("Trang "+t._s(t.pageData.currentPage)+" trên "+t._s(t.pageData.totalPages))]):t._e()])])]),t._v(" "),s("div",{staticClass:"table-responsive mb-4"},[s("table",{staticClass:"table mb-0 table-bordered table-striped"},[s("thead",{staticStyle:{width:"100%"}},[s("tr",[s("th",{attrs:{width:"45%"}},[t._v("Thông tin shop")]),t._v(" "),s("th",{attrs:{width:"45%"}},[t._v("Thông tin chi tiết")]),t._v(" "),s("th",{attrs:{width:"5%"}},[t._v("Thao tác")])])]),t._v(" "),s("tbody",t._l(t.listShops,function(e){return s("tr",{staticClass:"tr-bill"},[s("td",[1==e.Shop.shop_type?s("span",{staticClass:"badge align-text-bottom badge-success"},[t._v("PRO")]):t._e(),t._v(" "),2==e.Shop.shop_type?s("span",{staticClass:"badge align-text-bottom badge-danger"},[t._v("VIP")]):t._e(),t._v(" "),3==e.Shop.shop_type?s("span",{staticClass:"badge align-text-bottom badge-info"},[t._v("PRE")]):t._e(),t._v(" "),s("span",{staticClass:"font-weight-bold"},[t._v(t._s(e.Shop.code)+" - "+t._s(e.Shop.name))]),t._v(" "),s("br"),t._v(" "),s("br"),t._v(" "),s("span",{staticClass:"font-weight-bold"},[t._v("Số ĐT: ")]),s("span",[t._v(t._s(e.Shop.tel))]),t._v(" "),s("br"),t._v(" "),s("span",{staticClass:"font-weight-bold"},[t._v("Email: ")]),s("span",[t._v(t._s(e.Shop.email))]),t._v(" "),s("br"),t._v(" "),s("span",{staticClass:"font-weight-bold"},[t._v("CSKH: ")]),s("span",[t._v(t._s(e.Shop.ctm_care))]),t._v(" "),s("br"),t._v(" "),s("span",{staticClass:"font-weight-bold"},[t._v("Trạng thái: ")]),s("span",[t._v(t._s(t._f("shopStatus")(e.Shop.shop_status_id)))]),t._v(" "),s("br"),t._v(" "),s("span",{staticClass:"font-weight-bold"},[t._v("Thời gian tạo: ")]),s("span",[t._v(t._s(e.Shop.created))]),t._v(" "),s("br")]),t._v(" "),s("td",[s("span",{staticClass:"font-weight-bold"},[t._v("Gói: ")]),t._v(" "),s("span",{staticClass:"font-weight-bold text-danger"},[t._v(t._s(e.RpDbReturnCouponType.name))]),s("br"),t._v(" "),s("span",{staticClass:"font-weight-bold"},[t._v("Tỉ lệ cam kết với Shop: ")]),t._v(" "),e.RpDbReturnCouponResult.re_value_config?s("span",{staticClass:"font-weight-bold text-danger"},[t._v("\n                        "+t._s(e.RpDbReturnCouponResult.re_value_config)+"%\n                    ")]):t._e(),s("br"),t._v(" "),s("span",{staticClass:"font-weight-bold"},[t._v("Tỉ lệ hoàn thực tế: ")]),t._v(" "),e.RpDbReturnCouponResult.re_value?s("span",[t._v(t._s(e.RpDbReturnCouponResult.re_value)+"%")]):t._e(),s("br"),t._v(" "),s("span",{staticClass:"font-weight-bold"},[t._v("Số đơn cam kết với Shop: ")]),t._v(" "),s("span",{staticClass:"font-weight-bold text-danger"},[t._v(t._s(e.RpDbReturnCouponResult.number_pkg_config))]),s("br"),t._v(" "),s("span",{staticClass:"font-weight-bold"},[t._v("Số đơn lấy thành công: ")]),t._v(" "),s("span",[t._v(t._s(e.RpDbReturnCouponResult.number_pkg_picked))]),s("br"),t._v(" "),s("span",{staticClass:"font-weight-bold"},[t._v("Số đơn hoàn thành: ")]),t._v(" "),s("span",[t._v(t._s(e.RpDbReturnCouponResult.number_pkg_done))]),s("br"),t._v(" "),s("span",{staticClass:"font-weight-bold"},[t._v("Đơn không giao được hàng: ")]),t._v(" "),s("span",[t._v(t._s(e.RpDbReturnCouponResult.number_pkg_return))]),s("br"),t._v(" "),s("span",{staticClass:"font-weight-bold"},[t._v("Số đơn thỏa mãn tỉ lệ cam kết: ")]),t._v(" "),s("span",[t._v(t._s(e.RpDbReturnCouponResult.number_pkg))]),s("br"),t._v(" "),s("span",{staticClass:"font-weight-bold"},[t._v("Số tiền hoàn lại Shop: ")]),t._v(" "),s("span",{staticClass:"font-weight-bold text-danger"},[t._v(t._s(e.RpDbReturnCouponResult.return_money))]),s("br"),t._v(" "),s("span",{staticClass:"font-weight-bold"},[t._v("Thời gian gán gói:")]),t._v(" "),s("span",[t._v(t._s(e.RpDbReturnCouponResult.date_config))]),s("br")]),t._v(" "),s("td",[s("a",{attrs:{href:t.slug(e.RpDbReturnCouponResult.id),target:"_blank"}},[t._v("\n                        Tải file\n                    ")])])])}),0)])])],1)]):t._e(),t._v(" "),0==t.listShops.length?s("div",{staticClass:"no-data"},[s("b-alert",{attrs:{show:"",dismissible:"",variant:"warning"}},[s("i",{staticClass:"sidenav-icon ion ion-ios-warning"}),t._v("\n          Không có dữ liệu phù hợp, vui lòng thử lại.\n        ")])],1):t._e()],1):t._e(),t._v(" "),s("b-modal",{ref:"rcTypeInfoModal",attrs:{size:"lg",title:"Thông tin các gói cam kết hoàn",static:""}},[s("div",{staticClass:"d-block"},[s("div",{staticClass:"table-responsive mb-4"},[s("table",{staticClass:"table mb-0 table-bordered table-striped"},[s("thead",{staticStyle:{width:"100%"}},[s("tr",[s("th",{attrs:{width:"10%"}},[t._v("Mã")]),t._v(" "),s("th",{attrs:{width:"30%"}},[t._v("Tên gói")]),t._v(" "),s("th",{attrs:{width:"60%"}},[t._v("Chi tiết")])])]),t._v(" "),s("tbody",t._l(t.rcTypeInfo,function(e){return s("tr",{staticClass:"tr-bill"},[s("td",[s("span",{staticClass:"font-weight-bold"},[t._v(t._s(e.ReturnCouponType.id))])]),t._v(" "),s("td",{staticClass:"bill-info"},[s("span",{staticClass:"font-weight-bold"},[t._v(t._s(e.ReturnCouponType.name))])]),t._v(" "),s("td",[s("span",{staticClass:"font-weight-bold",domProps:{innerHTML:t._s(e.ReturnCouponType.desc)}})])])}),0)])])]),t._v(" "),s("div",{staticClass:"w-100",attrs:{slot:"modal-footer"},slot:"modal-footer"},[s("b-btn",{staticClass:"float-right",attrs:{variant:"default"},on:{click:t.hideImportModal}},[t._v("\n                  Đóng\n              ")])],1)])],1)])},[],!1,m,"data-v-3352873a",null);e.default=f.exports}});