webpackJsonp([57],{IdY6:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=a("IC97"),i=a("w6Ui"),s=a("mvHQ"),o=a.n(s),c=a("kNeQ"),d=a("qaB4"),l={components:{LaddaBtn:d.a},name:"update-deduction-config",props:["activeModal","editDeduction"],data:function(){return{showModal:!1,alert:{show:!1,type:"danger",message:"hello 111"},deductionInfo:[],loading:[!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1]}},watch:{activeModal:function(t){this.showModal=t},editDeduction:function(t){this.deductionInfo=JSON.parse(o()(t))}},methods:{startLoading:function(t){this.loading[t]||this.updateLoadingValue(t,!0)},updateLoadingValue:function(t,e){this.loading[t]=e,this.loading=this.loading.slice(0)},hideModal:function(){this.$emit("modal-show",!1),this.alert.show=!1,this.deductionInfo=JSON.parse(o()(this.editDeduction))},updateDeduction:function(t){var e=this,a=this.deductionInfo;this.startLoading(t),c.a.updateDeductionConfig(a).then(function(t){e.alert.show=!0,e.alert.message=t.data.message,t.data.success?(e.alert.type="success",e.$emit("update-success",!0)):e.alert.type="danger"}).catch(function(t){}).then(function(){e.updateLoadingValue(t,!1)})}}},u=a("XyMi"),r=Object(u.a)(l,function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("b-modal",{attrs:{title:"Cập nhật gói chiết khấu"},on:{hidden:t.hideModal},scopedSlots:t._u([{key:"modal-footer",fn:function(e){return e.ok,e.cancel,[a("b-button",{attrs:{variant:"danger"},on:{click:t.hideModal}},[t._v("\n        Hủy\n      ")]),t._v(" "),a("ladda-btn",{staticClass:"btn btn-primary",attrs:{loading:t.loading[5],"data-style":"zoom-out"},nativeOn:{click:function(e){return t.updateDeduction(5)}}},[t._v("\n        Lưu\n      ")])]}}]),model:{value:t.showModal,callback:function(e){t.showModal=e},expression:"showModal"}},[a("div",{staticClass:"no-data"},[a("b-alert",{attrs:{show:t.alert.show,dismissible:"",variant:t.alert.type},on:{dismissed:function(e){t.alert.show=!1}}},[t._v("\n        "+t._s(t.alert.message)+"\n      ")])],1),t._v(" "),a("form",[a("b-form-group",[a("label",{staticClass:"font-weight-bold"},[t._v("Gói chiết khấu: ")]),t._v(" "),a("span",{staticClass:"font-weight-bold text-danger"},[t._v(t._s(t.deductionInfo.parent_name))])]),t._v(" "),a("b-form-group",[a("label",{staticClass:"font-weight-bold"},[t._v("Tên hiển thị:")]),t._v(" "),a("b-input",{attrs:{type:"text"},model:{value:t.deductionInfo.name,callback:function(e){t.$set(t.deductionInfo,"name",e)},expression:"deductionInfo.name"}})],1),t._v(" "),a("b-form-group",[a("label",{staticClass:"font-weight-bold"},[t._v("Số lượng đơn hàng yêu cầu:")]),t._v(" "),a("b-input",{attrs:{type:"number"},model:{value:t.deductionInfo.number_pkg,callback:function(e){t.$set(t.deductionInfo,"number_pkg",e)},expression:"deductionInfo.number_pkg"}})],1),t._v(" "),a("b-form-group",[a("label",{staticClass:"font-weight-bold"},[t._v("Ngưỡng cân và số tiền giảm:")]),t._v(" "),a("table",{staticClass:"table b-table table-striped table-hover",attrs:{role:"table","aria-busy":"false","aria-colcount":"3"}},[a("thead",{staticClass:"font-weight-bold"},[a("tr",[a("th",[t._v("Từ (kg)")]),t._v(" "),a("th",[t._v("Đến (kg)")]),t._v(" "),a("th",[t._v("Số tiền giảm (đ)")])])]),t._v(" "),a("tbody",t._l(t.deductionInfo.detail,function(e,n){return a("tr",[a("td",[a("b-input",{attrs:{type:"number"},model:{value:t.deductionInfo.detail[n].weight_pkg_from,callback:function(e){t.$set(t.deductionInfo.detail[n],"weight_pkg_from",e)},expression:"deductionInfo.detail[key].weight_pkg_from"}})],1),t._v(" "),a("td",[a("b-input",{attrs:{type:"number"},model:{value:t.deductionInfo.detail[n].weight_pkg_to,callback:function(e){t.$set(t.deductionInfo.detail[n],"weight_pkg_to",e)},expression:"deductionInfo.detail[key].weight_pkg_to"}})],1),t._v(" "),a("td",[a("b-input",{attrs:{type:"number"},model:{value:t.deductionInfo.detail[n].reduce_value,callback:function(e){t.$set(t.deductionInfo.detail[n],"reduce_value",e)},expression:"deductionInfo.detail[key].reduce_value"}})],1)])}),0)])])],1)])],1)},[],!1,null,null,null).exports,g=a("RUzx"),p=a.n(g),h=a("KVzY");a("7+uW").default.use(h.default);var v={components:{SidenavRouterLink:i.g,LaddaBtn:d.a,Datepicker:n.a,Multiselect:p.a,UpdateDeductionConfig:r},data:function(){return{selected:{deductionType:[]},selectDeductionType:{name:"CK BB_Đặc biệt",code:"1"},deductionType:[{name:"CK BB_Đặc biệt",code:"1"}],pageData:{currentPage:1,totalPages:0,totalItems:0,perPage:50,sortBy:"id",sortDesc:!1},checkResult:!1,listDeductions:[],isCanEdit:!1,editDeductionData:[],modalShow:!1,loadingExcel:!1,loadingExcelHtml:'\n      <div class="sk-folding-cube sk-primary">\n        <div class="sk-cube1 sk-cube"></div>\n        <div class="sk-cube2 sk-cube"></div>\n        <div class="sk-cube4 sk-cube"></div>\n        <div class="sk-cube3 sk-cube"></div>\n      </div>\n      <h5 class="text-center mb-0">LOADING...</h5>\n    '}},methods:{searchNewDeductionDetail:function(t,e){var a=this,n={deduction_parent_id:a.selectDeductionType.code,page:t,limit:a.pageData.perPage};e&&(this.pageData.currentPage=1,n.page=1),a.loadingExcel=!0,c.a.searchNewDeductionDetail(n).then(function(t){t.data.success&&(a.checkResult=t.data.success,a.pageData.totalItems=t.data.options.total,a.pageData.perPage=t.data.options.per_page,a.pageData.totalPages=t.data.options.total_page,a.listDeductions=t.data.options.deductions,a.isCanEdit=t.data.options.canEdit)}).catch(function(t){}).then(function(){a.loadingExcel=!1})},pageChanged:function(t){this.searchNewDeductionDetail(t),this.pageData.currentPage=t},editDeduction:function(t){this.editDeductionData=t,this.modalShow=!0},updateSuccess:function(){this.searchNewDeductionDetail(this.pageData.currentPage)}}};var b=function(t){a("js5Y")},_=Object(u.a)(v,function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("div",{staticClass:"ui-block"},[a("h2",{staticClass:"text-center"},[t._v("Quản lý chiết khấu mới")]),t._v(" "),a("div",[a("form",[a("div",{staticClass:"form-filter"},[a("b-form-row",[a("div",{staticClass:"col-md-12"},[a("b-form-group",{attrs:{label:"Gói chiết khấu"}},[a("multiselect",{attrs:{"track-by":"name",label:"name",placeholder:"Chọn gói chiết khấu",options:t.deductionType,selectLabel:"",selectedLabel:"",deselectLabel:"","allow-empty":!1},model:{value:t.selectDeductionType,callback:function(e){t.selectDeductionType=e},expression:"selectDeductionType"}})],1)],1)])],1),t._v(" "),t.loadingExcel?a("BlockUI",{attrs:{message:"Dữ liệu đang được xử lý, vui lòng đợi!",html:t.loadingExcelHtml}}):t._e(),t._v(" "),a("b-form-row",[a("div",{staticClass:"align-content-center center"},[a("div",{staticClass:"col-md-12 text-center"},[a("b-button",{staticClass:"btn btn-success",on:{click:function(e){return t.searchNewDeductionDetail(t.pageData.currentPage,!0)}}},[t._v("\n                Xem Chi tiết\n              ")])],1)])])],1)]),t._v(" "),t.checkResult?a("div",{staticClass:"result",attrs:{id:"results"}},[t.listDeductions.length>0?a("b-card",{attrs:{"no-body":""}},[a("div",{staticClass:"table-result"},[a("b-card-body",{staticClass:"pt-0 pb-3"},[a("div",{staticClass:"row"},[a("div",{staticClass:"col-sm pt-3"},[a("b-pagination",{attrs:{"total-rows":t.pageData.totalItems,"per-page":t.pageData.perPage},on:{change:t.pageChanged},model:{value:t.pageData.currentPage,callback:function(e){t.$set(t.pageData,"currentPage",e)},expression:"pageData.currentPage"}}),t._v("\n                Tổng số: "+t._s(t.pageData.totalItems)+"\n              ")],1),t._v(" "),a("div",{staticClass:"col-sm text-sm-left text-center pt-3"},[t.pageData.totalItems?a("span",{staticClass:"text-muted"},[t._v("Trang "+t._s(t.pageData.currentPage)+" trên "+t._s(t.pageData.totalPages))]):t._e()])])]),t._v(" "),a("div",{staticClass:"table-responsive mb-4"},[a("table",{staticClass:"table mb-0 table-bordered table-striped"},[a("thead",{staticStyle:{width:"100%"}},[a("tr",[a("th",{attrs:{width:"40%"}},[t._v("Gói chiết khấu")]),t._v(" "),a("th",{attrs:{width:"50%"}},[t._v("Thông tin chi tiết")]),t._v(" "),a("th",{attrs:{width:"10%"}},[t._v("Thao tác")])])]),t._v(" "),a("tbody",t._l(t.listDeductions,function(e){return a("tr",{staticClass:"tr-bill"},[a("td",[a("span",{staticClass:"font-weight-bold"},[t._v(t._s(e.parent_name)+" ("+t._s(e.name)+")")]),t._v(" "),a("br"),a("br"),t._v(" "),a("span",{staticClass:"font-weight-bold"},[t._v("Số lượng đơn hàng yêu cầu: "),a("span",{staticClass:"text-danger"},[t._v(t._s(e.number_pkg))])]),t._v(" "),a("br")]),t._v(" "),a("td",t._l(e.detail,function(e){return a("span",[a("span",{staticClass:"font-weight-bold"},[t._v("Ngưỡng cân (kg): "+t._s(e.weight_pkg_from)+" < x <= "+t._s(e.weight_pkg_to))]),t._v(" "),a("span",{staticClass:"font-weight-bold text-danger"},[t._v("(Số tiền giảm: "+t._s(e.reduce_value)+"đ)")]),t._v(" "),a("br")])}),0),t._v(" "),a("td",[a("div",{staticClass:"text-center"},[a("b-button",{staticClass:"btn btn-primary",attrs:{disabled:!t.isCanEdit},on:{click:function(a){return t.editDeduction(e)}}},[t._v("Sửa\n                    ")])],1)])])}),0)])])],1)]):t._e(),t._v(" "),a("update-deduction-config",{attrs:{activeModal:t.modalShow,editDeduction:t.editDeductionData},on:{"modal-show":function(e){t.modalShow=e},"update-success":t.updateSuccess}}),t._v(" "),0==t.listDeductions.length?a("div",{staticClass:"no-data"},[a("b-alert",{attrs:{show:"",dismissible:"",variant:"warning"}},[a("i",{staticClass:"sidenav-icon ion ion-ios-warning"}),t._v("\n          Không có dữ liệu phù hợp, vui lòng thử lại.\n        ")])],1):t._e()],1):t._e()])])},[],!1,b,"data-v-94eb6db6",null);e.default=_.exports},js5Y:function(t,e){}});