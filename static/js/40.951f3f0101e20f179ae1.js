webpackJsonp([40],{"FB/Y":function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i("mG5u"),a=i("F/2K"),s=i("a/7L"),o=i("YlZe"),l=i("csCE"),r=i("5vjp"),c=i("TyzE"),d=i("nmdP"),m={name:"manager-hrteam",components:{SingleSelectProvince:a.a,SingleSelectStation:s.a,SingleSelectPosition:o.a,SingleSelectDepartment:l.a,SingleSelectModule:r.a,MultiSelectProvince:c.a,SelectHrMember:d.a},data:function(){return{provinceId:"",stationId:"",departmentId:"",positionId:"",currentPage:1,totalItems:0,perPage:5,hrteams:[],teamname:""}},created:function(){this.search()},computed:{totalPages:function(){return Math.ceil(this.totalItems/this.perPage)}},watch:{},methods:{handleSelectedModule:function(t){this.moduleId=t?t.id:null},search:function(){var t=this;this.appLoading=!0;var e={teamname:this.teamname,provinceId:this.provinceId,stationId:this.stationId,moduleId:this.moduleId,departmentId:this.departmentId,positionId:this.positionId,page:this.currentPage,limit:this.perPage};n.a.getAll(e).then(function(e){e.data.success&&(t.hrteams=e.data.data,t.totalItems=e.data.total,0===t.totalItems&&(t.hrteams=[]))}).catch(function(t){console.log(t)}).then(function(){t.appLoading=!1}),this.firstTime=!1},handleSelectedProvince:function(t){this.provinceId=t?t.id:""},handleSelectedStation:function(t){this.stationId=t?t.id:""},handleSelectedDepartment:function(t){this.departmentId=t?t.id:""},handleSelectedPosition:function(t){this.positionId=t?t.id:""},deleteHrTeam:function(t){var e=this;confirm("Bạn có chắc chắn muốn xóa nhóm "+t.name+" ?")&&(this.$startLoading(),n.a.deleteHrTeam(t.id).then(function(t){t.data.success?(e.$notify({group:"default",type:"bg-success text-white",title:"Thông báo",text:"Xóa nhóm thành công!"}),e.search()):e.$notify({group:"default",type:"bg-warning text-dark",title:"Thông báo",text:t.data.message})}).catch(function(t){console.log(t),e.$notify({group:"default",type:"bg-warning text-dark",title:"Thông báo",text:"Có lỗi xảy ra trong quá trình xóa nhóm."})}).then(function(){e.appLoading=!1,e.$stopLoading()}))}}},h=i("XyMi");var u=function(t){i("rckF")},p=Object(h.a)(m,function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[i("div",{staticClass:"ui-block"},[i("h4",{staticClass:"ui-block-heading"},[t._v("Cơ cấu team nhân sự")]),t._v(" "),i("hr"),t._v(" "),i("div",{staticClass:"mb-3"},[i("b-row",[i("b-col",{attrs:{md:"2"}},[i("b-input",{attrs:{type:"text",placeholder:"Tên team"},model:{value:t.teamname,callback:function(e){t.teamname=e},expression:"teamname"}})],1),t._v(" "),i("b-col",{attrs:{md:"2"}},[i("single-select-province",{on:{handleSelectedProvince:t.handleSelectedProvince}})],1),t._v(" "),i("b-col",{attrs:{md:"2"}},[i("single-select-station",{attrs:{"province-id":t.provinceId},on:{handleSelectedStation:t.handleSelectedStation}})],1),t._v(" "),i("b-col",{attrs:{md:"2"}},[i("single-select-module",{attrs:{"station-id":t.stationId},on:{handleSelectedModule:t.handleSelectedModule}})],1),t._v(" "),i("b-col",{attrs:{md:"2"}},[i("single-select-department",{on:{handleSelectedDepartment:t.handleSelectedDepartment}})],1),t._v(" "),i("b-col",{attrs:{md:"2"}},[i("single-select-position",{attrs:{"department-id":t.departmentId},on:{handleSelectedPosition:t.handleSelectedPosition}})],1)],1),t._v(" "),i("b-row",[i("b-col",{staticClass:"text-right",attrs:{md:"12"}},[i("b-btn",{attrs:{type:"button",variant:"primary"},on:{click:function(e){t.currentPage=1,t.search()}}},[i("i",{staticClass:"sidenav-icon ion ion-md-search"}),t._v(" Tìm kiếm")]),t._v(" "),i("router-link",{staticClass:"btn btn-md btn-outline-info ml-1",attrs:{to:{name:"add-hrteam"}}},[i("i",{staticClass:"ion ion-md-add"}),t._v(" Thêm nhóm")])],1)],1)],1),t._v(" "),i("div",{staticClass:"mb-3"},[i("div",[i("b-card",{attrs:{"no-body":""}},[i("table",{staticClass:"table mb-0 table-hover table-bordered"},[i("thead",[i("tr",[i("th",[t._v("STT")]),t._v(" "),i("th",[t._v("Tên nhóm")]),t._v(" "),i("th",[t._v("Trưởng nhóm")]),t._v(" "),i("th",{staticStyle:{width:"30%"}},[t._v("Thành viên")]),t._v(" "),i("th",{staticStyle:{width:"30%"}},[t._v("Tỉnh quản lý")]),t._v(" "),i("th",{staticStyle:{"min-width":"120px"}},[t._v("Action")])])]),t._v(" "),i("tbody",t._l(t.hrteams,function(e,n){return i("tr",{key:n},[i("td",[t._v(t._s((t.currentPage-1)*t.perPage+n+1))]),t._v(" "),i("td",[t._v("\n                  "+t._s(e.name)+"\n                ")]),t._v(" "),i("td",[e.leader?i("div",[0!=e.leader.master_profile_id?i("router-link",{attrs:{to:{name:"edit-master-profile",params:{id:e.leader.master_profile_id}}}},[t._v(t._s(e.leader.fullname))]):e.leader.id?i("router-link",{attrs:{to:{name:"edit-user",params:{id:e.leader.id}}}},[t._v(t._s(e.leader.fullname))]):e.leader?i("p",[t._v(t._s(e.leader.fullname))]):t._e()],1):t._e()]),t._v(" "),i("td",[i("select-hr-member",{staticClass:"limit-width",attrs:{"member-ids":e.member_id,"is-multi":!0}})],1),t._v(" "),i("td",[i("multi-select-province",{staticClass:"limit-width",attrs:{"province-ids":e.province_id,"limit-prop":7}})],1),t._v(" "),i("td",{staticStyle:{"max-width":"40px"}},[i("router-link",{staticClass:"btn btn-outline-secondary",attrs:{to:{name:"edit-hrteam",params:{id:e.id}}}},[i("i",{staticClass:"ion ion-md-create"})]),t._v(" "),i("b-btn",{staticClass:"btn btn-md btn-outline-danger",on:{click:function(i){return t.deleteHrTeam(e)}}},[i("i",{staticClass:"ion ion-md-trash"})])],1)])}),0)]),t._v(" "),t.totalPages>1?i("div",{staticClass:"mt-3"},[i("b-row",[i("b-col",[i("b-pagination",{attrs:{"total-rows":t.totalItems,"per-page":t.perPage,align:"center"},on:{input:t.search},model:{value:t.currentPage,callback:function(e){t.currentPage=e},expression:"currentPage"}})],1)],1)],1):t._e()])],1)])])])},[],!1,u,"data-v-3942c4e8",null);e.default=p.exports},nmdP:function(t,e,i){"use strict";var n=i("RUzx"),a=i.n(n),s=i("mG5u"),o={name:"select-hr-member",components:{Multiselect:a.a},props:{isDisabled:{type:Boolean},isMulti:{type:Boolean},memberIds:{type:String},limitProp:{type:Number}},data:function(){return{option:null,options:[],limit:5,isMultiple:!1,closeOnSelect:!0}},created:function(){this.getList(),this.isMulti&&(this.isMultiple=!0,this.closeOnSelect=!1),this.limitProp&&(this.limit=this.limitProp)},watch:{limitProp:function(t,e){this.limit=t},memberIds:function(t,e){void 0!==this.options&&0!==this.options.length?(this.memberIds||(this.option=[]),this.setList()):this.option=[]},option:function(t,e){this.$emit("handleSelectedHrMember",t)},isMulti:function(t,e){this.isMultiple=this.isMulti}},methods:{customLabel:function(t){return t.fullname+" ("+t.username+" - "+t.stationname+")"},setList:function(){var t=this;this.memberIds&&(this.isMultiple?(this.option=[],this.memberIds.split(",").forEach(function(e){var i=t.options.find(function(t){return t.id===e});i&&t.option.push(i)})):this.option=this.options.find(function(e){return e.id===t.memberIds}))},setSelectedOption:function(){var t=this;this.options.length>0&&this.hrmember&&(this.option=this.options.find(function(e){return e.id===t.hrmember}))},getList:function(){var t=this;s.a.getAllHrMember().then(function(e){e.data.success&&(t.options=e.data.data,t.setList())}).catch(function(t){console.log(t)})}}},l=i("XyMi"),r=Object(l.a)(o,function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[i("multiselect",{staticClass:"multiselect-primary",attrs:{options:t.options,placeholder:"Chọn nhân sự","custom-label":t.customLabel,"track-by":"fullname",limit:t.limit,selectedLabel:"Đã chọn",deselectLabel:"Bỏ chọn",selectLabel:"Chọn",searchable:!0,disabled:t.isDisabled,multiple:t.isMultiple,"hide-selected":t.isMultiple,"close-on-select":t.closeOnSelect},model:{value:t.option,callback:function(e){t.option=e},expression:"option"}},[i("span",{attrs:{slot:"noResult"},slot:"noResult"},[t._v("Rất tiếc. Không tìm thấy.")])])],1)},[],!1,null,null,null);e.a=r.exports},rckF:function(t,e){}});