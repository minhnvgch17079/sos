webpackJsonp([18],{"92s/":function(t,e,a){"use strict";var s=a("RUzx"),i=a.n(s),n=a("agCp"),l={name:"select-wh-staffs",props:{disabled:{type:Boolean,default:!1},multiple:{type:Boolean,default:!0},placeholder:{type:String,default:"Chọn phụ kho"},stationId:{}},components:{Multiselect:i.a,staffService:n.a},data:function(){return{whStaffs:[],selectedWhStaffs:[]}},watch:{stationId:function(t,e){this.getOptions(t)}},methods:{getOptions:function(t){var e=this,a={station_id:t};n.a.getListWhStaffByStationId(a).then(function(t){t.data.success&&(e.whStaffs=t.data.data,e.multiple||e.stations.unshift({id:"",name:e.placeholder}))}).catch(function(t){})},onSelect:function(t){if(this.multiple){var e=[];if(this.selectedWhStaffs.length>0)for(var a=0;a<this.selectedWhStaffs.length;a++)e.push(this.selectedWhStaffs[a].id);e.push(t.id),this.$emit("selected",e)}else this.selectedWhStaffs=t.id,this.$emit("selected",this.selectedWhStaffs)},onRemove:function(t){var e=[];if(this.multiple){for(var a=0;a<this.selectedWhStaffs.length;a++)this.selectedWhStaffs[a].id!==t.id&&e.push(this.selectedWhStaffs[a].id);this.$emit("selected",e)}},reset:function(){this.selectedWhStaffs=this.multiple?[]:""}},created:function(){this.getOptions()}},o=a("XyMi");var c=function(t){a("A5rd")},d=Object(o.a)(l,function(){var t=this,e=t.$createElement;return(t._self._c||e)("multiselect",{attrs:{options:t.whStaffs,multiple:t.multiple,disabled:t.disabled,placeholder:t.placeholder,"track-by":"name",label:"name",selectLabel:"",selectedLabel:"",deselectLabel:"x"},on:{select:t.onSelect,remove:t.onRemove},model:{value:t.selectedWhStaffs,callback:function(e){t.selectedWhStaffs=e},expression:"selectedWhStaffs"}})},[],!1,c,"data-v-35a88f19",null);e.a=d.exports},A5rd:function(t,e){},"hWi/":function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var s=a("m4Ev"),i=a("RUzx"),n=a.n(i),l=a("agCp"),o={name:"select-leader-by-station",props:{disabled:{type:Boolean,default:!1},multiple:{type:Boolean,default:!0},placeholder:{type:String,default:"Chọn Điều Phối / Trưởng Module"},stationId:{}},components:{Multiselect:n.a,staffService:l.a},data:function(){return{staffs:[],selectedStaffs:[]}},watch:{stationId:function(t,e){this.getOptions(t)}},methods:{getOptions:function(t){var e=this,a={station_id:t};l.a.getLeaderByStation(a).then(function(t){t.data.success&&(e.staffs=t.data.data,e.multiple||e.stations.unshift({id:"",name:e.placeholder}))}).catch(function(t){})},onSelect:function(t){if(this.multiple){var e=[];if(this.selectedStaffs.length>0)for(var a=0;a<this.selectedStaffs.length;a++)e.push(this.selectedStaffs[a].id);e.push(t.id),this.$emit("selected",e)}else this.selectedStaffs=t.id,this.$emit("selected",this.selectedStaffs)},onRemove:function(t){var e=[];if(this.multiple){for(var a=0;a<this.selectedStaffs.length;a++)this.selectedStaffs[a].id!==t.id&&e.push(this.selectedStaffs[a].id);this.$emit("selected",e)}},reset:function(){this.selectedStaffs=this.multiple?[]:""}},created:function(){this.getOptions()}},c=a("XyMi");var d=function(t){a("s2UW")},r=Object(c.a)(o,function(){var t=this,e=t.$createElement;return(t._self._c||e)("multiselect",{attrs:{options:t.staffs,multiple:t.multiple,disabled:t.disabled,placeholder:t.placeholder,"track-by":"name",label:"name",selectLabel:"",selectedLabel:"",deselectLabel:"x"},on:{select:t.onSelect,remove:t.onRemove},model:{value:t.selectedStaffs,callback:function(e){t.selectedStaffs=e},expression:"selectedStaffs"}})},[],!1,d,"data-v-ccd45260",null).exports,f=a("92s/"),h={name:"modal-create-config-leader-and-staff",components:{SelectExternalStations:s.a,SelectLeaderByStation:r,SelectWhStaffs:f.a,StaffService:l.a},props:["trigger"],data:function(){return{selectedStation:"",selectedLeader:"",selectedWhStaffs:"",responseMessage:""}},created:function(){},watch:{trigger:function(t,e){this.$refs.myModalRef.show()}},methods:{hideModal:function(){this.$refs.select_external_stations.reset(),this.$refs.select_leaders.reset(),this.$refs.select_staffs.reset(),this.$refs.myModalRef.hide()},setSelectedStation:function(t){this.selectedStation=t},setSelectedLeader:function(t){this.selectedLeader=t},setSelectedWhStaffs:function(t){this.selectedWhStaffs=t},updateConfigLeaderAndStaff:function(){var t=this;if(this.selectedStation&&this.selectedLeader&&this.selectedWhStaffs){var e={id_leader:this.selectedLeader,id_station:this.selectedStation},a={id_leader:this.selectedLeader,id_staffs:this.selectedWhStaffs};l.a.updateConfigReportLineMultipleStaff(a).then(function(a){t.responseMessage=a.data,a.data.hasOwnProperty("success")&&(t.$refs.select_external_stations.reset(),t.$refs.select_leaders.reset(),t.$refs.select_staffs.reset(),t.$refs.myModalRef.hide(),t.$emit("handleSuccess",a),t.$emit("autoSearch",e))}).catch(function(t){console.log(t)})}},resetDefault:function(){}}},u=Object(c.a)(h,function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("b-modal",{ref:"myModalRef",attrs:{static:"",id:"modal-detail",size:"lg","hide-footer":""},on:{show:function(e){t.loading=!0},hidden:t.resetDefault}},[a("div",{attrs:{slot:"modal-title"},slot:"modal-title"},[t._v("\n      Tạo Mới Config Quản Lý Và Nhân Viên\n    ")]),t._v(" "),a("div",{staticClass:"search-form"},[a("form",[a("b-form-row",[a("b-form-group",{staticClass:"col-md-12",attrs:{label:"Chọn Kho Liên Vùng"}},[a("select-external-stations",{ref:"select_external_stations",attrs:{multiple:!1,placehoder:"Nhập kho cần tìm kiếm"},on:{selected:t.setSelectedStation}})],1)],1),t._v(" "),a("b-form-row",[a("b-form-group",{staticClass:"col-md-12",attrs:{label:"Chọn Trưởng Module/Điều Phối"}},[a("select-leader-by-station",{ref:"select_leaders",attrs:{multiple:!1,stationId:t.selectedStation,placehoder:"Nhập kho cần tìm kiếm"},on:{selected:t.setSelectedLeader}})],1)],1),t._v(" "),a("b-form-row",[a("b-form-group",{staticClass:"col-md-12",attrs:{label:"Chọn Phụ Kho"}},[a("select-wh-staffs",{ref:"select_staffs",attrs:{stationId:t.selectedStation,multiple:!0},on:{selected:t.setSelectedWhStaffs}})],1)],1),t._v(" "),a("b-form-group",{attrs:{label:"&nbsp"}},[a("div",{staticClass:"align-content-center center"},[a("b-btn",{attrs:{type:"button",variant:"primary"},on:{click:t.updateConfigLeaderAndStaff}},[t._v(" Save")]),t._v(" "),a("b-btn",{attrs:{type:"button",variant:"secondary"},on:{click:t.hideModal}},[t._v(" Đóng")])],1)])],1)])])],1)},[],!1,null,null,null).exports,p=a("mCOD"),m={name:"config-leader-and-staff",components:{SelectExternalStations:s.a,SelectLeaderByStation:r,ModalCreateConfigLeaderAndStaff:u,StaffService:l.a,LoadingMiniBottom:p.a},data:function(){return{success:!0,appLoading:!1,selectedStation:"",selectedLeader:"",showModal:!1,listData:[],pageData:{currentPage:1,totalPages:0,totalItems:0,perPage:10,sortBy:"id",sortDesc:!1}}},methods:{handleSearch:function(t){this.setSelectedStation(t.id_station),this.setSelectedLeader(t.id_leader),this.searchConfig(this.pageData.currentPage)},showSuccess:function(t){this.$notify({group:"default",type:t.data.success?"":"bg-danger text-white",title:"Thông báo",text:t.data.message})},openModal:function(){this.showModal=!this.showModal},setSelectedStation:function(t){this.selectedStation=t},setSelectedLeader:function(t){this.selectedLeader=t},pageChanged:function(t){this.searchConfig(t),this.pageData.currentPage=t},searchConfig:function(t,e){var a=this,s={id_leader:this.selectedLeader,page:t};e&&(this.pageData.currentPage=1,s.page=1),this.$startLoading(),l.a.getListConfigByLeader(s).then(function(t){t.data.success?(a.pageData.totalItems=t.data.pagination.total,a.pageData.perPage=t.data.pagination.per_page,a.pageData.totalPages=t.data.pagination.total_page,a.listData=t.data.data):a.success=!1}).then(function(){a.$stopLoading()}).catch(function(t){console.log(t)})},deleteConfig:function(t){var e=this;if(confirm("Bạn có chắc chắn muốn xóa config giữa quản lý "+t.leader_fullname+" và "+t.staff_fullname+" ?")){var a={id_leader:t.id_leader,id_staff:t.id_staff};this.$startLoading(),l.a.updateConfigReportLineSingleStaff(a).then(function(t){t.data.success?(e.$notify({group:"default",type:"bg-success text-white",title:"Thông báo",text:"Xóa Config thành công"}),e.searchConfig(e.pageData.currentPage)):e.$notify({group:"default",type:"bg-warning text-dark",title:"Thông báo",text:t.data.message})}).then(function(){e.appLoading=!1,e.$stopLoading()}).catch(function(t){console.log(t)})}}},created:function(){},computed:{totalItems:function(){return this.listData.length},totalPages:function(){return Math.ceil(this.totalItems/this.perPage)}}};var g=function(t){a("OEkN"),a("pG0Z")},S=Object(c.a)(m,function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("div",{staticClass:"ui-block"},[a("h4",{staticClass:"ui-block-heading"},[t._v("Danh Sách Quản Lý và Nhân Viên")]),t._v(" "),a("div",{staticClass:"float-right"},[a("b-btn",{attrs:{type:"button",variant:"secondary"},on:{click:t.openModal}},[a("i",{staticClass:"sidenav-icon ion ion-md-add"}),t._v(" Tạo Mới")])],1),t._v(" "),a("div",{staticClass:"search-form"},[a("form",[a("b-form-row",[a("b-form-group",{staticClass:"col-md-4",attrs:{label:"Chọn Kho Liên Vùng"}},[a("select-external-stations",{ref:"select_stations",attrs:{multiple:!1,placehoder:"Nhập kho cần tìm kiếm"},on:{selected:t.setSelectedStation}})],1),t._v(" "),a("b-form-group",{staticClass:"col-md-4",attrs:{label:"Chọn Trưởng Module/Điều Phối"}},[a("select-leader-by-station",{ref:"select_stations",attrs:{multiple:!1,stationId:t.selectedStation,placehoder:"Nhập kho cần tìm kiếm"},on:{selected:t.setSelectedLeader}})],1),t._v(" "),a("div",{staticClass:"col-md-4"},[a("b-form-group",{attrs:{label:"&nbsp"}},[a("div",{staticClass:"align-content-center center"},[a("b-btn",{attrs:{type:"button",variant:"primary"},on:{click:function(e){return t.searchConfig(t.pageData.currentPage,!0,!1)}}},[a("i",{staticClass:"sidenav-icon ion ion-md-search"}),t._v(" Tìm kiếm")])],1)])],1)],1)],1)]),t._v(" "),a("div",{staticClass:"result",attrs:{id:"results"}},[a("br"),t._v(" "),t.listData?a("b-card",{attrs:{"no-body":""}},[a("div",{staticClass:"table-result"},[a("div",{staticClass:"table-responsive mb-4"},[a("table",{staticClass:"table mb-0 table-bordered"},[a("thead",{staticStyle:{width:"100%"}},[a("tr",[a("th",[t._v("Quản lý")]),t._v(" "),a("th",[t._v("Nhân Viên")]),t._v(" "),a("th",[t._v("Action")])])]),t._v(" "),a("tbody",t._l(t.listData,function(e){return a("tr",[a("td",[t._v(t._s(e.leader_fullname))]),t._v(" "),a("td",[t._v(t._s(e.staff_fullname))]),t._v(" "),a("td",[a("b-btn",{staticClass:"btn btn-md btn-outline-danger",on:{click:function(a){return t.deleteConfig(e)}}},[a("i",{staticClass:"ion ion-md-trash"})])],1)])}),0)])]),t._v(" "),a("b-card-body",{staticClass:"pt-0 pb-3"},[a("div",{staticClass:"row"},[a("div",{staticClass:"col-sm pt-3"},[a("b-pagination",{attrs:{"total-rows":t.pageData.totalItems,"per-page":t.pageData.perPage},on:{change:t.pageChanged},model:{value:t.pageData.currentPage,callback:function(e){t.$set(t.pageData,"currentPage",e)},expression:"pageData.currentPage"}})],1),t._v(" "),a("div",{staticClass:"col-sm text-sm-left text-center pt-3"},[t.pageData.totalItems?a("span",{staticClass:"text-muted"},[t._v("Trang "+t._s(t.pageData.currentPage)+" trên "+t._s(t.pageData.totalPages))]):t._e()])])])],1)]):t._e(),t._v(" "),t.listData?t._e():a("div",{staticClass:"no-data"},[t._v("\n                Không có dữ liệu phù hợp, vui lòng thử lại với điều kiện tìm kiếm khác.\n            ")]),t._v(" "),a("loading-mini-bottom",{attrs:{enable:t.appLoading}})],1),t._v(" "),a("modal-create-config-leader-and-staff",{attrs:{trigger:t.showModal},on:{handleSuccess:t.showSuccess,autoSearch:t.handleSearch}})],1)])},[],!1,g,"data-v-05995aac",null);e.default=S.exports},m4Ev:function(t,e,a){"use strict";var s=a("RUzx"),i=a.n(s),n=a("agCp"),l={name:"select-external-stations",props:{disabled:{type:Boolean,default:!1},multiple:{type:Boolean,default:!0},placeholder:{type:String,default:"Chọn kho"}},components:{Multiselect:i.a},data:function(){return{stations:[],selectedStations:[]}},methods:{getOptions:function(){var t=this;n.a.getListExternalStation().then(function(e){e.data.success&&(t.stations=e.data.data.stations,t.multiple||t.stations.unshift({code:"",name:t.placeholder}))}).catch(function(t){})},onSelect:function(t,e){if(this.multiple){var a=[];if(this.selectedStations.length>0)for(var s=0;s<this.selectedStations.length;s++)a.push(this.selectedStations[s].code);a.push(t.code),this.$emit("selected",a)}else this.selectedStations=t.code,this.$emit("selected",this.selectedStations)},onRemove:function(t){var e=[];if(this.multiple){for(var a=0;a<this.selectedStations.length;a++)this.selectedStations[a].code!==t.code&&e.push(this.selectedStations[a].code);this.$emit("selected",e)}},reset:function(){this.selectedStations=this.multiple?[]:""}},created:function(){this.getOptions()}},o=a("XyMi");var c=function(t){a("xM8J")},d=Object(o.a)(l,function(){var t=this,e=t.$createElement;return(t._self._c||e)("multiselect",{attrs:{options:t.stations,multiple:t.multiple,disabled:t.disabled,placeholder:t.placeholder,"track-by":"name",label:"name",selectLabel:"",selectedLabel:"",deselectLabel:"x"},on:{select:t.onSelect,remove:t.onRemove},model:{value:t.selectedStations,callback:function(e){t.selectedStations=e},expression:"selectedStations"}})},[],!1,c,"data-v-612eea24",null);e.a=d.exports},pG0Z:function(t,e){},s2UW:function(t,e){},xM8J:function(t,e){}});